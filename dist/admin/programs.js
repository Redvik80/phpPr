!function(e){var n={};function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var a in e)t.d(r,a,function(n){return e[n]}.bind(null,a));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=9)}({10:function(e,n,t){e.exports=t.p+"admin/programs.css"},11:function(e,n){var t=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(a,l){function i(e){try{o(r.next(e))}catch(e){l(e)}}function c(e){try{o(r.throw(e))}catch(e){l(e)}}function o(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,c)}o((r=r.apply(e,n||[])).next())}))},r=this&&this.__generator||function(e,n){var t,r,a,l,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function c(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=n.call(e,i)}catch(e){l=[6,e],r=0}finally{t=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},a=document.getElementsByClassName("programs-crud-component")[0],l=a.querySelector(".table__btn._add"),i=a.getElementsByClassName("table__body")[0],c=i.getElementsByClassName("table__row"),o=[];function u(e){return{id:e.querySelector(".table__cell._id .table__cell-value"),nameValue:e.querySelector(".table__cell._name .table__cell-value"),nameChangeElem:e.querySelector(".table__cell._name .table__cell-change-elem"),durationValue:e.querySelector(".table__cell._duration .table__cell-value"),durationChangeElemHours:e.querySelector(".table__cell._duration .table__cell-change-elem._hours"),durationChangeElemMins:e.querySelector(".table__cell._duration .table__cell-change-elem._mins"),btnChange:e.querySelector(".table__btn._change"),btnDelete:e.querySelector(".table__btn._delete"),btnSave:e.querySelector(".table__btn._save"),btnCancel:e.querySelector(".table__btn._cancel")}}function s(e){return e.parentElement.parentElement}function d(e){var n=u(e);n.btnChange.addEventListener("click",f),n.btnCancel.addEventListener("click",m),n.btnDelete.addEventListener("click",v),n.btnSave.addEventListener("click",h)}function _(e){var n=Math.floor(e/36e5),t=Math.floor((e-36e5*n)/6e4);return{hours:n,mins:t,str:(n>0?n+"ч. ":"")+(t>0||0===n?t+"мин.":"")}}function b(e){var n=_(e.duration);return'<div class="table__row">\n        <div class="table__content-cells-container">\n            <div class="table__cell _id">\n                <div class="table__cell-value">'+(e.id||"")+'</div>\n            </div>\n            <div class="table__cell _name">\n                <div class="table__cell-value">'+e.name+'</div>\n                <input class="table__cell-change-elem" maxlength="200" name="name" value="'+e.name+'">\n            </div>\n            <div class="table__cell _duration">\n                <div class="table__cell-value">'+n.str+'</div>\n                <div class="table__cell-change-elem-container">\n                    <input class="table__cell-change-elem _hours" type="number" min="0" max="24" value="'+n.hours+'">ч.\n                    <input class="table__cell-change-elem _mins" type="number" min="0" max="59" value="'+n.mins+'">мин.\n                </div>\n            </div>\n        </div>\n        <div class="table__cell _btns">\n            <button class="pi pi-pencil table__btn _change"></button>\n            <button class="pi pi-trash table__btn _delete"></button>\n            <button class="pi pi-save table__btn _save"></button>\n            <button class="pi pi-times table__btn _cancel"></button>\n        </div>\n    </div>'}function f(e){s(e.currentTarget).classList.add("_changed")}function m(e){var n=s(e.currentTarget),t=u(n);if(t.id.innerText){n.classList.remove("_changed");var r=o.find((function(e){return e.id+""===t.id.innerText})),a=_(r.duration);t.nameChangeElem.value=r.name,t.durationChangeElemHours.value=a.hours+"",t.durationChangeElemMins.value=a.mins+""}else n.parentElement.removeChild(n)}function v(e){return t(this,void 0,void 0,(function(){var n,t;return r(this,(function(r){switch(r.label){case 0:return confirm("Хорошо подумали?")?(n=s(e.currentTarget),t=u(n),[4,fetch("/api/program/delete.php?id="+t.id.innerText,{method:"delete"})]):[2];case 1:return r.sent(),o=o.filter((function(e){return e.id+""!==t.id.innerText})),n.parentElement.removeChild(n),[2]}}))}))}function h(e){return t(this,void 0,void 0,(function(){var n,t,a,l,i,c,d;return r(this,(function(r){switch(r.label){case 0:return n=s(e.currentTarget),t=u(n),a=36e5*+t.durationChangeElemHours.value+6e4*+t.durationChangeElemMins.value,t.id.innerText?(l={id:+t.id.innerText,name:t.nameChangeElem.value,duration:a},[4,fetch("/api/program/change.php",{method:"put",body:JSON.stringify(l)})]):[3,2];case 1:return r.sent(),o=o.map((function(e){return e.id===l.id?l:e})),[3,5];case 2:return i={id:null,name:t.nameChangeElem.value,duration:a},c=i,[4,fetch("/api/program/add.php",{method:"post",body:JSON.stringify(i)})];case 3:return[4,r.sent().json()];case 4:c.id=r.sent(),t.id.innerText=""+i.id,o.push(i),r.label=5;case 5:return d=_(a),t.nameValue.innerText=t.nameChangeElem.value,t.durationValue.innerText=d.str,n.classList.remove("_changed"),[2]}}))}))}l.addEventListener("click",(function(){i.insertAdjacentHTML("beforeend",b({id:null,name:"",duration:36e5}));var e=i.lastElementChild;d(e),u(e).btnChange.click(),setTimeout((function(){return i.scrollTop=i.scrollHeight}))})),fetch("/api/program/getAll.php").then((function(e){return e.json()})).then((function(e){for(var n=0,t=o=e;n<t.length;n++){var r=t[n];i.insertAdjacentHTML("beforeend",b(r))}for(var a=0;a<c.length;a++)d(c[a])}))},9:function(e,n,t){"use strict";t.r(n);t(10),t(11)}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vcGFnZXMvYWRtaW4vcHJvZ3JhbXMvcHJvZ3JhbXMuc2NzcyIsIndlYnBhY2s6Ly8vLi9jb21wb25lbnRzL2FkbWluL3Byb2dyYW1zQ3J1ZC9wcm9ncmFtc0NydWQudHMiLCJ3ZWJwYWNrOi8vLy4vcGFnZXMvYWRtaW4vcHJvZ3JhbXMvcHJvZ3JhbXMudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJjb21wIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwiYWRkQnRuIiwicXVlcnlTZWxlY3RvciIsInJvd3NDb250YWluZXIiLCJyb3dzIiwicHJvZ3JhbXMiLCJnZXRSb3dFbGVtcyIsInJvdyIsImlkIiwibmFtZVZhbHVlIiwibmFtZUNoYW5nZUVsZW0iLCJkdXJhdGlvblZhbHVlIiwiZHVyYXRpb25DaGFuZ2VFbGVtSG91cnMiLCJkdXJhdGlvbkNoYW5nZUVsZW1NaW5zIiwiYnRuQ2hhbmdlIiwiYnRuRGVsZXRlIiwiYnRuU2F2ZSIsImJ0bkNhbmNlbCIsImdldEJ1dHRvbnNSb3ciLCJidXR0b24iLCJwYXJlbnRFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lcnNUb1JvdyIsInJvd0VsZW1zIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uQ2hhbmdlQnRuQ2xpY2siLCJvbkNhbmNlbEJ0bkNsaWNrIiwib25EZWxldGVCdG5DbGljayIsIm9uU2F2ZUJ0bkNsaWNrIiwiY29udmVydER1cmF0aW9uIiwiZHVyYXRpb24iLCJob3VycyIsIk1hdGgiLCJmbG9vciIsIm1pbnMiLCJzdHIiLCJjcmVhdGVSb3ciLCJwcm9ncmFtIiwiZXZlbnQiLCJjdXJyZW50VGFyZ2V0IiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5uZXJUZXh0IiwicmVtb3ZlIiwiZmluZCIsIml0ZW0iLCJyZW1vdmVDaGlsZCIsImNvbmZpcm0iLCJmZXRjaCIsIm1ldGhvZCIsImZpbHRlciIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwibWFwIiwibmV3UHJvZ3JhbSIsImpzb24iLCJwdXNoIiwiZHVyYXRpb25PYmoiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJuZXdSb3ciLCJsYXN0RWxlbWVudENoaWxkIiwiY2xpY2siLCJzZXRUaW1lb3V0Iiwic2Nyb2xsVG9wIiwic2Nyb2xsSGVpZ2h0IiwidGhlbiIsInJlc3AiLCJkYXRhIiwibGVuZ3RoIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxL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QUFXOEQsRUFDUyxlQUFVLENBQXpCLElBQUkvQixFQUFPLEtBQWNqQyxFQUFjdUQsbUJBQW1CLFlBQWF2QixFQUFVQyxJQUN0RixJQUFLLElBQUl0RSxFQUFJLEVBQUdBLEVBQUlzQyxFQUFLZ0UsT0FBUXRHLElBQUt1RCxFQUF1QmpCLEVBQUt0QyxRLCtCQ2J0RSIsImZpbGUiOiJhZG1pbi9wcm9ncmFtcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA5KTtcbiIsIm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3B1YmxpY19wYXRoX18gKyBcImFkbWluL3Byb2dyYW1zLmNzc1wiOyIsImV4cG9ydCB7IH07XG5cbmNvbnN0IGNvbXAgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwicHJvZ3JhbXMtY3J1ZC1jb21wb25lbnRcIilbMF0gYXMgSFRNTEVsZW1lbnQ7XG5jb25zdCBhZGRCdG4gPSBjb21wLnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2J0bi5fYWRkXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuY29uc3Qgcm93c0NvbnRhaW5lciA9IGNvbXAuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInRhYmxlX19ib2R5XCIpWzBdIGFzIEhUTUxFbGVtZW50O1xuY29uc3Qgcm93cyA9IHJvd3NDb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInRhYmxlX19yb3dcIikgYXMgSFRNTENvbGxlY3Rpb25PZjxIVE1MRWxlbWVudD47XG5sZXQgcHJvZ3JhbXM6IFByb2dyYW1bXSA9IFtdO1xuXG5hZGRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uQWRkQnRuQ2xpY2spO1xuXG5mZXRjaChgL2FwaS9wcm9ncmFtL2dldEFsbC5waHBgKS50aGVuKChyZXNwKSA9PiByZXNwLmpzb24oKSkudGhlbigoZGF0YSkgPT4ge1xuICAgIHByb2dyYW1zID0gZGF0YTtcbiAgICBmb3IgKGxldCBwcm9ncmFtIG9mIHByb2dyYW1zKSByb3dzQ29udGFpbmVyLmluc2VydEFkamFjZW50SFRNTChcImJlZm9yZWVuZFwiLCBjcmVhdGVSb3cocHJvZ3JhbSkpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm93cy5sZW5ndGg7IGkrKykgYWRkRXZlbnRMaXN0ZW5lcnNUb1Jvdyhyb3dzW2ldKTtcbn0pO1xuXG5mdW5jdGlvbiBnZXRSb3dFbGVtcyhyb3c6IEhUTUxFbGVtZW50KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19jZWxsLl9pZCAudGFibGVfX2NlbGwtdmFsdWVcIikgYXMgSFRNTEVsZW1lbnQsXG4gICAgICAgIG5hbWVWYWx1ZTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2NlbGwuX25hbWUgLnRhYmxlX19jZWxsLXZhbHVlXCIpIGFzIEhUTUxFbGVtZW50LFxuICAgICAgICBuYW1lQ2hhbmdlRWxlbTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2NlbGwuX25hbWUgLnRhYmxlX19jZWxsLWNoYW5nZS1lbGVtXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgIGR1cmF0aW9uVmFsdWU6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19jZWxsLl9kdXJhdGlvbiAudGFibGVfX2NlbGwtdmFsdWVcIikgYXMgSFRNTEVsZW1lbnQsXG4gICAgICAgIGR1cmF0aW9uQ2hhbmdlRWxlbUhvdXJzOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fY2VsbC5fZHVyYXRpb24gLnRhYmxlX19jZWxsLWNoYW5nZS1lbGVtLl9ob3Vyc1wiKSBhcyBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICBkdXJhdGlvbkNoYW5nZUVsZW1NaW5zOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fY2VsbC5fZHVyYXRpb24gLnRhYmxlX19jZWxsLWNoYW5nZS1lbGVtLl9taW5zXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgIGJ0bkNoYW5nZTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2J0bi5fY2hhbmdlXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICBidG5EZWxldGU6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19idG4uX2RlbGV0ZVwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgYnRuU2F2ZTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2J0bi5fc2F2ZVwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgYnRuQ2FuY2VsOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fYnRuLl9jYW5jZWxcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnRcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldEJ1dHRvbnNSb3coYnV0dG9uOiBIVE1MQnV0dG9uRWxlbWVudCkge1xuICAgIHJldHVybiAoYnV0dG9uLnBhcmVudEVsZW1lbnQgYXMgSFRNTEVsZW1lbnQpLnBhcmVudEVsZW1lbnQgYXMgSFRNTEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXJzVG9Sb3cocm93OiBIVE1MRWxlbWVudCkge1xuICAgIGNvbnN0IHJvd0VsZW1zID0gZ2V0Um93RWxlbXMocm93KTtcbiAgICByb3dFbGVtcy5idG5DaGFuZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uQ2hhbmdlQnRuQ2xpY2spO1xuICAgIHJvd0VsZW1zLmJ0bkNhbmNlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25DYW5jZWxCdG5DbGljayk7XG4gICAgcm93RWxlbXMuYnRuRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbkRlbGV0ZUJ0bkNsaWNrKTtcbiAgICByb3dFbGVtcy5idG5TYXZlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvblNhdmVCdG5DbGljayk7XG59XG5cbmZ1bmN0aW9uIGNvbnZlcnREdXJhdGlvbihkdXJhdGlvbjogbnVtYmVyKSB7XG4gICAgY29uc3QgaG91cnMgPSBNYXRoLmZsb29yKGR1cmF0aW9uIC8gMzYwMDAwMCk7XG4gICAgY29uc3QgbWlucyA9IE1hdGguZmxvb3IoKGR1cmF0aW9uIC0gaG91cnMgKiAzNjAwMDAwKSAvIDYwMDAwKTtcbiAgICBjb25zdCBzdHIgPSAoaG91cnMgPiAwID8gaG91cnMgKyBcItGHLiBcIiA6IFwiXCIpICsgKG1pbnMgPiAwIHx8IGhvdXJzID09PSAwID8gbWlucyArIFwi0LzQuNC9LlwiIDogXCJcIik7XG4gICAgcmV0dXJuIHsgaG91cnMsIG1pbnMsIHN0ciB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVJvdyhwcm9ncmFtOiBQcm9ncmFtKSB7XG4gICAgY29uc3QgZHVyYXRpb24gPSBjb252ZXJ0RHVyYXRpb24ocHJvZ3JhbS5kdXJhdGlvbik7XG4gICAgcmV0dXJuIGA8ZGl2IGNsYXNzPVwidGFibGVfX3Jvd1wiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NvbnRlbnQtY2VsbHMtY29udGFpbmVyXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwgX2lkXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jZWxsLXZhbHVlXCI+JHtwcm9ncmFtLmlkIHx8IFwiXCJ9PC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbCBfbmFtZVwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbC12YWx1ZVwiPiR7cHJvZ3JhbS5uYW1lfTwvZGl2PlxuICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz1cInRhYmxlX19jZWxsLWNoYW5nZS1lbGVtXCIgbWF4bGVuZ3RoPVwiMjAwXCIgbmFtZT1cIm5hbWVcIiB2YWx1ZT1cIiR7cHJvZ3JhbS5uYW1lfVwiPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwgX2R1cmF0aW9uXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jZWxsLXZhbHVlXCI+JHtkdXJhdGlvbi5zdHJ9PC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jZWxsLWNoYW5nZS1lbGVtLWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJ0YWJsZV9fY2VsbC1jaGFuZ2UtZWxlbSBfaG91cnNcIiB0eXBlPVwibnVtYmVyXCIgbWluPVwiMFwiIG1heD1cIjI0XCIgdmFsdWU9XCIke2R1cmF0aW9uLmhvdXJzfVwiPtGHLlxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJ0YWJsZV9fY2VsbC1jaGFuZ2UtZWxlbSBfbWluc1wiIHR5cGU9XCJudW1iZXJcIiBtaW49XCIwXCIgbWF4PVwiNTlcIiB2YWx1ZT1cIiR7ZHVyYXRpb24ubWluc31cIj7QvNC40L0uXG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbCBfYnRuc1wiPlxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cInBpIHBpLXBlbmNpbCB0YWJsZV9fYnRuIF9jaGFuZ2VcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS10cmFzaCB0YWJsZV9fYnRuIF9kZWxldGVcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS1zYXZlIHRhYmxlX19idG4gX3NhdmVcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS10aW1lcyB0YWJsZV9fYnRuIF9jYW5jZWxcIj48L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+YFxufVxuXG5mdW5jdGlvbiBvbkFkZEJ0bkNsaWNrKCkge1xuICAgIGNvbnN0IG5ld1Byb2dyYW06IFByb2dyYW0gPSB7XG4gICAgICAgIGlkOiBudWxsLFxuICAgICAgICBuYW1lOiBcIlwiLFxuICAgICAgICBkdXJhdGlvbjogMzYwMDAwMFxuICAgIH1cbiAgICByb3dzQ29udGFpbmVyLmluc2VydEFkamFjZW50SFRNTChcImJlZm9yZWVuZFwiLCBjcmVhdGVSb3cobmV3UHJvZ3JhbSkpO1xuICAgIGNvbnN0IG5ld1JvdyA9IHJvd3NDb250YWluZXIubGFzdEVsZW1lbnRDaGlsZCBhcyBIVE1MRWxlbWVudDtcbiAgICBhZGRFdmVudExpc3RlbmVyc1RvUm93KG5ld1Jvdyk7XG4gICAgZ2V0Um93RWxlbXMobmV3Um93KS5idG5DaGFuZ2UuY2xpY2soKTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHJvd3NDb250YWluZXIuc2Nyb2xsVG9wID0gcm93c0NvbnRhaW5lci5zY3JvbGxIZWlnaHQpO1xufVxuXG5mdW5jdGlvbiBvbkNoYW5nZUJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICByb3cuY2xhc3NMaXN0LmFkZChcIl9jaGFuZ2VkXCIpO1xufVxuXG5mdW5jdGlvbiBvbkNhbmNlbEJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICBjb25zdCByb3dFbGVtcyA9IGdldFJvd0VsZW1zKHJvdyk7XG4gICAgaWYgKHJvd0VsZW1zLmlkLmlubmVyVGV4dCkge1xuICAgICAgICByb3cuY2xhc3NMaXN0LnJlbW92ZShcIl9jaGFuZ2VkXCIpO1xuICAgICAgICBjb25zdCBwcm9ncmFtID0gcHJvZ3JhbXMuZmluZCgoaXRlbSkgPT4gaXRlbS5pZCArIFwiXCIgPT09IHJvd0VsZW1zLmlkLmlubmVyVGV4dCk7XG4gICAgICAgIGNvbnN0IGR1cmF0aW9uID0gY29udmVydER1cmF0aW9uKHByb2dyYW0uZHVyYXRpb24pO1xuICAgICAgICByb3dFbGVtcy5uYW1lQ2hhbmdlRWxlbS52YWx1ZSA9IHByb2dyYW0ubmFtZTtcbiAgICAgICAgcm93RWxlbXMuZHVyYXRpb25DaGFuZ2VFbGVtSG91cnMudmFsdWUgPSBkdXJhdGlvbi5ob3VycyArIFwiXCI7XG4gICAgICAgIHJvd0VsZW1zLmR1cmF0aW9uQ2hhbmdlRWxlbU1pbnMudmFsdWUgPSBkdXJhdGlvbi5taW5zICsgXCJcIjtcbiAgICB9XG4gICAgZWxzZSByb3cucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChyb3cpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBvbkRlbGV0ZUJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgaWYgKCFjb25maXJtKFwi0KXQvtGA0L7RiNC+INC/0L7QtNGD0LzQsNC70Lg/XCIpKSByZXR1cm47XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICBjb25zdCByb3dFbGVtcyA9IGdldFJvd0VsZW1zKHJvdyk7XG4gICAgYXdhaXQgZmV0Y2goXCIvYXBpL3Byb2dyYW0vZGVsZXRlLnBocD9pZD1cIiArIHJvd0VsZW1zLmlkLmlubmVyVGV4dCwgeyBtZXRob2Q6IFwiZGVsZXRlXCIgfSk7XG4gICAgcHJvZ3JhbXMgPSBwcm9ncmFtcy5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0uaWQgKyBcIlwiICE9PSByb3dFbGVtcy5pZC5pbm5lclRleHQpO1xuICAgIHJvdy5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHJvdyk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIG9uU2F2ZUJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICBjb25zdCByb3dFbGVtcyA9IGdldFJvd0VsZW1zKHJvdyk7XG4gICAgY29uc3QgZHVyYXRpb24gPSArcm93RWxlbXMuZHVyYXRpb25DaGFuZ2VFbGVtSG91cnMudmFsdWUgKiAzNjAwMDAwICsgK3Jvd0VsZW1zLmR1cmF0aW9uQ2hhbmdlRWxlbU1pbnMudmFsdWUgKiA2MDAwMDtcbiAgICBpZiAocm93RWxlbXMuaWQuaW5uZXJUZXh0KSB7XG4gICAgICAgIGNvbnN0IGNoYW5nZWRQcm9ncmFtID0ge1xuICAgICAgICAgICAgaWQ6ICtyb3dFbGVtcy5pZC5pbm5lclRleHQsXG4gICAgICAgICAgICBuYW1lOiByb3dFbGVtcy5uYW1lQ2hhbmdlRWxlbS52YWx1ZSxcbiAgICAgICAgICAgIGR1cmF0aW9uXG4gICAgICAgIH07XG4gICAgICAgIGF3YWl0IGZldGNoKGAvYXBpL3Byb2dyYW0vY2hhbmdlLnBocGAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJwdXRcIixcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGNoYW5nZWRQcm9ncmFtKVxuICAgICAgICB9KTtcbiAgICAgICAgcHJvZ3JhbXMgPSBwcm9ncmFtcy5tYXAoKGl0ZW0pID0+IGl0ZW0uaWQgPT09IGNoYW5nZWRQcm9ncmFtLmlkID8gY2hhbmdlZFByb2dyYW0gOiBpdGVtKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBuZXdQcm9ncmFtID0ge1xuICAgICAgICAgICAgaWQ6IG51bGwsXG4gICAgICAgICAgICBuYW1lOiByb3dFbGVtcy5uYW1lQ2hhbmdlRWxlbS52YWx1ZSxcbiAgICAgICAgICAgIGR1cmF0aW9uXG4gICAgICAgIH1cbiAgICAgICAgbmV3UHJvZ3JhbS5pZCA9IGF3YWl0IChhd2FpdCBmZXRjaChgL2FwaS9wcm9ncmFtL2FkZC5waHBgLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkobmV3UHJvZ3JhbSlcbiAgICAgICAgfSkpLmpzb24oKTtcbiAgICAgICAgcm93RWxlbXMuaWQuaW5uZXJUZXh0ID0gXCJcIiArIG5ld1Byb2dyYW0uaWQ7XG4gICAgICAgIHByb2dyYW1zLnB1c2gobmV3UHJvZ3JhbSk7XG4gICAgfVxuICAgIGNvbnN0IGR1cmF0aW9uT2JqID0gY29udmVydER1cmF0aW9uKGR1cmF0aW9uKTtcbiAgICByb3dFbGVtcy5uYW1lVmFsdWUuaW5uZXJUZXh0ID0gcm93RWxlbXMubmFtZUNoYW5nZUVsZW0udmFsdWU7XG4gICAgcm93RWxlbXMuZHVyYXRpb25WYWx1ZS5pbm5lclRleHQgPSBkdXJhdGlvbk9iai5zdHI7XG4gICAgcm93LmNsYXNzTGlzdC5yZW1vdmUoXCJfY2hhbmdlZFwiKTtcbn1cblxuY2xhc3MgUHJvZ3JhbSB7XG4gICAgaWQ6IG51bWJlcjtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgZHVyYXRpb246IG51bWJlcjtcbn0iLCJpbXBvcnQgXCIuL3Byb2dyYW1zLnNjc3NcIjtcbmltcG9ydCBcIi4uLy4uLy4uL2NvbXBvbmVudHMvYWRtaW4vcHJvZ3JhbXNDcnVkL3Byb2dyYW1zQ3J1ZC50c1wiOyJdLCJzb3VyY2VSb290IjoiIn0=