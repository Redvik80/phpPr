!function(e){var n={};function t(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(a,r,function(n){return e[n]}.bind(null,r));return a},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=7)}({7:function(e,n,t){"use strict";t.r(n);t(8),t(9)},8:function(e,n,t){e.exports=t.p+"admin/programs.css"},9:function(e,n){var t=this&&this.__awaiter||function(e,n,t,a){return new(t||(t=Promise))((function(r,l){function i(e){try{o(a.next(e))}catch(e){l(e)}}function c(e){try{o(a.throw(e))}catch(e){l(e)}}function o(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,c)}o((a=a.apply(e,n||[])).next())}))},a=this&&this.__generator||function(e,n){var t,a,r,l,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return l={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function c(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,a&&(r=2&l[0]?a.return:l[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,l[1])).done)return r;switch(a=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,a=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){i.label=l[1];break}if(6===l[0]&&i.label<r[1]){i.label=r[1],r=l;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(l);break}r[2]&&i.ops.pop(),i.trys.pop();continue}l=n.call(e,i)}catch(e){l=[6,e],a=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},r=document.getElementsByClassName("programs-crud-component")[0],l=r.querySelector(".table__btn._add"),i=r.getElementsByClassName("table__body")[0],c=i.getElementsByClassName("table__row"),o=[];function u(e){return{id:e.querySelector(".table__cell._id .table__cell-value"),nameValue:e.querySelector(".table__cell._name .table__cell-value"),nameChangeElem:e.querySelector(".table__cell._name .table__cell-change-elem"),durationValue:e.querySelector(".table__cell._duration .table__cell-value"),durationChangeElemHours:e.querySelector(".table__cell._duration .table__cell-change-elem._hours"),durationChangeElemMins:e.querySelector(".table__cell._duration .table__cell-change-elem._mins"),btnChange:e.querySelector(".table__btn._change"),btnDelete:e.querySelector(".table__btn._delete"),btnSave:e.querySelector(".table__btn._save"),btnCancel:e.querySelector(".table__btn._cancel")}}function s(e){return e.parentElement.parentElement}function d(e){var n=u(e);n.btnChange.addEventListener("click",f),n.btnCancel.addEventListener("click",m),n.btnDelete.addEventListener("click",v),n.btnSave.addEventListener("click",h)}function _(e){var n=Math.floor(e/36e5),t=Math.floor((e-36e5*n)/6e4);return{hours:n,mins:t,str:(n>0?n+"ч. ":"")+(t>0||0===n?t+"мин.":"")}}function b(e){var n=_(e.duration);return'<div class="table__row">\n        <div class="table__content-cells-container">\n            <div class="table__cell _id">\n                <div class="table__cell-value">'+(e.id||"")+'</div>\n            </div>\n            <div class="table__cell _name">\n                <div class="table__cell-value">'+e.name+'</div>\n                <input class="table__cell-change-elem" maxlength="200" name="name" value="'+e.name+'">\n            </div>\n            <div class="table__cell _duration">\n                <div class="table__cell-value">'+n.str+'</div>\n                <div class="table__cell-change-elem-container">\n                    <input class="table__cell-change-elem _hours" type="number" min="0" max="24" value="'+n.hours+'">ч.\n                    <input class="table__cell-change-elem _mins" type="number" min="0" max="59" value="'+n.mins+'">мин.\n                </div>\n            </div>\n        </div>\n        <div class="table__cell _btns">\n            <button class="pi pi-pencil table__btn _change"></button>\n            <button class="pi pi-trash table__btn _delete"></button>\n            <button class="pi pi-save table__btn _save"></button>\n            <button class="pi pi-times table__btn _cancel"></button>\n        </div>\n    </div>'}function f(e){s(e.currentTarget).classList.add("_changed")}function m(e){var n=s(e.currentTarget),t=u(n);if(t.id.innerText){n.classList.remove("_changed");var a=o.find((function(e){return e.id+""===t.id.innerText})),r=_(a.duration);t.nameChangeElem.value=a.name,t.durationChangeElemHours.value=r.hours+"",t.durationChangeElemMins.value=r.mins+""}else n.parentElement.removeChild(n)}function v(e){return t(this,void 0,void 0,(function(){var n,t;return a(this,(function(a){switch(a.label){case 0:return confirm("Хорошо подумали?")?(n=s(e.currentTarget),t=u(n),[4,fetch("/api/program/delete.php?id="+t.id.innerText,{method:"delete"})]):[2];case 1:return a.sent(),o=o.filter((function(e){return e.id+""!==t.id.innerText})),n.parentElement.removeChild(n),[2]}}))}))}function h(e){return t(this,void 0,void 0,(function(){var n,t,r,l,i,c;return a(this,(function(a){switch(a.label){case 0:return n=s(e.currentTarget),t=u(n),r=36e5*+t.durationChangeElemHours.value+6e4*+t.durationChangeElemMins.value,t.id.innerText?[4,fetch("/api/program/change.php",{method:"put",body:JSON.stringify({id:+t.id.innerText,name:t.nameChangeElem.value,duration:r})})]:[3,2];case 1:return a.sent(),[3,5];case 2:return l=t.id,i="",[4,fetch("/api/program/add.php",{method:"post",body:JSON.stringify({name:t.nameChangeElem.value,duration:r})})];case 3:return[4,a.sent().json()];case 4:l.innerText=i+a.sent(),a.label=5;case 5:return c=_(r),t.nameValue.innerText=t.nameChangeElem.value,t.durationValue.innerText=c.str,n.classList.remove("_changed"),[2]}}))}))}l.addEventListener("click",(function(){i.insertAdjacentHTML("afterbegin",b({id:null,name:"",duration:36e5}));var e=i.firstElementChild;d(e),u(e).btnChange.click()})),fetch("/api/program/getAll.php").then((function(e){return e.json()})).then((function(e){for(var n=0,t=o=e;n<t.length;n++){var a=t[n];i.insertAdjacentHTML("beforeend",b(a))}for(var r=0;r<c.length;r++)d(c[r])}))}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vcGFnZXMvYWRtaW4vcHJvZ3JhbXMvcHJvZ3JhbXMudHMiLCJ3ZWJwYWNrOi8vLy4vcGFnZXMvYWRtaW4vcHJvZ3JhbXMvcHJvZ3JhbXMuc2NzcyIsIndlYnBhY2s6Ly8vLi9jb21wb25lbnRzL2FkbWluL3Byb2dyYW1zQ3J1ZC9wcm9ncmFtc0NydWQudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJjb21wIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwiYWRkQnRuIiwicXVlcnlTZWxlY3RvciIsInJvd3NDb250YWluZXIiLCJyb3dzIiwicHJvZ3JhbXMiLCJnZXRSb3dFbGVtcyIsInJvdyIsImlkIiwibmFtZVZhbHVlIiwibmFtZUNoYW5nZUVsZW0iLCJkdXJhdGlvblZhbHVlIiwiZHVyYXRpb25DaGFuZ2VFbGVtSG91cnMiLCJkdXJhdGlvbkNoYW5nZUVsZW1NaW5zIiwiYnRuQ2hhbmdlIiwiYnRuRGVsZXRlIiwiYnRuU2F2ZSIsImJ0bkNhbmNlbCIsImdldEJ1dHRvbnNSb3ciLCJidXR0b24iLCJwYXJlbnRFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lcnNUb1JvdyIsInJvd0VsZW1zIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uQ2hhbmdlQnRuQ2xpY2siLCJvbkNhbmNlbEJ0bkNsaWNrIiwib25EZWxldGVCdG5DbGljayIsIm9uU2F2ZUJ0bkNsaWNrIiwiY29udmVydER1cmF0aW9uIiwiZHVyYXRpb24iLCJob3VycyIsIk1hdGgiLCJmbG9vciIsIm1pbnMiLCJzdHIiLCJjcmVhdGVSb3ciLCJwcm9ncmFtIiwiZXZlbnQiLCJjdXJyZW50VGFyZ2V0IiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5uZXJUZXh0IiwicmVtb3ZlIiwiZmluZCIsIml0ZW0iLCJyZW1vdmVDaGlsZCIsImNvbmZpcm0iLCJmZXRjaCIsIm1ldGhvZCIsImZpbHRlciIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwianNvbiIsImR1cmF0aW9uT2JqIiwiaW5zZXJ0QWRqYWNlbnRIVE1MIiwibmV3Um93IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJjbGljayIsInRoZW4iLCJyZXNwIiwiZGF0YSIsImxlbmd0aCJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxFQUFNLENBQUVLLFlBQVksRUFBTUMsSUFBS0wsS0FLaEVaLEVBQW9Ca0IsRUFBSSxTQUFTaEIsR0FDWCxvQkFBWGlCLFFBQTBCQSxPQUFPQyxhQUMxQ04sT0FBT0MsZUFBZWIsRUFBU2lCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RFAsT0FBT0MsZUFBZWIsRUFBUyxhQUFjLENBQUVtQixPQUFPLEtBUXZEckIsRUFBb0JzQixFQUFJLFNBQVNELEVBQU9FLEdBRXZDLEdBRFUsRUFBUEEsSUFBVUYsRUFBUXJCLEVBQW9CcUIsSUFDL0IsRUFBUEUsRUFBVSxPQUFPRixFQUNwQixHQUFXLEVBQVBFLEdBQThCLGlCQUFWRixHQUFzQkEsR0FBU0EsRUFBTUcsV0FBWSxPQUFPSCxFQUNoRixJQUFJSSxFQUFLWCxPQUFPWSxPQUFPLE1BR3ZCLEdBRkExQixFQUFvQmtCLEVBQUVPLEdBQ3RCWCxPQUFPQyxlQUFlVSxFQUFJLFVBQVcsQ0FBRVQsWUFBWSxFQUFNSyxNQUFPQSxJQUN0RCxFQUFQRSxHQUE0QixpQkFBVEYsRUFBbUIsSUFBSSxJQUFJTSxLQUFPTixFQUFPckIsRUFBb0JVLEVBQUVlLEVBQUlFLEVBQUssU0FBU0EsR0FBTyxPQUFPTixFQUFNTSxJQUFRQyxLQUFLLEtBQU1ELElBQzlJLE9BQU9GLEdBSVJ6QixFQUFvQjZCLEVBQUksU0FBUzFCLEdBQ2hDLElBQUlTLEVBQVNULEdBQVVBLEVBQU9xQixXQUM3QixXQUF3QixPQUFPckIsRUFBZ0IsU0FDL0MsV0FBOEIsT0FBT0EsR0FFdEMsT0FEQUgsRUFBb0JVLEVBQUVFLEVBQVEsSUFBS0EsR0FDNUJBLEdBSVJaLEVBQW9CYSxFQUFJLFNBQVNpQixFQUFRQyxHQUFZLE9BQU9qQixPQUFPa0IsVUFBVUMsZUFBZTFCLEtBQUt1QixFQUFRQyxJQUd6Ry9CLEVBQW9Ca0MsRUFBSSxHQUlqQmxDLEVBQW9CQSxFQUFvQm1DLEVBQUksRyxpQ0NsRnJELGtCLGtCQ0FBaEMsRUFBT0QsUUFBVSxJQUEwQixzQiwrNENDRXJDa0MsRUFBT0MsU0FBU0MsdUJBQXVCLDJCQUEyQixHQUNsRUMsRUFBU0gsRUFBS0ksY0FBYyxvQkFDNUJDLEVBQWdCTCxFQUFLRSx1QkFBdUIsZUFBZSxHQUMzREksRUFBT0QsRUFBY0gsdUJBQXVCLGNBQzlDSyxFQUFzQixHQVkxQixTQUFTQyxFQUFZQyxHQUNqQixNQUFPLENBQ0hDLEdBQUlELEVBQUlMLGNBQWMsdUNBQ3RCTyxVQUFXRixFQUFJTCxjQUFjLHlDQUM3QlEsZUFBZ0JILEVBQUlMLGNBQWMsK0NBQ2xDUyxjQUFlSixFQUFJTCxjQUFjLDZDQUNqQ1Usd0JBQXlCTCxFQUFJTCxjQUFjLDBEQUMzQ1csdUJBQXdCTixFQUFJTCxjQUFjLHlEQUMxQ1ksVUFBV1AsRUFBSUwsY0FBYyx1QkFDN0JhLFVBQVdSLEVBQUlMLGNBQWMsdUJBQzdCYyxRQUFTVCxFQUFJTCxjQUFjLHFCQUMzQmUsVUFBV1YsRUFBSUwsY0FBYyx3QkFJckMsU0FBU2dCLEVBQWNDLEdBQ25CLE9BQVFBLEVBQU9DLGNBQThCQSxjQUdqRCxTQUFTQyxFQUF1QmQsR0FDNUIsSUFBTWUsRUFBV2hCLEVBQVlDLEdBQzdCZSxFQUFTUixVQUFVUyxpQkFBaUIsUUFBU0MsR0FDN0NGLEVBQVNMLFVBQVVNLGlCQUFpQixRQUFTRSxHQUM3Q0gsRUFBU1AsVUFBVVEsaUJBQWlCLFFBQVNHLEdBQzdDSixFQUFTTixRQUFRTyxpQkFBaUIsUUFBU0ksR0FHL0MsU0FBU0MsRUFBZ0JDLEdBQ3JCLElBQU1DLEVBQVFDLEtBQUtDLE1BQU1ILEVBQVcsTUFDOUJJLEVBQU9GLEtBQUtDLE9BQU9ILEVBQW1CLEtBQVJDLEdBQW1CLEtBRXZELE1BQU8sQ0FBRUEsTUFBSyxFQUFFRyxLQUFJLEVBQUVDLEtBRFRKLEVBQVEsRUFBSUEsRUFBUSxNQUFRLEtBQU9HLEVBQU8sR0FBZSxJQUFWSCxFQUFjRyxFQUFPLE9BQVMsS0FJOUYsU0FBU0UsRUFBVUMsR0FDZixJQUFNUCxFQUFXRCxFQUFnQlEsRUFBUVAsVUFDekMsTUFBTyw4S0FHc0NPLEVBQVE1QixJQUFNLElBQUUsMkhBR2hCNEIsRUFBUS9ELEtBQUkscUdBQytCK0QsRUFBUS9ELEtBQUksMkhBR3ZEd0QsRUFBU0ssSUFBRyxvTEFFNkNMLEVBQVNDLE1BQUssZ0hBQ2ZELEVBQVNJLEtBQUksZ2FBeUJ0SCxTQUFTVCxFQUFpQmEsR0FDVm5CLEVBQWNtQixFQUFNQyxlQUM1QkMsVUFBVUMsSUFBSSxZQUd0QixTQUFTZixFQUFpQlksR0FDdEIsSUFBTTlCLEVBQU1XLEVBQWNtQixFQUFNQyxlQUMxQmhCLEVBQVdoQixFQUFZQyxHQUM3QixHQUFJZSxFQUFTZCxHQUFHaUMsVUFBVyxDQUN2QmxDLEVBQUlnQyxVQUFVRyxPQUFPLFlBQ3JCLElBQU1OLEVBQVUvQixFQUFTc0MsTUFBSyxTQUFDQyxHQUFTLE9BQUFBLEVBQUtwQyxHQUFLLEtBQU9jLEVBQVNkLEdBQUdpQyxhQUMvRFosRUFBV0QsRUFBZ0JRLEVBQVFQLFVBQ3pDUCxFQUFTWixlQUFlM0IsTUFBUXFELEVBQVEvRCxLQUN4Q2lELEVBQVNWLHdCQUF3QjdCLE1BQVE4QyxFQUFTQyxNQUFRLEdBQzFEUixFQUFTVCx1QkFBdUI5QixNQUFROEMsRUFBU0ksS0FBTyxRQUV2RDFCLEVBQUlhLGNBQWN5QixZQUFZdEMsR0FHdkMsU0FBZW1CLEVBQWlCVyxHLGtHQUM1QixPQUFLUyxRQUFRLHFCQUNQdkMsRUFBTVcsRUFBY21CLEVBQU1DLGVBQzFCaEIsRUFBV2hCLEVBQVlDLEdBQzdCLEdBQU13QyxNQUFNLDhCQUFnQ3pCLEVBQVNkLEdBQUdpQyxVQUFXLENBQUVPLE9BQVEsYUFIM0MsSSxjQUdsQyxTQUNBM0MsRUFBV0EsRUFBUzRDLFFBQU8sU0FBQ0wsR0FBUyxPQUFBQSxFQUFLcEMsR0FBSyxLQUFPYyxFQUFTZCxHQUFHaUMsYUFDbEVsQyxFQUFJYSxjQUFjeUIsWUFBWXRDLEcsV0FHbEMsU0FBZW9CLEVBQWVVLEcsaUhBQ3BCOUIsRUFBTVcsRUFBY21CLEVBQU1DLGVBQzFCaEIsRUFBV2hCLEVBQVlDLEdBQ3ZCc0IsRUFBcUQsTUFBekNQLEVBQVNWLHdCQUF3QjdCLE1BQTJELEtBQXhDdUMsRUFBU1QsdUJBQXVCOUIsTUFDbEd1QyxFQUFTZCxHQUFHaUMsVUFFWixHQUFNTSxNQUFNLDBCQUEyQixDQUNuQ0MsT0FBUSxNQUNSRSxLQUFNQyxLQUFLQyxVQUFVLENBQ2pCNUMsSUFBS2MsRUFBU2QsR0FBR2lDLFVBQ2pCcEUsS0FBTWlELEVBQVNaLGVBQWUzQixNQUM5QjhDLFNBQVEsT0FQaEIsTSxjQUVBLFMsYUFTb0MsT0FBcEMsRUFBQVAsRUFBU2QsR0FBZSxLQUFZLEdBQU11QyxNQUFNLHVCQUF3QixDQUNwRUMsT0FBUSxPQUNSRSxLQUFNQyxLQUFLQyxVQUFVLENBQ2pCL0UsS0FBTWlELEVBQVNaLGVBQWUzQixNQUM5QjhDLFNBQVEsTyxPQUphLFNBQU8sU0FNaEN3QixRLE9BTkosRUFBWVosVUFBWSxFQUFLLFMsd0JBUTNCYSxFQUFjMUIsRUFBZ0JDLEdBQ3BDUCxFQUFTYixVQUFVZ0MsVUFBWW5CLEVBQVNaLGVBQWUzQixNQUN2RHVDLEVBQVNYLGNBQWM4QixVQUFZYSxFQUFZcEIsSUFDL0MzQixFQUFJZ0MsVUFBVUcsT0FBTyxZLFdBMUl6QnpDLEVBQU9zQixpQkFBaUIsU0F3RXhCLFdBTUlwQixFQUFjb0QsbUJBQW1CLGFBQWNwQixFQUxuQixDQUN4QjNCLEdBQUksS0FDSm5DLEtBQU0sR0FDTndELFNBQVUsUUFHZCxJQUFNMkIsRUFBU3JELEVBQWNzRCxrQkFDN0JwQyxFQUF1Qm1DLEdBQ3ZCbEQsRUFBWWtELEdBQVExQyxVQUFVNEMsV0EvRWxDWCxNQUFNLDJCQUEyQlksTUFBSyxTQUFDQyxHQUFTLE9BQUFBLEVBQUtQLFVBQVFNLE1BQUssU0FBQ0UsR0FFL0QsSUFBb0IsVUFEcEJ4RCxFQUFXd0QsRUFDUyxlQUFVLENBQXpCLElBQUl6QixFQUFPLEtBQWNqQyxFQUFjb0QsbUJBQW1CLFlBQWFwQixFQUFVQyxJQUN0RixJQUFLLElBQUl0RSxFQUFJLEVBQUdBLEVBQUlzQyxFQUFLMEQsT0FBUWhHLElBQUt1RCxFQUF1QmpCLEVBQUt0QyIsImZpbGUiOiJhZG1pbi9wcm9ncmFtcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA3KTtcbiIsImltcG9ydCBcIi4vcHJvZ3JhbXMuc2Nzc1wiO1xuaW1wb3J0IFwiLi4vLi4vLi4vY29tcG9uZW50cy9hZG1pbi9wcm9ncmFtc0NydWQvcHJvZ3JhbXNDcnVkLnRzXCI7IiwibW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcHVibGljX3BhdGhfXyArIFwiYWRtaW4vcHJvZ3JhbXMuY3NzXCI7IiwiZXhwb3J0IHsgfTtcblxuY29uc3QgY29tcCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJwcm9ncmFtcy1jcnVkLWNvbXBvbmVudFwiKVswXSBhcyBIVE1MRWxlbWVudDtcbmNvbnN0IGFkZEJ0biA9IGNvbXAucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fYnRuLl9hZGRcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5jb25zdCByb3dzQ29udGFpbmVyID0gY29tcC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwidGFibGVfX2JvZHlcIilbMF0gYXMgSFRNTEVsZW1lbnQ7XG5jb25zdCByb3dzID0gcm93c0NvbnRhaW5lci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwidGFibGVfX3Jvd1wiKSBhcyBIVE1MQ29sbGVjdGlvbk9mPEhUTUxFbGVtZW50PjtcbmxldCBwcm9ncmFtczogUHJvZ3JhbVtdID0gW107XG5cbmFkZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25BZGRCdG5DbGljayk7XG5cbmZldGNoKGAvYXBpL3Byb2dyYW0vZ2V0QWxsLnBocGApLnRoZW4oKHJlc3ApID0+IHJlc3AuanNvbigpKS50aGVuKChkYXRhKSA9PiB7XG4gICAgcHJvZ3JhbXMgPSBkYXRhO1xuICAgIGZvciAobGV0IHByb2dyYW0gb2YgcHJvZ3JhbXMpIHJvd3NDb250YWluZXIuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsIGNyZWF0ZVJvdyhwcm9ncmFtKSk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb3dzLmxlbmd0aDsgaSsrKSBhZGRFdmVudExpc3RlbmVyc1RvUm93KHJvd3NbaV0pO1xufVxuXG4pO1xuXG5mdW5jdGlvbiBnZXRSb3dFbGVtcyhyb3c6IEhUTUxFbGVtZW50KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19jZWxsLl9pZCAudGFibGVfX2NlbGwtdmFsdWVcIikgYXMgSFRNTEVsZW1lbnQsXG4gICAgICAgIG5hbWVWYWx1ZTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2NlbGwuX25hbWUgLnRhYmxlX19jZWxsLXZhbHVlXCIpIGFzIEhUTUxFbGVtZW50LFxuICAgICAgICBuYW1lQ2hhbmdlRWxlbTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2NlbGwuX25hbWUgLnRhYmxlX19jZWxsLWNoYW5nZS1lbGVtXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgIGR1cmF0aW9uVmFsdWU6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19jZWxsLl9kdXJhdGlvbiAudGFibGVfX2NlbGwtdmFsdWVcIikgYXMgSFRNTEVsZW1lbnQsXG4gICAgICAgIGR1cmF0aW9uQ2hhbmdlRWxlbUhvdXJzOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fY2VsbC5fZHVyYXRpb24gLnRhYmxlX19jZWxsLWNoYW5nZS1lbGVtLl9ob3Vyc1wiKSBhcyBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICBkdXJhdGlvbkNoYW5nZUVsZW1NaW5zOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fY2VsbC5fZHVyYXRpb24gLnRhYmxlX19jZWxsLWNoYW5nZS1lbGVtLl9taW5zXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgIGJ0bkNoYW5nZTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2J0bi5fY2hhbmdlXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICBidG5EZWxldGU6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19idG4uX2RlbGV0ZVwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgYnRuU2F2ZTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2J0bi5fc2F2ZVwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgYnRuQ2FuY2VsOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fYnRuLl9jYW5jZWxcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnRcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldEJ1dHRvbnNSb3coYnV0dG9uOiBIVE1MQnV0dG9uRWxlbWVudCkge1xuICAgIHJldHVybiAoYnV0dG9uLnBhcmVudEVsZW1lbnQgYXMgSFRNTEVsZW1lbnQpLnBhcmVudEVsZW1lbnQgYXMgSFRNTEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXJzVG9Sb3cocm93OiBIVE1MRWxlbWVudCkge1xuICAgIGNvbnN0IHJvd0VsZW1zID0gZ2V0Um93RWxlbXMocm93KTtcbiAgICByb3dFbGVtcy5idG5DaGFuZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uQ2hhbmdlQnRuQ2xpY2spO1xuICAgIHJvd0VsZW1zLmJ0bkNhbmNlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25DYW5jZWxCdG5DbGljayk7XG4gICAgcm93RWxlbXMuYnRuRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbkRlbGV0ZUJ0bkNsaWNrKTtcbiAgICByb3dFbGVtcy5idG5TYXZlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvblNhdmVCdG5DbGljayk7XG59XG5cbmZ1bmN0aW9uIGNvbnZlcnREdXJhdGlvbihkdXJhdGlvbjogbnVtYmVyKSB7XG4gICAgY29uc3QgaG91cnMgPSBNYXRoLmZsb29yKGR1cmF0aW9uIC8gMzYwMDAwMCk7XG4gICAgY29uc3QgbWlucyA9IE1hdGguZmxvb3IoKGR1cmF0aW9uIC0gaG91cnMgKiAzNjAwMDAwKSAvIDYwMDAwKTtcbiAgICBjb25zdCBzdHIgPSAoaG91cnMgPiAwID8gaG91cnMgKyBcItGHLiBcIiA6IFwiXCIpICsgKG1pbnMgPiAwIHx8IGhvdXJzID09PSAwID8gbWlucyArIFwi0LzQuNC9LlwiIDogXCJcIik7XG4gICAgcmV0dXJuIHsgaG91cnMsIG1pbnMsIHN0ciB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVJvdyhwcm9ncmFtOiBQcm9ncmFtKSB7XG4gICAgY29uc3QgZHVyYXRpb24gPSBjb252ZXJ0RHVyYXRpb24ocHJvZ3JhbS5kdXJhdGlvbik7XG4gICAgcmV0dXJuIGA8ZGl2IGNsYXNzPVwidGFibGVfX3Jvd1wiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NvbnRlbnQtY2VsbHMtY29udGFpbmVyXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwgX2lkXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jZWxsLXZhbHVlXCI+JHtwcm9ncmFtLmlkIHx8IFwiXCJ9PC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbCBfbmFtZVwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbC12YWx1ZVwiPiR7cHJvZ3JhbS5uYW1lfTwvZGl2PlxuICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz1cInRhYmxlX19jZWxsLWNoYW5nZS1lbGVtXCIgbWF4bGVuZ3RoPVwiMjAwXCIgbmFtZT1cIm5hbWVcIiB2YWx1ZT1cIiR7cHJvZ3JhbS5uYW1lfVwiPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwgX2R1cmF0aW9uXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jZWxsLXZhbHVlXCI+JHtkdXJhdGlvbi5zdHJ9PC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jZWxsLWNoYW5nZS1lbGVtLWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJ0YWJsZV9fY2VsbC1jaGFuZ2UtZWxlbSBfaG91cnNcIiB0eXBlPVwibnVtYmVyXCIgbWluPVwiMFwiIG1heD1cIjI0XCIgdmFsdWU9XCIke2R1cmF0aW9uLmhvdXJzfVwiPtGHLlxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJ0YWJsZV9fY2VsbC1jaGFuZ2UtZWxlbSBfbWluc1wiIHR5cGU9XCJudW1iZXJcIiBtaW49XCIwXCIgbWF4PVwiNTlcIiB2YWx1ZT1cIiR7ZHVyYXRpb24ubWluc31cIj7QvNC40L0uXG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbCBfYnRuc1wiPlxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cInBpIHBpLXBlbmNpbCB0YWJsZV9fYnRuIF9jaGFuZ2VcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS10cmFzaCB0YWJsZV9fYnRuIF9kZWxldGVcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS1zYXZlIHRhYmxlX19idG4gX3NhdmVcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS10aW1lcyB0YWJsZV9fYnRuIF9jYW5jZWxcIj48L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+YFxufVxuXG5mdW5jdGlvbiBvbkFkZEJ0bkNsaWNrKCkge1xuICAgIGNvbnN0IG5ld1Byb2dyYW06IFByb2dyYW0gPSB7XG4gICAgICAgIGlkOiBudWxsLFxuICAgICAgICBuYW1lOiBcIlwiLFxuICAgICAgICBkdXJhdGlvbjogMzYwMDAwMFxuICAgIH1cbiAgICByb3dzQ29udGFpbmVyLmluc2VydEFkamFjZW50SFRNTChcImFmdGVyYmVnaW5cIiwgY3JlYXRlUm93KG5ld1Byb2dyYW0pKTtcbiAgICBjb25zdCBuZXdSb3cgPSByb3dzQ29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkIGFzIEhUTUxFbGVtZW50O1xuICAgIGFkZEV2ZW50TGlzdGVuZXJzVG9Sb3cobmV3Um93KTtcbiAgICBnZXRSb3dFbGVtcyhuZXdSb3cpLmJ0bkNoYW5nZS5jbGljaygpO1xufVxuXG5mdW5jdGlvbiBvbkNoYW5nZUJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICByb3cuY2xhc3NMaXN0LmFkZChcIl9jaGFuZ2VkXCIpO1xufVxuXG5mdW5jdGlvbiBvbkNhbmNlbEJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICBjb25zdCByb3dFbGVtcyA9IGdldFJvd0VsZW1zKHJvdyk7XG4gICAgaWYgKHJvd0VsZW1zLmlkLmlubmVyVGV4dCkge1xuICAgICAgICByb3cuY2xhc3NMaXN0LnJlbW92ZShcIl9jaGFuZ2VkXCIpO1xuICAgICAgICBjb25zdCBwcm9ncmFtID0gcHJvZ3JhbXMuZmluZCgoaXRlbSkgPT4gaXRlbS5pZCArIFwiXCIgPT09IHJvd0VsZW1zLmlkLmlubmVyVGV4dCk7XG4gICAgICAgIGNvbnN0IGR1cmF0aW9uID0gY29udmVydER1cmF0aW9uKHByb2dyYW0uZHVyYXRpb24pO1xuICAgICAgICByb3dFbGVtcy5uYW1lQ2hhbmdlRWxlbS52YWx1ZSA9IHByb2dyYW0ubmFtZTtcbiAgICAgICAgcm93RWxlbXMuZHVyYXRpb25DaGFuZ2VFbGVtSG91cnMudmFsdWUgPSBkdXJhdGlvbi5ob3VycyArIFwiXCI7XG4gICAgICAgIHJvd0VsZW1zLmR1cmF0aW9uQ2hhbmdlRWxlbU1pbnMudmFsdWUgPSBkdXJhdGlvbi5taW5zICsgXCJcIjtcbiAgICB9XG4gICAgZWxzZSByb3cucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChyb3cpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBvbkRlbGV0ZUJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgaWYgKCFjb25maXJtKFwi0KXQvtGA0L7RiNC+INC/0L7QtNGD0LzQsNC70Lg/XCIpKSByZXR1cm47XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICBjb25zdCByb3dFbGVtcyA9IGdldFJvd0VsZW1zKHJvdyk7XG4gICAgYXdhaXQgZmV0Y2goXCIvYXBpL3Byb2dyYW0vZGVsZXRlLnBocD9pZD1cIiArIHJvd0VsZW1zLmlkLmlubmVyVGV4dCwgeyBtZXRob2Q6IFwiZGVsZXRlXCIgfSk7XG4gICAgcHJvZ3JhbXMgPSBwcm9ncmFtcy5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0uaWQgKyBcIlwiICE9PSByb3dFbGVtcy5pZC5pbm5lclRleHQpO1xuICAgIHJvdy5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHJvdyk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIG9uU2F2ZUJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICBjb25zdCByb3dFbGVtcyA9IGdldFJvd0VsZW1zKHJvdyk7XG4gICAgY29uc3QgZHVyYXRpb24gPSArcm93RWxlbXMuZHVyYXRpb25DaGFuZ2VFbGVtSG91cnMudmFsdWUgKiAzNjAwMDAwICsgK3Jvd0VsZW1zLmR1cmF0aW9uQ2hhbmdlRWxlbU1pbnMudmFsdWUgKiA2MDAwMDtcbiAgICBpZiAocm93RWxlbXMuaWQuaW5uZXJUZXh0KSB7XG5cbiAgICAgICAgYXdhaXQgZmV0Y2goYC9hcGkvcHJvZ3JhbS9jaGFuZ2UucGhwYCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcInB1dFwiLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIGlkOiArcm93RWxlbXMuaWQuaW5uZXJUZXh0LFxuICAgICAgICAgICAgICAgIG5hbWU6IHJvd0VsZW1zLm5hbWVDaGFuZ2VFbGVtLnZhbHVlLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByb3dFbGVtcy5pZC5pbm5lclRleHQgPSBcIlwiICsgYXdhaXQgKGF3YWl0IGZldGNoKGAvYXBpL3Byb2dyYW0vYWRkLnBocGAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgbmFtZTogcm93RWxlbXMubmFtZUNoYW5nZUVsZW0udmFsdWUsXG4gICAgICAgICAgICAgICAgZHVyYXRpb25cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pKS5qc29uKCk7XG4gICAgfVxuICAgIGNvbnN0IGR1cmF0aW9uT2JqID0gY29udmVydER1cmF0aW9uKGR1cmF0aW9uKTtcbiAgICByb3dFbGVtcy5uYW1lVmFsdWUuaW5uZXJUZXh0ID0gcm93RWxlbXMubmFtZUNoYW5nZUVsZW0udmFsdWU7XG4gICAgcm93RWxlbXMuZHVyYXRpb25WYWx1ZS5pbm5lclRleHQgPSBkdXJhdGlvbk9iai5zdHI7XG4gICAgcm93LmNsYXNzTGlzdC5yZW1vdmUoXCJfY2hhbmdlZFwiKTtcbn1cblxuY2xhc3MgUHJvZ3JhbSB7XG4gICAgaWQ6IG51bWJlcjtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgZHVyYXRpb246IG51bWJlcjtcbn0iXSwic291cmNlUm9vdCI6IiJ9