!function(e){var t={};function n(r){if(t[r])return t[r].exports;var l=t[r]={i:r,l:!1,exports:{}};return e[r].call(l.exports,l,l.exports,n),l.l=!0,l.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)n.d(r,l,function(t){return e[t]}.bind(null,l));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}({6:function(e,t,n){"use strict";n.r(t);n(7),n(8)},7:function(e,t,n){e.exports=n.p+"admin/home.css"},8:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(l,a){function i(e){try{o(r.next(e))}catch(e){a(e)}}function c(e){try{o(r.throw(e))}catch(e){a(e)}}function o(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}o((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,l,a,i={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(l=2&a[0]?r.return:a[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,a[1])).done)return l;switch(r=0,l&&(a=[2&a[0],l.value]),a[0]){case 0:case 1:l=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(l=(l=i.trys).length>0&&l[l.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!l||a[1]>l[0]&&a[1]<l[3])){i.label=a[1];break}if(6===a[0]&&i.label<l[1]){i.label=l[1],l=a;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(a);break}l[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=l=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},l=document.getElementsByClassName("advertising-crud-component")[0],a=l.querySelector(".table__btn._add"),i=l.getElementsByClassName("table__body")[0],c=i.getElementsByClassName("table__row"),o=[];function s(e){return{id:e.querySelector(".table__cell._id .table__cell-value"),nameValue:e.querySelector(".table__cell._name .table__cell-value"),nameChangeElem:e.querySelector(".table__cell._name .table__cell-change-elem"),yearValue:e.querySelector(".table__cell._year .table__cell-value"),yearChangeElem:e.querySelector(".table__cell._year .table__cell-change-elem"),descriptionChangeElem:e.querySelector(".table__cell._description .table__cell-change-elem"),btnChange:e.querySelector(".table__btn._change"),btnDelete:e.querySelector(".table__btn._delete"),btnSave:e.querySelector(".table__btn._save"),btnCancel:e.querySelector(".table__btn._cancel"),btnOrderPlus:e.querySelector(".table__btn._order-plus"),btnOrderMinus:e.querySelector(".table__btn._order-minus"),btnBlock:e.querySelector(".table__btn._block")}}function u(e){return e.parentElement.parentElement}function d(e){var t=s(e);t.btnChange.addEventListener("click",v),t.btnCancel.addEventListener("click",p),t.btnDelete.addEventListener("click",m),t.btnSave.addEventListener("click",h),t.btnBlock.addEventListener("click",g),t.btnOrderPlus.addEventListener("click",b),t.btnOrderMinus.addEventListener("click",_)}function b(e){var t=u(e.currentTarget);t.nextElementSibling&&t.parentElement.insertBefore(t,t.nextElementSibling.nextElementSibling)}function _(e){var t=u(e.currentTarget);t.previousElementSibling&&t.parentElement.insertBefore(t,t.previousElementSibling)}function f(e){return'<div class="table__row" data-is-block="'+(e.is_block?"true":"false")+'" data-order="'+e.order+'">\n        <div class="table__content-cells-container">\n            <div class="table__cell _id">\n                <div class="table__cell-value">'+(e.id||"")+'</div>\n            </div>\n            <div class="table__cell _name">\n                <div class="table__cell-value">'+e.name+'</div>\n                <input class="table__cell-change-elem" maxlength="200" name="name" value="'+e.name+'">\n            </div>\n            <div class="table__cell _year">\n                <div class="table__cell-value">'+e.year+'</div>\n                <input class="table__cell-change-elem" type="number" min="0" max="9999" value="'+e.year+'">\n            </div>\n            <div class="table__cell _description">\n                <div>Описание</div>\n                <textarea class="table__cell-change-elem" maxlength="2000">'+e.description+'</textarea>\n            </div>\n            <div class="table__cell _img">\n                <div>Изображение</div>\n            </div>\n        </div>\n        <div class="table__cell _btns">\n            <button class="pi pi-pencil table__btn _change"></button>\n            <button class="pi pi-trash table__btn _delete"></button>\n            <button class="pi pi-save table__btn _save"></button>\n            <button class="pi pi-times table__btn _cancel"></button>\n            <button class="pi pi-arrow-up table__btn _order-minus"></button>\n            <button class="pi pi-arrow-down table__btn _order-plus"></button>\n            <button class="pi pi-'+(e.is_block?"unlock":"lock")+' table__btn _block"></button>\n        </div>\n    </div>'}function v(e){u(e.currentTarget).classList.add("_changed")}function p(e){var t=u(e.currentTarget),n=s(t);if(n.id.innerText){t.classList.remove("_changed");var r=o.find((function(e){return e.id+""===n.id.innerText}));n.nameChangeElem.value=r.name,n.descriptionChangeElem.value=r.description,n.yearChangeElem.value=r.year+"",t.dataset.isBlock=r.is_block?"true":"false",r.is_block?(n.btnBlock.classList.remove("pi-lock"),n.btnBlock.classList.add("pi-unlock")):(n.btnBlock.classList.remove("pi-unlock"),n.btnBlock.classList.add("pi-lock"));for(var l=null,a=r.order,i=1;i<=c.length;i++)if(c[i]===t){l=i;break}l>a?t.parentElement.insertBefore(t,c[a-1]):l<a&&t.parentElement.insertBefore(t,c[a-1].nextElementSibling)}else t.parentElement.removeChild(t)}function m(e){return n(this,void 0,void 0,(function(){var t,n,l,a,i,d,b;return r(this,(function(r){switch(r.label){case 0:return confirm("Хорошо подумали?")?(t=u(e.currentTarget),n=s(t),[4,fetch("/api/advertising/delete.php?id="+n.id.innerText,{method:"delete"})]):[2];case 1:for(r.sent(),o=o.filter((function(e){return e.id!==+n.id.innerText})),l=+t.dataset.order,t.parentElement.removeChild(t),a=0;a<c.length;a++)+c[a].dataset.order>l&&(c[a].dataset.order=+c[a].dataset.order-1+"");for(i=0,d=o;i<d.length;i++)(b=d[i]).order>l&&b.order--;return[2]}}))}))}function h(e){return n(this,void 0,void 0,(function(){var t,n,l,a,i,d,b,_,f,v,p,m,h,g,y,k;return r(this,(function(r){switch(r.label){case 0:for(t=u(e.currentTarget),n=s(t),i=1;i<=c.length;i++)if(c[i]===t){l=i;break}for(d=0,b=o;d<b.length;d++)if((k=b[d]).id===+n.id.innerText){a=k.order;break}return a||(a=o.length+1),_=null,n.id.innerText?(_=+n.id.innerText,f={id:+n.id.innerText,name:n.nameChangeElem.value,description:n.descriptionChangeElem.value,year:+n.yearChangeElem.value,img_file_name:"",is_block:"true"===t.dataset.isBlock,order:l},[4,fetch("/api/advertising/change.php",{method:"put",body:JSON.stringify(f)})]):[3,2];case 1:return r.sent(),o=o.map((function(e){return e.id===f.id?f:e})),[3,5];case 2:return v={id:null,name:n.nameChangeElem.value,description:n.descriptionChangeElem.value,year:+n.yearChangeElem.value,img_file_name:"",is_block:"true"===t.dataset.isBlock,order:l},p=v,[4,fetch("/api/advertising/add.php",{method:"post",body:JSON.stringify(v)})];case 3:return[4,r.sent().json()];case 4:p.id=r.sent(),_=v.id,n.id.innerText=""+v.id,o.push(v),r.label=5;case 5:if(n.nameValue.innerText=n.nameChangeElem.value,n.yearValue.innerText=n.yearChangeElem.value,l>a)for(m=0,h=o;m<h.length;m++)(k=h[m]).order>a&&k.order<=l&&k.id!==_&&k.order--;else if(l<a)for(g=0,y=o;g<y.length;g++)(k=y[g]).order<a&&k.order>=l&&k.id!==_&&k.order++;return t.classList.remove("_changed"),[2]}}))}))}function g(e){var t=e.currentTarget,n=u(t);n.dataset.isBlock="true"===n.dataset.isBlock?"false":"true","true"===n.dataset.isBlock?(t.classList.remove("pi-lock"),t.classList.add("pi-unlock")):(t.classList.remove("pi-unlock"),t.classList.add("pi-lock"))}a.addEventListener("click",(function(){var e={id:null,name:"",description:"",img_file_name:"",is_block:!1,order:o.length+1,year:(new Date).getFullYear()};i.insertAdjacentHTML("beforeend",f(e)),i.scrollTop=i.scrollHeight;var t=i.lastElementChild;d(t),s(t).btnChange.click()})),fetch("/api/advertising/getAll.php").then((function(e){return e.json()})).then((function(e){for(var t=0,n=o=e;t<n.length;t++){var r=n[t];i.insertAdjacentHTML("beforeend",f(r))}for(var l=0;l<c.length;l++)d(c[l])}))}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vcGFnZXMvYWRtaW4vaG9tZS9ob21lLnRzIiwid2VicGFjazovLy8uL3BhZ2VzL2FkbWluL2hvbWUvaG9tZS5zY3NzIiwid2VicGFjazovLy8uL2NvbXBvbmVudHMvYWRtaW4vYWR2ZXJ0aXNpbmdDcnVkL2FkdmVydGlzaW5nQ3J1ZC50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImNvbXAiLCJkb2N1bWVudCIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJhZGRCdG4iLCJxdWVyeVNlbGVjdG9yIiwicm93c0NvbnRhaW5lciIsInJvd3MiLCJhZHZlcnRpc2luZ3MiLCJnZXRSb3dFbGVtcyIsInJvdyIsImlkIiwibmFtZVZhbHVlIiwibmFtZUNoYW5nZUVsZW0iLCJ5ZWFyVmFsdWUiLCJ5ZWFyQ2hhbmdlRWxlbSIsImRlc2NyaXB0aW9uQ2hhbmdlRWxlbSIsImJ0bkNoYW5nZSIsImJ0bkRlbGV0ZSIsImJ0blNhdmUiLCJidG5DYW5jZWwiLCJidG5PcmRlclBsdXMiLCJidG5PcmRlck1pbnVzIiwiYnRuQmxvY2siLCJnZXRCdXR0b25zUm93IiwiYnV0dG9uIiwicGFyZW50RWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXJzVG9Sb3ciLCJyb3dFbGVtcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJvbkNoYW5nZUJ0bkNsaWNrIiwib25DYW5jZWxCdG5DbGljayIsIm9uRGVsZXRlQnRuQ2xpY2siLCJvblNhdmVCdG5DbGljayIsIm9uQmxvY2tCdG5DbGljayIsIm9uT3JkZXJQbHVzQnRuQ2xpY2siLCJvbk9yZGVyTWludXNCdG5DbGljayIsImV2ZW50IiwiY3VycmVudFRhcmdldCIsIm5leHRFbGVtZW50U2libGluZyIsImluc2VydEJlZm9yZSIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJjcmVhdGVSb3ciLCJhZCIsImlzX2Jsb2NrIiwib3JkZXIiLCJ5ZWFyIiwiZGVzY3JpcHRpb24iLCJjbGFzc0xpc3QiLCJhZGQiLCJpbm5lclRleHQiLCJyZW1vdmUiLCJmaW5kIiwiaXRlbSIsImRhdGFzZXQiLCJpc0Jsb2NrIiwiY3VycmVudE9yZGVyIiwib2xkT3JkZXIiLCJsZW5ndGgiLCJyZW1vdmVDaGlsZCIsImNvbmZpcm0iLCJmZXRjaCIsIm1ldGhvZCIsImZpbHRlciIsInJvd09yZGVyIiwibmV3T3JkZXIiLCJjaGFuZ2VkQWRJZCIsImltZ19maWxlX25hbWUiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIm1hcCIsIm5ld0FkIiwianNvbiIsInB1c2giLCJidG4iLCJEYXRlIiwiZ2V0RnVsbFllYXIiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJzY3JvbGxUb3AiLCJzY3JvbGxIZWlnaHQiLCJuZXdSb3ciLCJsYXN0RWxlbWVudENoaWxkIiwiY2xpY2siLCJ0aGVuIiwicmVzcCIsImRhdGEiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxR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RUFBcUIsQ0FDdkI3RCxHQUFJLEtBQ0puQyxLQUFNLEdBQ051RSxZQUFhLEdBQ2JvQixjQUFlLEdBQ2Z2QixVQUFVLEVBQ1ZDLE1BQU9yQyxFQUFha0QsT0FBUyxFQUM3QlosTUFBTSxJQUFLOEIsTUFBTUMsZUFFckJ2RSxFQUFjd0UsbUJBQW1CLFlBQWFwQyxFQUFVOEIsSUFDeERsRSxFQUFjeUUsVUFBWXpFLEVBQWMwRSxhQUN4QyxJQUFNQyxFQUFTM0UsRUFBYzRFLGlCQUM3QnZELEVBQXVCc0QsR0FDdkJ4RSxFQUFZd0UsR0FBUWhFLFVBQVVrRSxXQXJHbEN0QixNQUFNLCtCQUErQnVCLE1BQUssU0FBQ0MsR0FBUyxPQUFBQSxFQUFLWixVQUFRVyxNQUFLLFNBQUNFLEdBRW5FLElBQWUsVUFEZjlFLEVBQWU4RSxFQUNBLGVBQWMsQ0FBeEIsSUFBSTNDLEVBQUUsS0FBa0JyQyxFQUFjd0UsbUJBQW1CLFlBQWFwQyxFQUFVQyxJQUNyRixJQUFLLElBQUkxRSxFQUFJLEVBQUdBLEVBQUlzQyxFQUFLbUQsT0FBUXpGLElBQUswRCxFQUF1QnBCLEVBQUt0QyIsImZpbGUiOiJhZG1pbi9ob21lLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDYpO1xuIiwiaW1wb3J0IFwiLi9ob21lLnNjc3NcIjtcbmltcG9ydCBcIi4uLy4uLy4uL2NvbXBvbmVudHMvYWRtaW4vYWR2ZXJ0aXNpbmdDcnVkL2FkdmVydGlzaW5nQ3J1ZC50c1wiOyIsIm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3B1YmxpY19wYXRoX18gKyBcImFkbWluL2hvbWUuY3NzXCI7IiwiZXhwb3J0IHsgfTtcblxuY29uc3QgY29tcCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJhZHZlcnRpc2luZy1jcnVkLWNvbXBvbmVudFwiKVswXSBhcyBIVE1MRWxlbWVudDtcbmNvbnN0IGFkZEJ0biA9IGNvbXAucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fYnRuLl9hZGRcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5jb25zdCByb3dzQ29udGFpbmVyID0gY29tcC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwidGFibGVfX2JvZHlcIilbMF0gYXMgSFRNTEVsZW1lbnQ7XG5jb25zdCByb3dzID0gcm93c0NvbnRhaW5lci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwidGFibGVfX3Jvd1wiKSBhcyBIVE1MQ29sbGVjdGlvbk9mPEhUTUxFbGVtZW50PjtcbmxldCBhZHZlcnRpc2luZ3M6IEFkdmVydGlzaW5nW10gPSBbXTtcblxuYWRkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbkFkZEJ0bkNsaWNrKTtcblxuZmV0Y2goYC9hcGkvYWR2ZXJ0aXNpbmcvZ2V0QWxsLnBocGApLnRoZW4oKHJlc3ApID0+IHJlc3AuanNvbigpKS50aGVuKChkYXRhKSA9PiB7XG4gICAgYWR2ZXJ0aXNpbmdzID0gZGF0YTtcbiAgICBmb3IgKGxldCBhZCBvZiBhZHZlcnRpc2luZ3MpIHJvd3NDb250YWluZXIuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsIGNyZWF0ZVJvdyhhZCkpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm93cy5sZW5ndGg7IGkrKykgYWRkRXZlbnRMaXN0ZW5lcnNUb1Jvdyhyb3dzW2ldKTtcbn0pO1xuXG5mdW5jdGlvbiBnZXRSb3dFbGVtcyhyb3c6IEhUTUxFbGVtZW50KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19jZWxsLl9pZCAudGFibGVfX2NlbGwtdmFsdWVcIikgYXMgSFRNTEVsZW1lbnQsXG4gICAgICAgIG5hbWVWYWx1ZTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2NlbGwuX25hbWUgLnRhYmxlX19jZWxsLXZhbHVlXCIpIGFzIEhUTUxFbGVtZW50LFxuICAgICAgICBuYW1lQ2hhbmdlRWxlbTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2NlbGwuX25hbWUgLnRhYmxlX19jZWxsLWNoYW5nZS1lbGVtXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgIHllYXJWYWx1ZTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2NlbGwuX3llYXIgLnRhYmxlX19jZWxsLXZhbHVlXCIpIGFzIEhUTUxFbGVtZW50LFxuICAgICAgICB5ZWFyQ2hhbmdlRWxlbTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2NlbGwuX3llYXIgLnRhYmxlX19jZWxsLWNoYW5nZS1lbGVtXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgIGRlc2NyaXB0aW9uQ2hhbmdlRWxlbTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2NlbGwuX2Rlc2NyaXB0aW9uIC50YWJsZV9fY2VsbC1jaGFuZ2UtZWxlbVwiKSBhcyBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICBidG5DaGFuZ2U6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19idG4uX2NoYW5nZVwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgYnRuRGVsZXRlOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fYnRuLl9kZWxldGVcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgIGJ0blNhdmU6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19idG4uX3NhdmVcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgIGJ0bkNhbmNlbDogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2J0bi5fY2FuY2VsXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICBidG5PcmRlclBsdXM6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19idG4uX29yZGVyLXBsdXNcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgIGJ0bk9yZGVyTWludXM6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19idG4uX29yZGVyLW1pbnVzXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICBidG5CbG9jazogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2J0bi5fYmxvY2tcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnRcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldEJ1dHRvbnNSb3coYnV0dG9uOiBIVE1MQnV0dG9uRWxlbWVudCkge1xuICAgIHJldHVybiAoYnV0dG9uLnBhcmVudEVsZW1lbnQgYXMgSFRNTEVsZW1lbnQpLnBhcmVudEVsZW1lbnQgYXMgSFRNTEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXJzVG9Sb3cocm93OiBIVE1MRWxlbWVudCkge1xuICAgIGNvbnN0IHJvd0VsZW1zID0gZ2V0Um93RWxlbXMocm93KTtcbiAgICByb3dFbGVtcy5idG5DaGFuZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uQ2hhbmdlQnRuQ2xpY2spO1xuICAgIHJvd0VsZW1zLmJ0bkNhbmNlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25DYW5jZWxCdG5DbGljayk7XG4gICAgcm93RWxlbXMuYnRuRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbkRlbGV0ZUJ0bkNsaWNrKTtcbiAgICByb3dFbGVtcy5idG5TYXZlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvblNhdmVCdG5DbGljayk7XG4gICAgcm93RWxlbXMuYnRuQmxvY2suYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uQmxvY2tCdG5DbGljayk7XG4gICAgcm93RWxlbXMuYnRuT3JkZXJQbHVzLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbk9yZGVyUGx1c0J0bkNsaWNrKTtcbiAgICByb3dFbGVtcy5idG5PcmRlck1pbnVzLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbk9yZGVyTWludXNCdG5DbGljayk7XG59XG5cbmZ1bmN0aW9uIG9uT3JkZXJQbHVzQnRuQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICBjb25zdCByb3cgPSBnZXRCdXR0b25zUm93KGV2ZW50LmN1cnJlbnRUYXJnZXQgYXMgSFRNTEJ1dHRvbkVsZW1lbnQpO1xuICAgIGlmIChyb3cubmV4dEVsZW1lbnRTaWJsaW5nKSB7XG4gICAgICAgIHJvdy5wYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZShyb3csIHJvdy5uZXh0RWxlbWVudFNpYmxpbmcubmV4dEVsZW1lbnRTaWJsaW5nKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG9uT3JkZXJNaW51c0J0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICBpZiAocm93LnByZXZpb3VzRWxlbWVudFNpYmxpbmcpIHtcbiAgICAgICAgcm93LnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKHJvdywgcm93LnByZXZpb3VzRWxlbWVudFNpYmxpbmcpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlUm93KGFkOiBBZHZlcnRpc2luZykge1xuICAgIHJldHVybiBgPGRpdiBjbGFzcz1cInRhYmxlX19yb3dcIiBkYXRhLWlzLWJsb2NrPVwiJHthZC5pc19ibG9jayA/IFwidHJ1ZVwiIDogXCJmYWxzZVwifVwiIGRhdGEtb3JkZXI9XCIke2FkLm9yZGVyfVwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NvbnRlbnQtY2VsbHMtY29udGFpbmVyXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwgX2lkXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jZWxsLXZhbHVlXCI+JHthZC5pZCB8fCBcIlwifTwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwgX25hbWVcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwtdmFsdWVcIj4ke2FkLm5hbWV9PC9kaXY+XG4gICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVwidGFibGVfX2NlbGwtY2hhbmdlLWVsZW1cIiBtYXhsZW5ndGg9XCIyMDBcIiBuYW1lPVwibmFtZVwiIHZhbHVlPVwiJHthZC5uYW1lfVwiPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwgX3llYXJcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwtdmFsdWVcIj4ke2FkLnllYXJ9PC9kaXY+XG4gICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVwidGFibGVfX2NlbGwtY2hhbmdlLWVsZW1cIiB0eXBlPVwibnVtYmVyXCIgbWluPVwiMFwiIG1heD1cIjk5OTlcIiB2YWx1ZT1cIiR7YWQueWVhcn1cIj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jZWxsIF9kZXNjcmlwdGlvblwiPlxuICAgICAgICAgICAgICAgIDxkaXY+0J7Qv9C40YHQsNC90LjQtTwvZGl2PlxuICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBjbGFzcz1cInRhYmxlX19jZWxsLWNoYW5nZS1lbGVtXCIgbWF4bGVuZ3RoPVwiMjAwMFwiPiR7YWQuZGVzY3JpcHRpb259PC90ZXh0YXJlYT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jZWxsIF9pbWdcIj5cbiAgICAgICAgICAgICAgICA8ZGl2PtCY0LfQvtCx0YDQsNC20LXQvdC40LU8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jZWxsIF9idG5zXCI+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwicGkgcGktcGVuY2lsIHRhYmxlX19idG4gX2NoYW5nZVwiPjwvYnV0dG9uPlxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cInBpIHBpLXRyYXNoIHRhYmxlX19idG4gX2RlbGV0ZVwiPjwvYnV0dG9uPlxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cInBpIHBpLXNhdmUgdGFibGVfX2J0biBfc2F2ZVwiPjwvYnV0dG9uPlxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cInBpIHBpLXRpbWVzIHRhYmxlX19idG4gX2NhbmNlbFwiPjwvYnV0dG9uPlxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cInBpIHBpLWFycm93LXVwIHRhYmxlX19idG4gX29yZGVyLW1pbnVzXCI+PC9idXR0b24+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwicGkgcGktYXJyb3ctZG93biB0YWJsZV9fYnRuIF9vcmRlci1wbHVzXCI+PC9idXR0b24+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwicGkgcGktJHthZC5pc19ibG9jayA/IFwidW5sb2NrXCIgOiBcImxvY2tcIn0gdGFibGVfX2J0biBfYmxvY2tcIj48L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+YFxufVxuXG5mdW5jdGlvbiBvbkFkZEJ0bkNsaWNrKCkge1xuICAgIGNvbnN0IG5ld0FkOiBBZHZlcnRpc2luZyA9IHtcbiAgICAgICAgaWQ6IG51bGwsXG4gICAgICAgIG5hbWU6IFwiXCIsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlwiLFxuICAgICAgICBpbWdfZmlsZV9uYW1lOiBcIlwiLFxuICAgICAgICBpc19ibG9jazogZmFsc2UsXG4gICAgICAgIG9yZGVyOiBhZHZlcnRpc2luZ3MubGVuZ3RoICsgMSxcbiAgICAgICAgeWVhcjogKG5ldyBEYXRlKS5nZXRGdWxsWWVhcigpXG4gICAgfVxuICAgIHJvd3NDb250YWluZXIuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsIGNyZWF0ZVJvdyhuZXdBZCkpO1xuICAgIHJvd3NDb250YWluZXIuc2Nyb2xsVG9wID0gcm93c0NvbnRhaW5lci5zY3JvbGxIZWlnaHQ7XG4gICAgY29uc3QgbmV3Um93ID0gcm93c0NvbnRhaW5lci5sYXN0RWxlbWVudENoaWxkIGFzIEhUTUxFbGVtZW50O1xuICAgIGFkZEV2ZW50TGlzdGVuZXJzVG9Sb3cobmV3Um93KTtcbiAgICBnZXRSb3dFbGVtcyhuZXdSb3cpLmJ0bkNoYW5nZS5jbGljaygpO1xufVxuXG5mdW5jdGlvbiBvbkNoYW5nZUJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICByb3cuY2xhc3NMaXN0LmFkZChcIl9jaGFuZ2VkXCIpO1xufVxuXG5mdW5jdGlvbiBvbkNhbmNlbEJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICBjb25zdCByb3dFbGVtcyA9IGdldFJvd0VsZW1zKHJvdyk7XG4gICAgaWYgKHJvd0VsZW1zLmlkLmlubmVyVGV4dCkge1xuICAgICAgICByb3cuY2xhc3NMaXN0LnJlbW92ZShcIl9jaGFuZ2VkXCIpO1xuICAgICAgICBjb25zdCBhZCA9IGFkdmVydGlzaW5ncy5maW5kKChpdGVtKSA9PiBpdGVtLmlkICsgXCJcIiA9PT0gcm93RWxlbXMuaWQuaW5uZXJUZXh0KTtcbiAgICAgICAgcm93RWxlbXMubmFtZUNoYW5nZUVsZW0udmFsdWUgPSBhZC5uYW1lO1xuICAgICAgICByb3dFbGVtcy5kZXNjcmlwdGlvbkNoYW5nZUVsZW0udmFsdWUgPSBhZC5kZXNjcmlwdGlvbjtcbiAgICAgICAgcm93RWxlbXMueWVhckNoYW5nZUVsZW0udmFsdWUgPSBhZC55ZWFyICsgXCJcIjtcblxuICAgICAgICByb3cuZGF0YXNldC5pc0Jsb2NrID0gYWQuaXNfYmxvY2sgPyBcInRydWVcIiA6IFwiZmFsc2VcIjtcbiAgICAgICAgaWYgKGFkLmlzX2Jsb2NrKSB7XG4gICAgICAgICAgICByb3dFbGVtcy5idG5CbG9jay5jbGFzc0xpc3QucmVtb3ZlKFwicGktbG9ja1wiKTtcbiAgICAgICAgICAgIHJvd0VsZW1zLmJ0bkJsb2NrLmNsYXNzTGlzdC5hZGQoXCJwaS11bmxvY2tcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByb3dFbGVtcy5idG5CbG9jay5jbGFzc0xpc3QucmVtb3ZlKFwicGktdW5sb2NrXCIpO1xuICAgICAgICAgICAgcm93RWxlbXMuYnRuQmxvY2suY2xhc3NMaXN0LmFkZChcInBpLWxvY2tcIik7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY3VycmVudE9yZGVyID0gbnVsbDtcbiAgICAgICAgbGV0IG9sZE9yZGVyID0gYWQub3JkZXI7XG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHJvd3MubGVuZ3RoOyBpKyspIGlmIChyb3dzW2ldID09PSByb3cpIHtcbiAgICAgICAgICAgIGN1cnJlbnRPcmRlciA9IGk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAoY3VycmVudE9yZGVyID4gb2xkT3JkZXIpIHtcbiAgICAgICAgICAgIHJvdy5wYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZShyb3csIHJvd3Nbb2xkT3JkZXIgLSAxXSk7XG4gICAgICAgIH0gZWxzZSBpZiAoY3VycmVudE9yZGVyIDwgb2xkT3JkZXIpIHtcbiAgICAgICAgICAgIHJvdy5wYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZShyb3csIHJvd3Nbb2xkT3JkZXIgLSAxXS5uZXh0RWxlbWVudFNpYmxpbmcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Ugcm93LnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQocm93KTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gb25EZWxldGVCdG5DbGljayhldmVudDogTW91c2VFdmVudCkge1xuICAgIGlmICghY29uZmlybShcItCl0L7RgNC+0YjQviDQv9C+0LTRg9C80LDQu9C4P1wiKSkgcmV0dXJuO1xuICAgIGNvbnN0IHJvdyA9IGdldEJ1dHRvbnNSb3coZXZlbnQuY3VycmVudFRhcmdldCBhcyBIVE1MQnV0dG9uRWxlbWVudCk7XG4gICAgY29uc3Qgcm93RWxlbXMgPSBnZXRSb3dFbGVtcyhyb3cpO1xuICAgIGF3YWl0IGZldGNoKFwiL2FwaS9hZHZlcnRpc2luZy9kZWxldGUucGhwP2lkPVwiICsgcm93RWxlbXMuaWQuaW5uZXJUZXh0LCB7IG1ldGhvZDogXCJkZWxldGVcIiB9KTtcbiAgICBhZHZlcnRpc2luZ3MgPSBhZHZlcnRpc2luZ3MuZmlsdGVyKChpdGVtKSA9PiBpdGVtLmlkICE9PSArcm93RWxlbXMuaWQuaW5uZXJUZXh0KTtcbiAgICBjb25zdCByb3dPcmRlciA9ICtyb3cuZGF0YXNldC5vcmRlcjtcbiAgICByb3cucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChyb3cpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm93cy5sZW5ndGg7IGkrKykgaWYgKCtyb3dzW2ldLmRhdGFzZXQub3JkZXIgPiByb3dPcmRlcikge1xuICAgICAgICByb3dzW2ldLmRhdGFzZXQub3JkZXIgPSArcm93c1tpXS5kYXRhc2V0Lm9yZGVyIC0gMSArIFwiXCI7XG4gICAgfVxuICAgIGZvciAobGV0IGl0ZW0gb2YgYWR2ZXJ0aXNpbmdzKSBpZiAoaXRlbS5vcmRlciA+IHJvd09yZGVyKSBpdGVtLm9yZGVyLS07XG59XG5cbmFzeW5jIGZ1bmN0aW9uIG9uU2F2ZUJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICBjb25zdCByb3dFbGVtcyA9IGdldFJvd0VsZW1zKHJvdyk7XG4gICAgbGV0IG5ld09yZGVyOiBudW1iZXI7XG4gICAgbGV0IG9sZE9yZGVyOiBudW1iZXI7XG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gcm93cy5sZW5ndGg7IGkrKykgaWYgKHJvd3NbaV0gPT09IHJvdykge1xuICAgICAgICBuZXdPcmRlciA9IGk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBmb3IgKGxldCBpdGVtIG9mIGFkdmVydGlzaW5ncykgaWYgKGl0ZW0uaWQgPT09ICtyb3dFbGVtcy5pZC5pbm5lclRleHQpIHtcbiAgICAgICAgb2xkT3JkZXIgPSBpdGVtLm9yZGVyO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKCFvbGRPcmRlcikge1xuICAgICAgICBvbGRPcmRlciA9IGFkdmVydGlzaW5ncy5sZW5ndGggKyAxO1xuICAgIH1cbiAgICBsZXQgY2hhbmdlZEFkSWQgPSBudWxsO1xuICAgIGlmIChyb3dFbGVtcy5pZC5pbm5lclRleHQpIHtcbiAgICAgICAgY2hhbmdlZEFkSWQgPSArcm93RWxlbXMuaWQuaW5uZXJUZXh0O1xuICAgICAgICBjb25zdCBjaGFuZ2VkQWQ6IEFkdmVydGlzaW5nID0ge1xuICAgICAgICAgICAgaWQ6ICtyb3dFbGVtcy5pZC5pbm5lclRleHQsXG4gICAgICAgICAgICBuYW1lOiByb3dFbGVtcy5uYW1lQ2hhbmdlRWxlbS52YWx1ZSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiByb3dFbGVtcy5kZXNjcmlwdGlvbkNoYW5nZUVsZW0udmFsdWUsXG4gICAgICAgICAgICB5ZWFyOiArcm93RWxlbXMueWVhckNoYW5nZUVsZW0udmFsdWUsXG4gICAgICAgICAgICBpbWdfZmlsZV9uYW1lOiBcIlwiLFxuICAgICAgICAgICAgaXNfYmxvY2s6IHJvdy5kYXRhc2V0LmlzQmxvY2sgPT09IFwidHJ1ZVwiID8gdHJ1ZSA6IGZhbHNlLFxuICAgICAgICAgICAgb3JkZXI6IG5ld09yZGVyXG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgZmV0Y2goYC9hcGkvYWR2ZXJ0aXNpbmcvY2hhbmdlLnBocGAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJwdXRcIixcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGNoYW5nZWRBZClcbiAgICAgICAgfSk7XG4gICAgICAgIGFkdmVydGlzaW5ncyA9IGFkdmVydGlzaW5ncy5tYXAoKGl0ZW0pID0+IGl0ZW0uaWQgPT09IGNoYW5nZWRBZC5pZCA/IGNoYW5nZWRBZCA6IGl0ZW0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IG5ld0FkOiBBZHZlcnRpc2luZyA9IHtcbiAgICAgICAgICAgIGlkOiBudWxsLFxuICAgICAgICAgICAgbmFtZTogcm93RWxlbXMubmFtZUNoYW5nZUVsZW0udmFsdWUsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogcm93RWxlbXMuZGVzY3JpcHRpb25DaGFuZ2VFbGVtLnZhbHVlLFxuICAgICAgICAgICAgeWVhcjogK3Jvd0VsZW1zLnllYXJDaGFuZ2VFbGVtLnZhbHVlLFxuICAgICAgICAgICAgaW1nX2ZpbGVfbmFtZTogXCJcIixcbiAgICAgICAgICAgIGlzX2Jsb2NrOiByb3cuZGF0YXNldC5pc0Jsb2NrID09PSBcInRydWVcIiA/IHRydWUgOiBmYWxzZSxcbiAgICAgICAgICAgIG9yZGVyOiBuZXdPcmRlclxuICAgICAgICB9XG4gICAgICAgIG5ld0FkLmlkID0gYXdhaXQgKGF3YWl0IGZldGNoKGAvYXBpL2FkdmVydGlzaW5nL2FkZC5waHBgLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkobmV3QWQpXG4gICAgICAgIH0pKS5qc29uKCk7XG4gICAgICAgIGNoYW5nZWRBZElkID0gbmV3QWQuaWQ7XG4gICAgICAgIHJvd0VsZW1zLmlkLmlubmVyVGV4dCA9IFwiXCIgKyBuZXdBZC5pZDtcbiAgICAgICAgYWR2ZXJ0aXNpbmdzLnB1c2gobmV3QWQpO1xuICAgIH1cbiAgICByb3dFbGVtcy5uYW1lVmFsdWUuaW5uZXJUZXh0ID0gcm93RWxlbXMubmFtZUNoYW5nZUVsZW0udmFsdWU7XG4gICAgcm93RWxlbXMueWVhclZhbHVlLmlubmVyVGV4dCA9IHJvd0VsZW1zLnllYXJDaGFuZ2VFbGVtLnZhbHVlO1xuICAgIGlmIChuZXdPcmRlciA+IG9sZE9yZGVyKSB7XG4gICAgICAgIGZvciAobGV0IGl0ZW0gb2YgYWR2ZXJ0aXNpbmdzKSBpZiAoaXRlbS5vcmRlciA+IG9sZE9yZGVyICYmIGl0ZW0ub3JkZXIgPD0gbmV3T3JkZXIgJiYgaXRlbS5pZCAhPT0gY2hhbmdlZEFkSWQpIHtcbiAgICAgICAgICAgIGl0ZW0ub3JkZXItLTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAobmV3T3JkZXIgPCBvbGRPcmRlcikge1xuICAgICAgICBmb3IgKGxldCBpdGVtIG9mIGFkdmVydGlzaW5ncykgaWYgKGl0ZW0ub3JkZXIgPCBvbGRPcmRlciAmJiBpdGVtLm9yZGVyID49IG5ld09yZGVyICYmIGl0ZW0uaWQgIT09IGNoYW5nZWRBZElkKSB7XG4gICAgICAgICAgICBpdGVtLm9yZGVyKys7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcm93LmNsYXNzTGlzdC5yZW1vdmUoXCJfY2hhbmdlZFwiKTtcbn1cblxuZnVuY3Rpb24gb25CbG9ja0J0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgY29uc3QgYnRuID0gZXZlbnQuY3VycmVudFRhcmdldCBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbiAgICBjb25zdCByb3cgPSBnZXRCdXR0b25zUm93KGJ0bik7XG4gICAgcm93LmRhdGFzZXQuaXNCbG9jayA9IHJvdy5kYXRhc2V0LmlzQmxvY2sgPT09IFwidHJ1ZVwiID8gXCJmYWxzZVwiIDogXCJ0cnVlXCI7XG4gICAgaWYgKHJvdy5kYXRhc2V0LmlzQmxvY2sgPT09IFwidHJ1ZVwiKSB7XG4gICAgICAgIGJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwicGktbG9ja1wiKTtcbiAgICAgICAgYnRuLmNsYXNzTGlzdC5hZGQoXCJwaS11bmxvY2tcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJwaS11bmxvY2tcIik7XG4gICAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKFwicGktbG9ja1wiKTtcbiAgICB9XG59XG5cbmNsYXNzIEFkdmVydGlzaW5nIHtcbiAgICBpZDogbnVtYmVyO1xuICAgIG5hbWU6IHN0cmluZztcbiAgICB5ZWFyOiBudW1iZXI7XG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgICBpbWdfZmlsZV9uYW1lOiBzdHJpbmc7XG4gICAgaXNfYmxvY2s6IGJvb2xlYW47XG4gICAgb3JkZXI6IG51bWJlclxufSJdLCJzb3VyY2VSb290IjoiIn0=