!function(e){var t={};function n(l){if(t[l])return t[l].exports;var r=t[l]={i:l,l:!1,exports:{}};return e[l].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(l,r,function(t){return e[t]}.bind(null,r));return l},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}({6:function(e,t,n){"use strict";n.r(t);n(7);function l(e){e.innerHTML="",e.insertAdjacentHTML("afterbegin",'\n        <img src="/files/images/noImage.png">\n        <label class="button">\n            <span>Выбрать изображение</span>\n            <input type="file">\n        </label>\n    '),e.classList.add("input-img");var t=e.getElementsByTagName("img")[0],n=e.getElementsByTagName("input")[0];n.addEventListener("change",(function(l){var r=l.target.files;if("image/jpeg"!==r[0].type&&"image/png"!==r[0].type)return alert("Error. Invalid file type. Valid only 'image/jpeg' and 'image/png'.");var a=new FileReader;a.addEventListener("load",(function(l){t.src=l.target.result,e.dataset.newValue=l.target.result,n.value=null})),a.readAsDataURL(r[0])}))}function r(e){return e.dataset.newValue}var a=function(e,t,n,l){return new(n||(n=Promise))((function(r,a){function i(e){try{o(l.next(e))}catch(e){a(e)}}function c(e){try{o(l.throw(e))}catch(e){a(e)}}function o(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}o((l=l.apply(e,t||[])).next())}))},i=function(e,t){var n,l,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,l&&(r=2&a[0]?l.return:a[0]?l.throw||((r=l.return)&&r.call(l),0):l.next)&&!(r=r.call(l,a[1])).done)return r;switch(l=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,l=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],l=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},c=document.getElementsByClassName("advertising-crud-component")[0],o=c.querySelector(".table__btn._add"),s=c.getElementsByClassName("table__body")[0],u=s.getElementsByClassName("table__row"),d=[];function b(e){return{id:e.querySelector(".table__cell._id .table__cell-value"),nameValue:e.querySelector(".table__cell._name .table__cell-value"),nameChangeElem:e.querySelector(".table__cell._name .table__cell-change-elem"),yearValue:e.querySelector(".table__cell._year .table__cell-value"),yearChangeElem:e.querySelector(".table__cell._year .table__cell-change-elem"),descriptionChangeElem:e.querySelector(".table__cell._description .table__cell-change-elem"),btnChange:e.querySelector(".table__btn._change"),btnDelete:e.querySelector(".table__btn._delete"),btnSave:e.querySelector(".table__btn._save"),btnCancel:e.querySelector(".table__btn._cancel"),btnOrderPlus:e.querySelector(".table__btn._order-plus"),btnOrderMinus:e.querySelector(".table__btn._order-minus"),btnBlock:e.querySelector(".table__btn._block"),inputImg:e.querySelector(".table__cell._img .table__cell-change-elem")}}function _(e){return e.parentElement.parentElement}function m(e){var t=b(e);t.btnChange.addEventListener("click",v),t.btnCancel.addEventListener("click",h),t.btnDelete.addEventListener("click",y),t.btnSave.addEventListener("click",E),t.btnBlock.addEventListener("click",k),t.btnOrderPlus.addEventListener("click",f),t.btnOrderMinus.addEventListener("click",g)}function f(e){var t=_(e.currentTarget);t.nextElementSibling&&t.parentElement.insertBefore(t,t.nextElementSibling.nextElementSibling)}function g(e){var t=_(e.currentTarget);t.previousElementSibling&&t.parentElement.insertBefore(t,t.previousElementSibling)}function p(e){return'<div class="table__row" data-is-block="'+(e.is_block?"true":"false")+'" data-order="'+e.order+'">\n        <div class="table__content-cells-container">\n            <div class="table__cell _id">\n                <div class="table__cell-value">'+(e.id||"")+'</div>\n            </div>\n            <div class="table__cell _name">\n                <div class="table__cell-value">'+e.name+'</div>\n                <input class="table__cell-change-elem" maxlength="200" name="name" value="'+e.name+'">\n            </div>\n            <div class="table__cell _year">\n                <div class="table__cell-value">'+e.year+'</div>\n                <input class="table__cell-change-elem" type="number" min="0" max="9999" value="'+e.year+'">\n            </div>\n            <div class="table__cell _description">\n                <div>Описание</div>\n                <textarea class="table__cell-change-elem" maxlength="2000">'+e.description+'</textarea>\n            </div>\n            <div class="table__cell _img">\n                <div>Изображение</div>\n                <div class="input-img table__cell-change-elem"></div>\n            </div>\n        </div>\n        <div class="table__cell _btns">\n            <button class="pi pi-pencil table__btn _change"></button>\n            <button class="pi pi-trash table__btn _delete"></button>\n            <button class="pi pi-save table__btn _save"></button>\n            <button class="pi pi-times table__btn _cancel"></button>\n            <button class="pi pi-arrow-up table__btn _order-minus"></button>\n            <button class="pi pi-arrow-down table__btn _order-plus"></button>\n            <button class="pi pi-'+(e.is_block?"unlock":"lock")+' table__btn _block"></button>\n        </div>\n    </div>'}function v(e){_(e.currentTarget).classList.add("_changed")}function h(e){var t=_(e.currentTarget),n=b(t);if(n.id.innerText){t.classList.remove("_changed");var l=d.find((function(e){return e.id+""===n.id.innerText}));n.nameChangeElem.value=l.name,n.descriptionChangeElem.value=l.description,n.yearChangeElem.value=l.year+"",t.dataset.isBlock=l.is_block?"true":"false",l.is_block?(n.btnBlock.classList.remove("pi-lock"),n.btnBlock.classList.add("pi-unlock")):(n.btnBlock.classList.remove("pi-unlock"),n.btnBlock.classList.add("pi-lock"));for(var r=null,a=l.order,i=1;i<=u.length;i++)if(u[i]===t){r=i;break}r>a?t.parentElement.insertBefore(t,u[a-1]):r<a&&t.parentElement.insertBefore(t,u[a-1].nextElementSibling)}else t.parentElement.removeChild(t)}function y(e){return a(this,void 0,void 0,(function(){var t,n,l,r,a,c,o;return i(this,(function(i){switch(i.label){case 0:return confirm("Хорошо подумали?")?(t=_(e.currentTarget),n=b(t),[4,fetch("/api/advertising/delete.php?id="+n.id.innerText,{method:"delete"})]):[2];case 1:for(i.sent(),d=d.filter((function(e){return e.id!==+n.id.innerText})),l=+t.dataset.order,t.parentElement.removeChild(t),r=0;r<u.length;r++)+u[r].dataset.order>l&&(u[r].dataset.order=+u[r].dataset.order-1+"");for(a=0,c=d;a<c.length;a++)(o=c[a]).order>l&&o.order--;return[2]}}))}))}function E(e){return a(this,void 0,void 0,(function(){var t,n,l,a,c,o,s,m,f,g,p,v,h,y,E,k;return i(this,(function(i){switch(i.label){case 0:for(t=_(e.currentTarget),n=b(t),c=0;c<u.length;c++)if(u[c]===t){l=c+1;break}for(o=0,s=d;o<s.length;o++)if((k=s[o]).id===+n.id.innerText){a=k.order;break}return a||(a=d.length+1),m=null,n.id.innerText?(m=+n.id.innerText,f={id:+n.id.innerText,name:n.nameChangeElem.value,description:n.descriptionChangeElem.value,year:+n.yearChangeElem.value,img_file_name:"",is_block:"true"===t.dataset.isBlock,order:l,newImg:r(n.inputImg)},[4,fetch("/api/advertising/change.php",{method:"put",body:JSON.stringify(f)})]):[3,2];case 1:return i.sent(),d=d.map((function(e){return e.id===f.id?f:e})),[3,5];case 2:return g={id:null,name:n.nameChangeElem.value,description:n.descriptionChangeElem.value,year:+n.yearChangeElem.value,img_file_name:"",is_block:"true"===t.dataset.isBlock,order:l,newImg:r(n.inputImg)},p=g,[4,fetch("/api/advertising/add.php",{method:"post",body:JSON.stringify(g)})];case 3:return[4,i.sent().json()];case 4:p.id=i.sent(),m=g.id,n.id.innerText=""+g.id,d.push(g),i.label=5;case 5:if(n.nameValue.innerText=n.nameChangeElem.value,n.yearValue.innerText=n.yearChangeElem.value,l>a)for(v=0,h=d;v<h.length;v++)(k=h[v]).order>a&&k.order<=l&&k.id!==m&&k.order--;else if(l<a)for(y=0,E=d;y<E.length;y++)(k=E[y]).order<a&&k.order>=l&&k.id!==m&&k.order++;return t.classList.remove("_changed"),[2]}}))}))}function k(e){var t=e.currentTarget,n=_(t);n.dataset.isBlock="true"===n.dataset.isBlock?"false":"true","true"===n.dataset.isBlock?(t.classList.remove("pi-lock"),t.classList.add("pi-unlock")):(t.classList.remove("pi-unlock"),t.classList.add("pi-lock"))}o.addEventListener("click",(function(){var e={id:null,name:"",description:"",img_file_name:"",is_block:!1,order:d.length+1,year:(new Date).getFullYear()};s.insertAdjacentHTML("beforeend",p(e));var t=s.lastElementChild;m(t),l(t.getElementsByClassName("input-img")[0]),b(t).btnChange.click(),setTimeout((function(){return s.scrollTop=s.scrollHeight}))})),fetch("/api/advertising/getAll.php").then((function(e){return e.json()})).then((function(e){for(var t=0,n=d=e;t<n.length;t++){var r=n[t];s.insertAdjacentHTML("beforeend",p(r));var a=u[u.length-1].getElementsByClassName("input-img")[0];l(a),r.img_file_name&&(i=a,c="/files/images/"+r.img_file_name,i.getElementsByTagName("img")[0].src=c)}for(var i,c,o=0;o<u.length;o++)m(u[o])}))},7:function(e,t,n){e.exports=n.p+"admin/home.css"}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vY29tcG9uZW50cy9hZG1pbi9pbnB1dC1pbWcvaW5wdXQtaW1nLnRzIiwid2VicGFjazovLy8uL2NvbXBvbmVudHMvYWRtaW4vYWR2ZXJ0aXNpbmdDcnVkL2FkdmVydGlzaW5nQ3J1ZC50cyIsIndlYnBhY2s6Ly8vLi9wYWdlcy9hZG1pbi9ob21lL2hvbWUuc2NzcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImNyZWF0ZUlucHV0SW1nIiwiZWxlbWVudCIsImlubmVySFRNTCIsImluc2VydEFkamFjZW50SFRNTCIsImNsYXNzTGlzdCIsImFkZCIsImltZyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiaW5wdXQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJmaWxlcyIsInRhcmdldCIsInR5cGUiLCJhbGVydCIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJzcmMiLCJyZXN1bHQiLCJkYXRhc2V0IiwibmV3VmFsdWUiLCJyZWFkQXNEYXRhVVJMIiwiZ2V0TmV3SW5wdXRJbWdWYWx1ZSIsImNvbXAiLCJkb2N1bWVudCIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJhZGRCdG4iLCJxdWVyeVNlbGVjdG9yIiwicm93c0NvbnRhaW5lciIsInJvd3MiLCJhZHZlcnRpc2luZ3MiLCJnZXRSb3dFbGVtcyIsInJvdyIsImlkIiwibmFtZVZhbHVlIiwibmFtZUNoYW5nZUVsZW0iLCJ5ZWFyVmFsdWUiLCJ5ZWFyQ2hhbmdlRWxlbSIsImRlc2NyaXB0aW9uQ2hhbmdlRWxlbSIsImJ0bkNoYW5nZSIsImJ0bkRlbGV0ZSIsImJ0blNhdmUiLCJidG5DYW5jZWwiLCJidG5PcmRlclBsdXMiLCJidG5PcmRlck1pbnVzIiwiYnRuQmxvY2siLCJpbnB1dEltZyIsImdldEJ1dHRvbnNSb3ciLCJidXR0b24iLCJwYXJlbnRFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lcnNUb1JvdyIsInJvd0VsZW1zIiwib25DaGFuZ2VCdG5DbGljayIsIm9uQ2FuY2VsQnRuQ2xpY2siLCJvbkRlbGV0ZUJ0bkNsaWNrIiwib25TYXZlQnRuQ2xpY2siLCJvbkJsb2NrQnRuQ2xpY2siLCJvbk9yZGVyUGx1c0J0bkNsaWNrIiwib25PcmRlck1pbnVzQnRuQ2xpY2siLCJjdXJyZW50VGFyZ2V0IiwibmV4dEVsZW1lbnRTaWJsaW5nIiwiaW5zZXJ0QmVmb3JlIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsImNyZWF0ZVJvdyIsImFkIiwiaXNfYmxvY2siLCJvcmRlciIsInllYXIiLCJkZXNjcmlwdGlvbiIsImlubmVyVGV4dCIsInJlbW92ZSIsImZpbmQiLCJpdGVtIiwiaXNCbG9jayIsImN1cnJlbnRPcmRlciIsIm9sZE9yZGVyIiwibGVuZ3RoIiwicmVtb3ZlQ2hpbGQiLCJjb25maXJtIiwiZmV0Y2giLCJtZXRob2QiLCJmaWx0ZXIiLCJyb3dPcmRlciIsIm5ld09yZGVyIiwiY2hhbmdlZEFkSWQiLCJpbWdfZmlsZV9uYW1lIiwibmV3SW1nIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJtYXAiLCJuZXdBZCIsImpzb24iLCJwdXNoIiwiYnRuIiwiRGF0ZSIsImdldEZ1bGxZZWFyIiwibmV3Um93IiwibGFzdEVsZW1lbnRDaGlsZCIsImNsaWNrIiwic2V0VGltZW91dCIs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Y0FBZSxHQUNmcEIsVUFBVSxFQUNWQyxNQUFPcEMsRUFBYThDLE9BQVMsRUFDN0JULE1BQU0sSUFBSzRCLE1BQU1DLGVBRXJCcEUsRUFBY3pCLG1CQUFtQixZQUFhNEQsRUFBVTRCLElBQ3hELElBQU1NLEVBQVNyRSxFQUFjc0UsaUJBQzdCaEQsRUFBdUIrQyxHQUN2QmpHLEVBQWVpRyxFQUFPeEUsdUJBQXVCLGFBQWEsSUFDMURNLEVBQVlrRSxHQUFRMUQsVUFBVTRELFFBQzlCQyxZQUFXLFdBQU0sT0FBQXhFLEVBQWN5RSxVQUFZekUsRUFBYzBFLG1CQTdHN0R2QixNQUFNLCtCQUErQndCLE1BQUssU0FBQ0MsR0FBUyxPQUFBQSxFQUFLWixVQUFRVyxNQUFLLFNBQUNFLEdBRW5FLElBQWUsVUFEZjNFLEVBQWUyRSxFQUNBLGVBQWMsQ0FBeEIsSUFBSXpDLEVBQUUsS0FDUHBDLEVBQWN6QixtQkFBbUIsWUFBYTRELEVBQVVDLElBQ3hELElBQU0wQyxFQUFTN0UsRUFBS0EsRUFBSytDLE9BQVMsR0FBR25ELHVCQUF1QixhQUFhLEdBQ3pFekIsRUFBZTBHLEdBQ1gxQyxFQUFHcUIsZ0JEU3lCcEYsRUNUY3lHLEVEU1F6SCxFQ3pCeEMsaUJBZ0J3RCtFLEVBQUdxQixjRFU3RXBGLEVBQVFNLHFCQUFxQixPQUFPLEdBQUdVLElBQU1oQyxHQ1I3QyxJRE9HLElBQWlDZ0IsRUFBc0JoQixFQ1BqRGpCLEVBQUksRUFBR0EsRUFBSTZELEVBQUsrQyxPQUFRNUcsSUFBS2tGLEVBQXVCckIsRUFBSzdELFEsa0JDdEJ0RUQsRUFBT0QsUUFBVSxJQUEwQiIsImZpbGUiOiJhZG1pbi9ob21lLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDYpO1xuIiwiZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUlucHV0SW1nKGVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XG4gICAgZWxlbWVudC5pbm5lckhUTUwgPSBcIlwiO1xuICAgIGVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYWZ0ZXJiZWdpblwiLCBgXG4gICAgICAgIDxpbWcgc3JjPVwiL2ZpbGVzL2ltYWdlcy9ub0ltYWdlLnBuZ1wiPlxuICAgICAgICA8bGFiZWwgY2xhc3M9XCJidXR0b25cIj5cbiAgICAgICAgICAgIDxzcGFuPtCS0YvQsdGA0LDRgtGMINC40LfQvtCx0YDQsNC20LXQvdC40LU8L3NwYW4+XG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cImZpbGVcIj5cbiAgICAgICAgPC9sYWJlbD5cbiAgICBgKTtcbiAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJpbnB1dC1pbWdcIik7XG5cbiAgICBjb25zdCBpbWcgPSBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW1nXCIpWzBdO1xuICAgIGNvbnN0IGlucHV0ID0gZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdO1xuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKGV2ZW50KSA9PiB7XG4gICAgICAgIGxldCBmaWxlcyA9IChldmVudC50YXJnZXQgYXMgYW55KS5maWxlcztcbiAgICAgICAgaWYgKGZpbGVzWzBdLnR5cGUgIT09ICdpbWFnZS9qcGVnJyAmJiBmaWxlc1swXS50eXBlICE9PSAnaW1hZ2UvcG5nJykge1xuICAgICAgICAgICAgcmV0dXJuIGFsZXJ0KFwiRXJyb3IuIEludmFsaWQgZmlsZSB0eXBlLiBWYWxpZCBvbmx5ICdpbWFnZS9qcGVnJyBhbmQgJ2ltYWdlL3BuZycuXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgIHJlYWRlci5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGltZy5zcmMgPSBldmVudC50YXJnZXQucmVzdWx0IGFzIHN0cmluZztcbiAgICAgICAgICAgIGVsZW1lbnQuZGF0YXNldC5uZXdWYWx1ZSA9IGV2ZW50LnRhcmdldC5yZXN1bHQgYXMgc3RyaW5nO1xuICAgICAgICAgICAgaW5wdXQudmFsdWUgPSBudWxsO1xuICAgICAgICB9KTtcbiAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZXNbMF0pO1xuICAgIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0Q3VycmVudElucHV0SW1nVmFsdWUoZWxlbWVudDogSFRNTEVsZW1lbnQsIHZhbHVlOiBzdHJpbmcpIHtcbiAgICBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW1nXCIpWzBdLnNyYyA9IHZhbHVlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmV3SW5wdXRJbWdWYWx1ZShlbGVtZW50OiBIVE1MRWxlbWVudCkge1xuICAgIHJldHVybiBlbGVtZW50LmRhdGFzZXQubmV3VmFsdWU7XG59XG5cbiIsImV4cG9ydCB7IH07XG5cbmltcG9ydCB7IGNyZWF0ZUlucHV0SW1nLCBzZXRDdXJyZW50SW5wdXRJbWdWYWx1ZSwgZ2V0TmV3SW5wdXRJbWdWYWx1ZSB9IGZyb20gXCIuLi9pbnB1dC1pbWcvaW5wdXQtaW1nXCI7XG5cbmNvbnN0IGltYWdlc1VybFJvb3QgPSBcIi9maWxlcy9pbWFnZXMvXCI7XG5cbmNvbnN0IGNvbXAgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYWR2ZXJ0aXNpbmctY3J1ZC1jb21wb25lbnRcIilbMF0gYXMgSFRNTEVsZW1lbnQ7XG5jb25zdCBhZGRCdG4gPSBjb21wLnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2J0bi5fYWRkXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuY29uc3Qgcm93c0NvbnRhaW5lciA9IGNvbXAuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInRhYmxlX19ib2R5XCIpWzBdIGFzIEhUTUxFbGVtZW50O1xuY29uc3Qgcm93cyA9IHJvd3NDb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInRhYmxlX19yb3dcIikgYXMgSFRNTENvbGxlY3Rpb25PZjxIVE1MRWxlbWVudD47XG5sZXQgYWR2ZXJ0aXNpbmdzOiBBZHZlcnRpc2luZ1tdID0gW107XG5cbmFkZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25BZGRCdG5DbGljayk7XG5cbmZldGNoKGAvYXBpL2FkdmVydGlzaW5nL2dldEFsbC5waHBgKS50aGVuKChyZXNwKSA9PiByZXNwLmpzb24oKSkudGhlbigoZGF0YSkgPT4ge1xuICAgIGFkdmVydGlzaW5ncyA9IGRhdGE7XG4gICAgZm9yIChsZXQgYWQgb2YgYWR2ZXJ0aXNpbmdzKSB7XG4gICAgICAgIHJvd3NDb250YWluZXIuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsIGNyZWF0ZVJvdyhhZCkpO1xuICAgICAgICBjb25zdCBpbnBJbWcgPSByb3dzW3Jvd3MubGVuZ3RoIC0gMV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImlucHV0LWltZ1wiKVswXSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgY3JlYXRlSW5wdXRJbWcoaW5wSW1nKTtcbiAgICAgICAgaWYgKGFkLmltZ19maWxlX25hbWUpIHNldEN1cnJlbnRJbnB1dEltZ1ZhbHVlKGlucEltZywgaW1hZ2VzVXJsUm9vdCArIGFkLmltZ19maWxlX25hbWUpO1xuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJvd3MubGVuZ3RoOyBpKyspIGFkZEV2ZW50TGlzdGVuZXJzVG9Sb3cocm93c1tpXSk7XG59KTtcblxuZnVuY3Rpb24gZ2V0Um93RWxlbXMocm93OiBIVE1MRWxlbWVudCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIGlkOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fY2VsbC5faWQgLnRhYmxlX19jZWxsLXZhbHVlXCIpIGFzIEhUTUxFbGVtZW50LFxuICAgICAgICBuYW1lVmFsdWU6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19jZWxsLl9uYW1lIC50YWJsZV9fY2VsbC12YWx1ZVwiKSBhcyBIVE1MRWxlbWVudCxcbiAgICAgICAgbmFtZUNoYW5nZUVsZW06IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19jZWxsLl9uYW1lIC50YWJsZV9fY2VsbC1jaGFuZ2UtZWxlbVwiKSBhcyBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICB5ZWFyVmFsdWU6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19jZWxsLl95ZWFyIC50YWJsZV9fY2VsbC12YWx1ZVwiKSBhcyBIVE1MRWxlbWVudCxcbiAgICAgICAgeWVhckNoYW5nZUVsZW06IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19jZWxsLl95ZWFyIC50YWJsZV9fY2VsbC1jaGFuZ2UtZWxlbVwiKSBhcyBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICBkZXNjcmlwdGlvbkNoYW5nZUVsZW06IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19jZWxsLl9kZXNjcmlwdGlvbiAudGFibGVfX2NlbGwtY2hhbmdlLWVsZW1cIikgYXMgSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgYnRuQ2hhbmdlOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fYnRuLl9jaGFuZ2VcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgIGJ0bkRlbGV0ZTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2J0bi5fZGVsZXRlXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICBidG5TYXZlOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fYnRuLl9zYXZlXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICBidG5DYW5jZWw6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19idG4uX2NhbmNlbFwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgYnRuT3JkZXJQbHVzOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fYnRuLl9vcmRlci1wbHVzXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICBidG5PcmRlck1pbnVzOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fYnRuLl9vcmRlci1taW51c1wiKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgYnRuQmxvY2s6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19idG4uX2Jsb2NrXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICBpbnB1dEltZzogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2NlbGwuX2ltZyAudGFibGVfX2NlbGwtY2hhbmdlLWVsZW1cIikgYXMgSFRNTEVsZW1lbnRcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldEJ1dHRvbnNSb3coYnV0dG9uOiBIVE1MQnV0dG9uRWxlbWVudCkge1xuICAgIHJldHVybiAoYnV0dG9uLnBhcmVudEVsZW1lbnQgYXMgSFRNTEVsZW1lbnQpLnBhcmVudEVsZW1lbnQgYXMgSFRNTEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXJzVG9Sb3cocm93OiBIVE1MRWxlbWVudCkge1xuICAgIGNvbnN0IHJvd0VsZW1zID0gZ2V0Um93RWxlbXMocm93KTtcbiAgICByb3dFbGVtcy5idG5DaGFuZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uQ2hhbmdlQnRuQ2xpY2spO1xuICAgIHJvd0VsZW1zLmJ0bkNhbmNlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25DYW5jZWxCdG5DbGljayk7XG4gICAgcm93RWxlbXMuYnRuRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbkRlbGV0ZUJ0bkNsaWNrKTtcbiAgICByb3dFbGVtcy5idG5TYXZlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvblNhdmVCdG5DbGljayk7XG4gICAgcm93RWxlbXMuYnRuQmxvY2suYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uQmxvY2tCdG5DbGljayk7XG4gICAgcm93RWxlbXMuYnRuT3JkZXJQbHVzLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbk9yZGVyUGx1c0J0bkNsaWNrKTtcbiAgICByb3dFbGVtcy5idG5PcmRlck1pbnVzLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbk9yZGVyTWludXNCdG5DbGljayk7XG59XG5cbmZ1bmN0aW9uIG9uT3JkZXJQbHVzQnRuQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICBjb25zdCByb3cgPSBnZXRCdXR0b25zUm93KGV2ZW50LmN1cnJlbnRUYXJnZXQgYXMgSFRNTEJ1dHRvbkVsZW1lbnQpO1xuICAgIGlmIChyb3cubmV4dEVsZW1lbnRTaWJsaW5nKSB7XG4gICAgICAgIHJvdy5wYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZShyb3csIHJvdy5uZXh0RWxlbWVudFNpYmxpbmcubmV4dEVsZW1lbnRTaWJsaW5nKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG9uT3JkZXJNaW51c0J0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICBpZiAocm93LnByZXZpb3VzRWxlbWVudFNpYmxpbmcpIHtcbiAgICAgICAgcm93LnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKHJvdywgcm93LnByZXZpb3VzRWxlbWVudFNpYmxpbmcpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlUm93KGFkOiBBZHZlcnRpc2luZykge1xuICAgIHJldHVybiBgPGRpdiBjbGFzcz1cInRhYmxlX19yb3dcIiBkYXRhLWlzLWJsb2NrPVwiJHthZC5pc19ibG9jayA/IFwidHJ1ZVwiIDogXCJmYWxzZVwifVwiIGRhdGEtb3JkZXI9XCIke2FkLm9yZGVyfVwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NvbnRlbnQtY2VsbHMtY29udGFpbmVyXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwgX2lkXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jZWxsLXZhbHVlXCI+JHthZC5pZCB8fCBcIlwifTwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwgX25hbWVcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwtdmFsdWVcIj4ke2FkLm5hbWV9PC9kaXY+XG4gICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVwidGFibGVfX2NlbGwtY2hhbmdlLWVsZW1cIiBtYXhsZW5ndGg9XCIyMDBcIiBuYW1lPVwibmFtZVwiIHZhbHVlPVwiJHthZC5uYW1lfVwiPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwgX3llYXJcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwtdmFsdWVcIj4ke2FkLnllYXJ9PC9kaXY+XG4gICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVwidGFibGVfX2NlbGwtY2hhbmdlLWVsZW1cIiB0eXBlPVwibnVtYmVyXCIgbWluPVwiMFwiIG1heD1cIjk5OTlcIiB2YWx1ZT1cIiR7YWQueWVhcn1cIj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jZWxsIF9kZXNjcmlwdGlvblwiPlxuICAgICAgICAgICAgICAgIDxkaXY+0J7Qv9C40YHQsNC90LjQtTwvZGl2PlxuICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBjbGFzcz1cInRhYmxlX19jZWxsLWNoYW5nZS1lbGVtXCIgbWF4bGVuZ3RoPVwiMjAwMFwiPiR7YWQuZGVzY3JpcHRpb259PC90ZXh0YXJlYT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jZWxsIF9pbWdcIj5cbiAgICAgICAgICAgICAgICA8ZGl2PtCY0LfQvtCx0YDQsNC20LXQvdC40LU8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaW5wdXQtaW1nIHRhYmxlX19jZWxsLWNoYW5nZS1lbGVtXCI+PC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbCBfYnRuc1wiPlxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cInBpIHBpLXBlbmNpbCB0YWJsZV9fYnRuIF9jaGFuZ2VcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS10cmFzaCB0YWJsZV9fYnRuIF9kZWxldGVcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS1zYXZlIHRhYmxlX19idG4gX3NhdmVcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS10aW1lcyB0YWJsZV9fYnRuIF9jYW5jZWxcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS1hcnJvdy11cCB0YWJsZV9fYnRuIF9vcmRlci1taW51c1wiPjwvYnV0dG9uPlxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cInBpIHBpLWFycm93LWRvd24gdGFibGVfX2J0biBfb3JkZXItcGx1c1wiPjwvYnV0dG9uPlxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cInBpIHBpLSR7YWQuaXNfYmxvY2sgPyBcInVubG9ja1wiIDogXCJsb2NrXCJ9IHRhYmxlX19idG4gX2Jsb2NrXCI+PC9idXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgIDwvZGl2PmBcbn1cblxuZnVuY3Rpb24gb25BZGRCdG5DbGljaygpIHtcbiAgICBjb25zdCBuZXdBZDogQWR2ZXJ0aXNpbmcgPSB7XG4gICAgICAgIGlkOiBudWxsLFxuICAgICAgICBuYW1lOiBcIlwiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJcIixcbiAgICAgICAgaW1nX2ZpbGVfbmFtZTogXCJcIixcbiAgICAgICAgaXNfYmxvY2s6IGZhbHNlLFxuICAgICAgICBvcmRlcjogYWR2ZXJ0aXNpbmdzLmxlbmd0aCArIDEsXG4gICAgICAgIHllYXI6IChuZXcgRGF0ZSkuZ2V0RnVsbFllYXIoKVxuICAgIH1cbiAgICByb3dzQ29udGFpbmVyLmluc2VydEFkamFjZW50SFRNTChcImJlZm9yZWVuZFwiLCBjcmVhdGVSb3cobmV3QWQpKTtcbiAgICBjb25zdCBuZXdSb3cgPSByb3dzQ29udGFpbmVyLmxhc3RFbGVtZW50Q2hpbGQgYXMgSFRNTEVsZW1lbnQ7XG4gICAgYWRkRXZlbnRMaXN0ZW5lcnNUb1JvdyhuZXdSb3cpO1xuICAgIGNyZWF0ZUlucHV0SW1nKG5ld1Jvdy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiaW5wdXQtaW1nXCIpWzBdIGFzIEhUTUxFbGVtZW50KTtcbiAgICBnZXRSb3dFbGVtcyhuZXdSb3cpLmJ0bkNoYW5nZS5jbGljaygpO1xuICAgIHNldFRpbWVvdXQoKCkgPT4gcm93c0NvbnRhaW5lci5zY3JvbGxUb3AgPSByb3dzQ29udGFpbmVyLnNjcm9sbEhlaWdodCk7XG59XG5cbmZ1bmN0aW9uIG9uQ2hhbmdlQnRuQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICBjb25zdCByb3cgPSBnZXRCdXR0b25zUm93KGV2ZW50LmN1cnJlbnRUYXJnZXQgYXMgSFRNTEJ1dHRvbkVsZW1lbnQpO1xuICAgIHJvdy5jbGFzc0xpc3QuYWRkKFwiX2NoYW5nZWRcIik7XG59XG5cbmZ1bmN0aW9uIG9uQ2FuY2VsQnRuQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICBjb25zdCByb3cgPSBnZXRCdXR0b25zUm93KGV2ZW50LmN1cnJlbnRUYXJnZXQgYXMgSFRNTEJ1dHRvbkVsZW1lbnQpO1xuICAgIGNvbnN0IHJvd0VsZW1zID0gZ2V0Um93RWxlbXMocm93KTtcbiAgICBpZiAocm93RWxlbXMuaWQuaW5uZXJUZXh0KSB7XG4gICAgICAgIHJvdy5jbGFzc0xpc3QucmVtb3ZlKFwiX2NoYW5nZWRcIik7XG4gICAgICAgIGNvbnN0IGFkID0gYWR2ZXJ0aXNpbmdzLmZpbmQoKGl0ZW0pID0+IGl0ZW0uaWQgKyBcIlwiID09PSByb3dFbGVtcy5pZC5pbm5lclRleHQpO1xuICAgICAgICByb3dFbGVtcy5uYW1lQ2hhbmdlRWxlbS52YWx1ZSA9IGFkLm5hbWU7XG4gICAgICAgIHJvd0VsZW1zLmRlc2NyaXB0aW9uQ2hhbmdlRWxlbS52YWx1ZSA9IGFkLmRlc2NyaXB0aW9uO1xuICAgICAgICByb3dFbGVtcy55ZWFyQ2hhbmdlRWxlbS52YWx1ZSA9IGFkLnllYXIgKyBcIlwiO1xuXG4gICAgICAgIHJvdy5kYXRhc2V0LmlzQmxvY2sgPSBhZC5pc19ibG9jayA/IFwidHJ1ZVwiIDogXCJmYWxzZVwiO1xuICAgICAgICBpZiAoYWQuaXNfYmxvY2spIHtcbiAgICAgICAgICAgIHJvd0VsZW1zLmJ0bkJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoXCJwaS1sb2NrXCIpO1xuICAgICAgICAgICAgcm93RWxlbXMuYnRuQmxvY2suY2xhc3NMaXN0LmFkZChcInBpLXVubG9ja1wiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJvd0VsZW1zLmJ0bkJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoXCJwaS11bmxvY2tcIik7XG4gICAgICAgICAgICByb3dFbGVtcy5idG5CbG9jay5jbGFzc0xpc3QuYWRkKFwicGktbG9ja1wiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjdXJyZW50T3JkZXIgPSBudWxsO1xuICAgICAgICBsZXQgb2xkT3JkZXIgPSBhZC5vcmRlcjtcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gcm93cy5sZW5ndGg7IGkrKykgaWYgKHJvd3NbaV0gPT09IHJvdykge1xuICAgICAgICAgICAgY3VycmVudE9yZGVyID0gaTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJyZW50T3JkZXIgPiBvbGRPcmRlcikge1xuICAgICAgICAgICAgcm93LnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKHJvdywgcm93c1tvbGRPcmRlciAtIDFdKTtcbiAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50T3JkZXIgPCBvbGRPcmRlcikge1xuICAgICAgICAgICAgcm93LnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKHJvdywgcm93c1tvbGRPcmRlciAtIDFdLm5leHRFbGVtZW50U2libGluZyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSByb3cucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChyb3cpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBvbkRlbGV0ZUJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgaWYgKCFjb25maXJtKFwi0KXQvtGA0L7RiNC+INC/0L7QtNGD0LzQsNC70Lg/XCIpKSByZXR1cm47XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICBjb25zdCByb3dFbGVtcyA9IGdldFJvd0VsZW1zKHJvdyk7XG4gICAgYXdhaXQgZmV0Y2goXCIvYXBpL2FkdmVydGlzaW5nL2RlbGV0ZS5waHA/aWQ9XCIgKyByb3dFbGVtcy5pZC5pbm5lclRleHQsIHsgbWV0aG9kOiBcImRlbGV0ZVwiIH0pO1xuICAgIGFkdmVydGlzaW5ncyA9IGFkdmVydGlzaW5ncy5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0uaWQgIT09ICtyb3dFbGVtcy5pZC5pbm5lclRleHQpO1xuICAgIGNvbnN0IHJvd09yZGVyID0gK3Jvdy5kYXRhc2V0Lm9yZGVyO1xuICAgIHJvdy5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHJvdyk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb3dzLmxlbmd0aDsgaSsrKSBpZiAoK3Jvd3NbaV0uZGF0YXNldC5vcmRlciA+IHJvd09yZGVyKSB7XG4gICAgICAgIHJvd3NbaV0uZGF0YXNldC5vcmRlciA9ICtyb3dzW2ldLmRhdGFzZXQub3JkZXIgLSAxICsgXCJcIjtcbiAgICB9XG4gICAgZm9yIChsZXQgaXRlbSBvZiBhZHZlcnRpc2luZ3MpIGlmIChpdGVtLm9yZGVyID4gcm93T3JkZXIpIGl0ZW0ub3JkZXItLTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gb25TYXZlQnRuQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICBjb25zdCByb3cgPSBnZXRCdXR0b25zUm93KGV2ZW50LmN1cnJlbnRUYXJnZXQgYXMgSFRNTEJ1dHRvbkVsZW1lbnQpO1xuICAgIGNvbnN0IHJvd0VsZW1zID0gZ2V0Um93RWxlbXMocm93KTtcbiAgICBsZXQgbmV3T3JkZXI6IG51bWJlcjtcbiAgICBsZXQgb2xkT3JkZXI6IG51bWJlcjtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJvd3MubGVuZ3RoOyBpKyspIGlmIChyb3dzW2ldID09PSByb3cpIHtcbiAgICAgICAgbmV3T3JkZXIgPSBpICsgMTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGZvciAobGV0IGl0ZW0gb2YgYWR2ZXJ0aXNpbmdzKSBpZiAoaXRlbS5pZCA9PT0gK3Jvd0VsZW1zLmlkLmlubmVyVGV4dCkge1xuICAgICAgICBvbGRPcmRlciA9IGl0ZW0ub3JkZXI7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBpZiAoIW9sZE9yZGVyKSB7XG4gICAgICAgIG9sZE9yZGVyID0gYWR2ZXJ0aXNpbmdzLmxlbmd0aCArIDE7XG4gICAgfVxuICAgIGxldCBjaGFuZ2VkQWRJZCA9IG51bGw7XG4gICAgaWYgKHJvd0VsZW1zLmlkLmlubmVyVGV4dCkge1xuICAgICAgICBjaGFuZ2VkQWRJZCA9ICtyb3dFbGVtcy5pZC5pbm5lclRleHQ7XG4gICAgICAgIGNvbnN0IGNoYW5nZWRBZDogQWR2ZXJ0aXNpbmcgPSB7XG4gICAgICAgICAgICBpZDogK3Jvd0VsZW1zLmlkLmlubmVyVGV4dCxcbiAgICAgICAgICAgIG5hbWU6IHJvd0VsZW1zLm5hbWVDaGFuZ2VFbGVtLnZhbHVlLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHJvd0VsZW1zLmRlc2NyaXB0aW9uQ2hhbmdlRWxlbS52YWx1ZSxcbiAgICAgICAgICAgIHllYXI6ICtyb3dFbGVtcy55ZWFyQ2hhbmdlRWxlbS52YWx1ZSxcbiAgICAgICAgICAgIGltZ19maWxlX25hbWU6IFwiXCIsXG4gICAgICAgICAgICBpc19ibG9jazogcm93LmRhdGFzZXQuaXNCbG9jayA9PT0gXCJ0cnVlXCIgPyB0cnVlIDogZmFsc2UsXG4gICAgICAgICAgICBvcmRlcjogbmV3T3JkZXIsXG4gICAgICAgICAgICBuZXdJbWc6IGdldE5ld0lucHV0SW1nVmFsdWUocm93RWxlbXMuaW5wdXRJbWcpXG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgZmV0Y2goYC9hcGkvYWR2ZXJ0aXNpbmcvY2hhbmdlLnBocGAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJwdXRcIixcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGNoYW5nZWRBZClcbiAgICAgICAgfSk7XG4gICAgICAgIGFkdmVydGlzaW5ncyA9IGFkdmVydGlzaW5ncy5tYXAoKGl0ZW0pID0+IGl0ZW0uaWQgPT09IGNoYW5nZWRBZC5pZCA/IGNoYW5nZWRBZCA6IGl0ZW0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IG5ld0FkOiBBZHZlcnRpc2luZyA9IHtcbiAgICAgICAgICAgIGlkOiBudWxsLFxuICAgICAgICAgICAgbmFtZTogcm93RWxlbXMubmFtZUNoYW5nZUVsZW0udmFsdWUsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogcm93RWxlbXMuZGVzY3JpcHRpb25DaGFuZ2VFbGVtLnZhbHVlLFxuICAgICAgICAgICAgeWVhcjogK3Jvd0VsZW1zLnllYXJDaGFuZ2VFbGVtLnZhbHVlLFxuICAgICAgICAgICAgaW1nX2ZpbGVfbmFtZTogXCJcIixcbiAgICAgICAgICAgIGlzX2Jsb2NrOiByb3cuZGF0YXNldC5pc0Jsb2NrID09PSBcInRydWVcIiA/IHRydWUgOiBmYWxzZSxcbiAgICAgICAgICAgIG9yZGVyOiBuZXdPcmRlcixcbiAgICAgICAgICAgIG5ld0ltZzogZ2V0TmV3SW5wdXRJbWdWYWx1ZShyb3dFbGVtcy5pbnB1dEltZylcbiAgICAgICAgfVxuICAgICAgICBuZXdBZC5pZCA9IGF3YWl0IChhd2FpdCBmZXRjaChgL2FwaS9hZHZlcnRpc2luZy9hZGQucGhwYCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcInBvc3RcIixcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KG5ld0FkKVxuICAgICAgICB9KSkuanNvbigpO1xuICAgICAgICBjaGFuZ2VkQWRJZCA9IG5ld0FkLmlkO1xuICAgICAgICByb3dFbGVtcy5pZC5pbm5lclRleHQgPSBcIlwiICsgbmV3QWQuaWQ7XG4gICAgICAgIGFkdmVydGlzaW5ncy5wdXNoKG5ld0FkKTtcbiAgICB9XG4gICAgcm93RWxlbXMubmFtZVZhbHVlLmlubmVyVGV4dCA9IHJvd0VsZW1zLm5hbWVDaGFuZ2VFbGVtLnZhbHVlO1xuICAgIHJvd0VsZW1zLnllYXJWYWx1ZS5pbm5lclRleHQgPSByb3dFbGVtcy55ZWFyQ2hhbmdlRWxlbS52YWx1ZTtcbiAgICBpZiAobmV3T3JkZXIgPiBvbGRPcmRlcikge1xuICAgICAgICBmb3IgKGxldCBpdGVtIG9mIGFkdmVydGlzaW5ncykgaWYgKGl0ZW0ub3JkZXIgPiBvbGRPcmRlciAmJiBpdGVtLm9yZGVyIDw9IG5ld09yZGVyICYmIGl0ZW0uaWQgIT09IGNoYW5nZWRBZElkKSB7XG4gICAgICAgICAgICBpdGVtLm9yZGVyLS07XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKG5ld09yZGVyIDwgb2xkT3JkZXIpIHtcbiAgICAgICAgZm9yIChsZXQgaXRlbSBvZiBhZHZlcnRpc2luZ3MpIGlmIChpdGVtLm9yZGVyIDwgb2xkT3JkZXIgJiYgaXRlbS5vcmRlciA+PSBuZXdPcmRlciAmJiBpdGVtLmlkICE9PSBjaGFuZ2VkQWRJZCkge1xuICAgICAgICAgICAgaXRlbS5vcmRlcisrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJvdy5jbGFzc0xpc3QucmVtb3ZlKFwiX2NoYW5nZWRcIik7XG59XG5cbmZ1bmN0aW9uIG9uQmxvY2tCdG5DbGljayhldmVudDogTW91c2VFdmVudCkge1xuICAgIGNvbnN0IGJ0biA9IGV2ZW50LmN1cnJlbnRUYXJnZXQgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhidG4pO1xuICAgIHJvdy5kYXRhc2V0LmlzQmxvY2sgPSByb3cuZGF0YXNldC5pc0Jsb2NrID09PSBcInRydWVcIiA/IFwiZmFsc2VcIiA6IFwidHJ1ZVwiO1xuICAgIGlmIChyb3cuZGF0YXNldC5pc0Jsb2NrID09PSBcInRydWVcIikge1xuICAgICAgICBidG4uY2xhc3NMaXN0LnJlbW92ZShcInBpLWxvY2tcIik7XG4gICAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKFwicGktdW5sb2NrXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwicGktdW5sb2NrXCIpO1xuICAgICAgICBidG4uY2xhc3NMaXN0LmFkZChcInBpLWxvY2tcIik7XG4gICAgfVxufVxuXG5jbGFzcyBBZHZlcnRpc2luZyB7XG4gICAgaWQ6IG51bWJlcjtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgeWVhcjogbnVtYmVyO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgaW1nX2ZpbGVfbmFtZTogc3RyaW5nO1xuICAgIGlzX2Jsb2NrOiBib29sZWFuO1xuICAgIG9yZGVyOiBudW1iZXI7XG4gICAgbmV3SW1nPzogc3RyaW5nO1xufSIsIm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3B1YmxpY19wYXRoX18gKyBcImFkbWluL2hvbWUuY3NzXCI7Il0sInNvdXJjZVJvb3QiOiIifQ==