!function(e){var t={};function n(r){if(t[r])return t[r].exports;var l=t[r]={i:r,l:!1,exports:{}};return e[r].call(l.exports,l,l.exports,n),l.l=!0,l.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)n.d(r,l,function(t){return e[t]}.bind(null,l));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}({6:function(e,t,n){"use strict";n.r(t);n(7),n(8)},7:function(e,t,n){e.exports=n.p+"admin/home.css"},8:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(l,a){function i(e){try{o(r.next(e))}catch(e){a(e)}}function c(e){try{o(r.throw(e))}catch(e){a(e)}}function o(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}o((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,l,a,i={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(l=2&a[0]?r.return:a[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,a[1])).done)return l;switch(r=0,l&&(a=[2&a[0],l.value]),a[0]){case 0:case 1:l=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(l=(l=i.trys).length>0&&l[l.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!l||a[1]>l[0]&&a[1]<l[3])){i.label=a[1];break}if(6===a[0]&&i.label<l[1]){i.label=l[1],l=a;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(a);break}l[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=l=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},l=document.getElementsByClassName("advertising-crud-component")[0],a=l.querySelector(".table__btn._add"),i=l.getElementsByClassName("table__body")[0],c=i.getElementsByClassName("table__row"),o=[];function s(e){return{id:e.querySelector(".table__cell._id .table__cell-value"),nameValue:e.querySelector(".table__cell._name .table__cell-value"),nameChangeElem:e.querySelector(".table__cell._name .table__cell-change-elem"),yearValue:e.querySelector(".table__cell._year .table__cell-value"),yearChangeElem:e.querySelector(".table__cell._year .table__cell-change-elem"),descriptionChangeElem:e.querySelector(".table__cell._description .table__cell-change-elem"),btnChange:e.querySelector(".table__btn._change"),btnDelete:e.querySelector(".table__btn._delete"),btnSave:e.querySelector(".table__btn._save"),btnCancel:e.querySelector(".table__btn._cancel"),btnOrderPlus:e.querySelector(".table__btn._order-plus"),btnOrderMinus:e.querySelector(".table__btn._order-minus"),btnBlock:e.querySelector(".table__btn._block")}}function u(e){return e.parentElement.parentElement}function d(e){var t=s(e);t.btnChange.addEventListener("click",v),t.btnCancel.addEventListener("click",p),t.btnDelete.addEventListener("click",m),t.btnSave.addEventListener("click",h),t.btnBlock.addEventListener("click",g),t.btnOrderPlus.addEventListener("click",b),t.btnOrderMinus.addEventListener("click",_)}function b(e){var t=u(e.currentTarget);t.nextElementSibling&&t.parentElement.insertBefore(t,t.nextElementSibling.nextElementSibling)}function _(e){var t=u(e.currentTarget);t.previousElementSibling&&t.parentElement.insertBefore(t,t.previousElementSibling)}function f(e){return'<div class="table__row" data-is-block="'+(e.is_block?"true":"false")+'" data-order="'+e.order+'">\n        <div class="table__content-cells-container">\n            <div class="table__cell _id">\n                <div class="table__cell-value">'+(e.id||"")+'</div>\n            </div>\n            <div class="table__cell _name">\n                <div class="table__cell-value">'+e.name+'</div>\n                <input class="table__cell-change-elem" maxlength="200" name="name" value="'+e.name+'">\n            </div>\n            <div class="table__cell _year">\n                <div class="table__cell-value">'+e.year+'</div>\n                <input class="table__cell-change-elem" type="number" min="0" max="9999" value="'+e.year+'">\n            </div>\n            <div class="table__cell _description">\n                <div>Описание</div>\n                <textarea class="table__cell-change-elem" maxlength="2000">'+e.description+'</textarea>\n            </div>\n            <div class="table__cell _img">\n                <div>Изображение</div>\n            </div>\n        </div>\n        <div class="table__cell _btns">\n            <button class="pi pi-pencil table__btn _change"></button>\n            <button class="pi pi-trash table__btn _delete"></button>\n            <button class="pi pi-save table__btn _save"></button>\n            <button class="pi pi-times table__btn _cancel"></button>\n            <button class="pi pi-arrow-up table__btn _order-minus"></button>\n            <button class="pi pi-arrow-down table__btn _order-plus"></button>\n            <button class="pi pi-'+(e.is_block?"unlock":"lock")+' table__btn _block"></button>\n        </div>\n    </div>'}function v(e){u(e.currentTarget).classList.add("_changed")}function p(e){var t=u(e.currentTarget),n=s(t);if(n.id.innerText){t.classList.remove("_changed");var r=o.find((function(e){return e.id+""===n.id.innerText}));n.nameChangeElem.value=r.name,n.descriptionChangeElem.value=r.description,n.yearChangeElem.value=r.year+"",t.dataset.isBlock=r.is_block?"true":"false",r.is_block?(n.btnBlock.classList.remove("pi-lock"),n.btnBlock.classList.add("pi-unlock")):(n.btnBlock.classList.remove("pi-unlock"),n.btnBlock.classList.add("pi-lock"));for(var l=null,a=r.order,i=1;i<=c.length;i++)if(c[i]===t){l=i;break}l>a?t.parentElement.insertBefore(t,c[a-1]):l<a&&t.parentElement.insertBefore(t,c[a-1].nextElementSibling)}else t.parentElement.removeChild(t)}function m(e){return n(this,void 0,void 0,(function(){var t,n,l,a,i,d,b;return r(this,(function(r){switch(r.label){case 0:return confirm("Хорошо подумали?")?(t=u(e.currentTarget),n=s(t),[4,fetch("/api/advertising/delete.php?id="+n.id.innerText,{method:"delete"})]):[2];case 1:for(r.sent(),o=o.filter((function(e){return e.id!==+n.id.innerText})),l=+t.dataset.order,t.parentElement.removeChild(t),a=0;a<c.length;a++)+c[a].dataset.order>l&&(c[a].dataset.order=+c[a].dataset.order-1+"");for(i=0,d=o;i<d.length;i++)(b=d[i]).order>l&&b.order--;return[2]}}))}))}function h(e){return n(this,void 0,void 0,(function(){var t,n,l,a,i,d,b,_,f,v,p,m,h,g,y,k;return r(this,(function(r){switch(r.label){case 0:for(t=u(e.currentTarget),n=s(t),i=0;i<c.length;i++)if(c[i]===t){l=i+1;break}for(d=0,b=o;d<b.length;d++)if((k=b[d]).id===+n.id.innerText){a=k.order;break}return a||(a=o.length+1),_=null,n.id.innerText?(_=+n.id.innerText,f={id:+n.id.innerText,name:n.nameChangeElem.value,description:n.descriptionChangeElem.value,year:+n.yearChangeElem.value,img_file_name:"",is_block:"true"===t.dataset.isBlock,order:l},[4,fetch("/api/advertising/change.php",{method:"put",body:JSON.stringify(f)})]):[3,2];case 1:return r.sent(),o=o.map((function(e){return e.id===f.id?f:e})),[3,5];case 2:return v={id:null,name:n.nameChangeElem.value,description:n.descriptionChangeElem.value,year:+n.yearChangeElem.value,img_file_name:"",is_block:"true"===t.dataset.isBlock,order:l},p=v,[4,fetch("/api/advertising/add.php",{method:"post",body:JSON.stringify(v)})];case 3:return[4,r.sent().json()];case 4:p.id=r.sent(),_=v.id,n.id.innerText=""+v.id,o.push(v),r.label=5;case 5:if(n.nameValue.innerText=n.nameChangeElem.value,n.yearValue.innerText=n.yearChangeElem.value,l>a)for(m=0,h=o;m<h.length;m++)(k=h[m]).order>a&&k.order<=l&&k.id!==_&&k.order--;else if(l<a)for(g=0,y=o;g<y.length;g++)(k=y[g]).order<a&&k.order>=l&&k.id!==_&&k.order++;return t.classList.remove("_changed"),[2]}}))}))}function g(e){var t=e.currentTarget,n=u(t);n.dataset.isBlock="true"===n.dataset.isBlock?"false":"true","true"===n.dataset.isBlock?(t.classList.remove("pi-lock"),t.classList.add("pi-unlock")):(t.classList.remove("pi-unlock"),t.classList.add("pi-lock"))}a.addEventListener("click",(function(){var e={id:null,name:"",description:"",img_file_name:"",is_block:!1,order:o.length+1,year:(new Date).getFullYear()};i.insertAdjacentHTML("beforeend",f(e)),i.scrollTop=i.scrollHeight;var t=i.lastElementChild;d(t),s(t).btnChange.click()})),fetch("/api/advertising/getAll.php").then((function(e){return e.json()})).then((function(e){for(var t=0,n=o=e;t<n.length;t++){var r=n[t];i.insertAdjacentHTML("beforeend",f(r))}for(var l=0;l<c.length;l++)d(c[l])}))}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vcGFnZXMvYWRtaW4vaG9tZS9ob21lLnRzIiwid2VicGFjazovLy8uL3BhZ2VzL2FkbWluL2hvbWUvaG9tZS5zY3NzIiwid2VicGFjazovLy8uL2NvbXBvbmVudHMvYWRtaW4vYWR2ZXJ0aXNpbmdDcnVkL2FkdmVydGlzaW5nQ3J1ZC50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImNvbXAiLCJkb2N1bWVudCIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJhZGRCdG4iLCJxdWVyeVNlbGVjdG9yIiwicm93c0NvbnRhaW5lciIsInJvd3MiLCJhZHZlcnRpc2luZ3MiLCJnZXRSb3dFbGVtcyIsInJvdyIsImlkIiwibmFtZVZhbHVlIiwibmFtZUNoYW5nZUVsZW0iLCJ5ZWFyVmFsdWUiLCJ5ZWFyQ2hhbmdlRWxlbSIsImRlc2NyaXB0aW9uQ2hhbmdlRWxlbSIsImJ0bkNoYW5nZSIsImJ0bkRlbGV0ZSIsImJ0blNhdmUiLCJidG5DYW5jZWwiLCJidG5PcmRlclBsdXMiLCJidG5PcmRlck1pbnVzIiwiYnRuQmxvY2siLCJnZXRCdXR0b25zUm93IiwiYnV0dG9uIiwicGFyZW50RWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXJzVG9Sb3ciLCJyb3dFbGVtcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJvbkNoYW5nZUJ0bkNsaWNrIiwib25DYW5jZWxCdG5DbGljayIsIm9uRGVsZXRlQnRuQ2xpY2siLCJvblNhdmVCdG5DbGljayIsIm9uQmxvY2tCdG5DbGljayIsIm9uT3JkZXJQbHVzQnRuQ2xpY2siLCJvbk9yZGVyTWludXNCdG5DbGljayIsImV2ZW50IiwiY3VycmVudFRhcmdldCIsIm5leHRFbGVtZW50U2libGluZyIsImluc2VydEJlZm9yZSIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJjcmVhdGVSb3ciLCJhZCIsImlzX2Jsb2NrIiwib3JkZXIiLCJ5ZWFyIiwiZGVzY3JpcHRpb24iLCJjbGFzc0xpc3QiLCJhZGQiLCJpbm5lclRleHQiLCJyZW1vdmUiLCJmaW5kIiwiaXRlbSIsImRhdGFzZXQiLCJpc0Jsb2NrIiwiY3VycmVudE9yZGVyIiwib2xkT3JkZXIiLCJsZW5ndGgiLCJyZW1vdmVDaGlsZCIsImNvbmZpcm0iLCJmZXRjaCIsIm1ldGhvZCIsImZpbHRlciIsInJvd09yZGVyIiwibmV3T3JkZXIiLCJjaGFuZ2VkQWRJZCIsImltZ19maWxlX25hbWUiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIm1hcCIsIm5ld0FkIiwianNvbiIsInB1c2giLCJidG4iLCJEYXRlIiwiZ2V0RnVsbFllYXIiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJzY3JvbGxUb3AiLCJzY3JvbGxIZWlnaHQiLCJuZXdSb3ciLCJsYXN0RWxlbWVudENoaWxkIiwiY2xpY2siLCJ0aGVuIiwicmVzcCIsImRhdGEiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxR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QU0yQyxFQUFxQixDQUN2QjdELEdBQUksS0FDSm5DLEtBQU0sR0FDTnVFLFlBQWEsR0FDYm9CLGNBQWUsR0FDZnZCLFVBQVUsRUFDVkMsTUFBT3JDLEVBQWFrRCxPQUFTLEVBQzdCWixNQUFNLElBQUs4QixNQUFNQyxlQUVyQnZFLEVBQWN3RSxtQkFBbUIsWUFBYXBDLEVBQVU4QixJQUN4RGxFLEVBQWN5RSxVQUFZekUsRUFBYzBFLGFBQ3hDLElBQU1DLEVBQVMzRSxFQUFjNEUsaUJBQzdCdkQsRUFBdUJzRCxHQUN2QnhFLEVBQVl3RSxHQUFRaEUsVUFBVWtFLFdBckdsQ3RCLE1BQU0sK0JBQStCdUIsTUFBSyxTQUFDQyxHQUFTLE9BQUFBLEVBQUtaLFVBQVFXLE1BQUssU0FBQ0UsR0FFbkUsSUFBZSxVQURmOUUsRUFBZThFLEVBQ0EsZUFBYyxDQUF4QixJQUFJM0MsRUFBRSxLQUFrQnJDLEVBQWN3RSxtQkFBbUIsWUFBYXBDLEVBQVVDLElBQ3JGLElBQUssSUFBSTFFLEVBQUksRUFBR0EsRUFBSXNDLEVBQUttRCxPQUFRekYsSUFBSzBELEVBQXVCcEIsRUFBS3RDIiwiZmlsZSI6ImFkbWluL2hvbWUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gNik7XG4iLCJpbXBvcnQgXCIuL2hvbWUuc2Nzc1wiO1xuaW1wb3J0IFwiLi4vLi4vLi4vY29tcG9uZW50cy9hZG1pbi9hZHZlcnRpc2luZ0NydWQvYWR2ZXJ0aXNpbmdDcnVkLnRzXCI7IiwibW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcHVibGljX3BhdGhfXyArIFwiYWRtaW4vaG9tZS5jc3NcIjsiLCJleHBvcnQgeyB9O1xuXG5jb25zdCBjb21wID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImFkdmVydGlzaW5nLWNydWQtY29tcG9uZW50XCIpWzBdIGFzIEhUTUxFbGVtZW50O1xuY29uc3QgYWRkQnRuID0gY29tcC5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19idG4uX2FkZFwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbmNvbnN0IHJvd3NDb250YWluZXIgPSBjb21wLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ0YWJsZV9fYm9keVwiKVswXSBhcyBIVE1MRWxlbWVudDtcbmNvbnN0IHJvd3MgPSByb3dzQ29udGFpbmVyLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ0YWJsZV9fcm93XCIpIGFzIEhUTUxDb2xsZWN0aW9uT2Y8SFRNTEVsZW1lbnQ+O1xubGV0IGFkdmVydGlzaW5nczogQWR2ZXJ0aXNpbmdbXSA9IFtdO1xuXG5hZGRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uQWRkQnRuQ2xpY2spO1xuXG5mZXRjaChgL2FwaS9hZHZlcnRpc2luZy9nZXRBbGwucGhwYCkudGhlbigocmVzcCkgPT4gcmVzcC5qc29uKCkpLnRoZW4oKGRhdGEpID0+IHtcbiAgICBhZHZlcnRpc2luZ3MgPSBkYXRhO1xuICAgIGZvciAobGV0IGFkIG9mIGFkdmVydGlzaW5ncykgcm93c0NvbnRhaW5lci5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIiwgY3JlYXRlUm93KGFkKSk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb3dzLmxlbmd0aDsgaSsrKSBhZGRFdmVudExpc3RlbmVyc1RvUm93KHJvd3NbaV0pO1xufSk7XG5cbmZ1bmN0aW9uIGdldFJvd0VsZW1zKHJvdzogSFRNTEVsZW1lbnQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBpZDogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2NlbGwuX2lkIC50YWJsZV9fY2VsbC12YWx1ZVwiKSBhcyBIVE1MRWxlbWVudCxcbiAgICAgICAgbmFtZVZhbHVlOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fY2VsbC5fbmFtZSAudGFibGVfX2NlbGwtdmFsdWVcIikgYXMgSFRNTEVsZW1lbnQsXG4gICAgICAgIG5hbWVDaGFuZ2VFbGVtOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fY2VsbC5fbmFtZSAudGFibGVfX2NlbGwtY2hhbmdlLWVsZW1cIikgYXMgSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgeWVhclZhbHVlOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fY2VsbC5feWVhciAudGFibGVfX2NlbGwtdmFsdWVcIikgYXMgSFRNTEVsZW1lbnQsXG4gICAgICAgIHllYXJDaGFuZ2VFbGVtOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fY2VsbC5feWVhciAudGFibGVfX2NlbGwtY2hhbmdlLWVsZW1cIikgYXMgSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgZGVzY3JpcHRpb25DaGFuZ2VFbGVtOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fY2VsbC5fZGVzY3JpcHRpb24gLnRhYmxlX19jZWxsLWNoYW5nZS1lbGVtXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgIGJ0bkNoYW5nZTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2J0bi5fY2hhbmdlXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICBidG5EZWxldGU6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19idG4uX2RlbGV0ZVwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgYnRuU2F2ZTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2J0bi5fc2F2ZVwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgYnRuQ2FuY2VsOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fYnRuLl9jYW5jZWxcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgIGJ0bk9yZGVyUGx1czogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2J0bi5fb3JkZXItcGx1c1wiKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgYnRuT3JkZXJNaW51czogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2J0bi5fb3JkZXItbWludXNcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgIGJ0bkJsb2NrOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fYnRuLl9ibG9ja1wiKSBhcyBIVE1MQnV0dG9uRWxlbWVudFxuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2V0QnV0dG9uc1JvdyhidXR0b246IEhUTUxCdXR0b25FbGVtZW50KSB7XG4gICAgcmV0dXJuIChidXR0b24ucGFyZW50RWxlbWVudCBhcyBIVE1MRWxlbWVudCkucGFyZW50RWxlbWVudCBhcyBIVE1MRWxlbWVudDtcbn1cblxuZnVuY3Rpb24gYWRkRXZlbnRMaXN0ZW5lcnNUb1Jvdyhyb3c6IEhUTUxFbGVtZW50KSB7XG4gICAgY29uc3Qgcm93RWxlbXMgPSBnZXRSb3dFbGVtcyhyb3cpO1xuICAgIHJvd0VsZW1zLmJ0bkNoYW5nZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25DaGFuZ2VCdG5DbGljayk7XG4gICAgcm93RWxlbXMuYnRuQ2FuY2VsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbkNhbmNlbEJ0bkNsaWNrKTtcbiAgICByb3dFbGVtcy5idG5EZWxldGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uRGVsZXRlQnRuQ2xpY2spO1xuICAgIHJvd0VsZW1zLmJ0blNhdmUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uU2F2ZUJ0bkNsaWNrKTtcbiAgICByb3dFbGVtcy5idG5CbG9jay5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25CbG9ja0J0bkNsaWNrKTtcbiAgICByb3dFbGVtcy5idG5PcmRlclBsdXMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uT3JkZXJQbHVzQnRuQ2xpY2spO1xuICAgIHJvd0VsZW1zLmJ0bk9yZGVyTWludXMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uT3JkZXJNaW51c0J0bkNsaWNrKTtcbn1cblxuZnVuY3Rpb24gb25PcmRlclBsdXNCdG5DbGljayhldmVudDogTW91c2VFdmVudCkge1xuICAgIGNvbnN0IHJvdyA9IGdldEJ1dHRvbnNSb3coZXZlbnQuY3VycmVudFRhcmdldCBhcyBIVE1MQnV0dG9uRWxlbWVudCk7XG4gICAgaWYgKHJvdy5uZXh0RWxlbWVudFNpYmxpbmcpIHtcbiAgICAgICAgcm93LnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKHJvdywgcm93Lm5leHRFbGVtZW50U2libGluZy5uZXh0RWxlbWVudFNpYmxpbmcpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gb25PcmRlck1pbnVzQnRuQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICBjb25zdCByb3cgPSBnZXRCdXR0b25zUm93KGV2ZW50LmN1cnJlbnRUYXJnZXQgYXMgSFRNTEJ1dHRvbkVsZW1lbnQpO1xuICAgIGlmIChyb3cucHJldmlvdXNFbGVtZW50U2libGluZykge1xuICAgICAgICByb3cucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUocm93LCByb3cucHJldmlvdXNFbGVtZW50U2libGluZyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVSb3coYWQ6IEFkdmVydGlzaW5nKSB7XG4gICAgcmV0dXJuIGA8ZGl2IGNsYXNzPVwidGFibGVfX3Jvd1wiIGRhdGEtaXMtYmxvY2s9XCIke2FkLmlzX2Jsb2NrID8gXCJ0cnVlXCIgOiBcImZhbHNlXCJ9XCIgZGF0YS1vcmRlcj1cIiR7YWQub3JkZXJ9XCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY29udGVudC1jZWxscy1jb250YWluZXJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbCBfaWRcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwtdmFsdWVcIj4ke2FkLmlkIHx8IFwiXCJ9PC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbCBfbmFtZVwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbC12YWx1ZVwiPiR7YWQubmFtZX08L2Rpdj5cbiAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJ0YWJsZV9fY2VsbC1jaGFuZ2UtZWxlbVwiIG1heGxlbmd0aD1cIjIwMFwiIG5hbWU9XCJuYW1lXCIgdmFsdWU9XCIke2FkLm5hbWV9XCI+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbCBfeWVhclwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbC12YWx1ZVwiPiR7YWQueWVhcn08L2Rpdj5cbiAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJ0YWJsZV9fY2VsbC1jaGFuZ2UtZWxlbVwiIHR5cGU9XCJudW1iZXJcIiBtaW49XCIwXCIgbWF4PVwiOTk5OVwiIHZhbHVlPVwiJHthZC55ZWFyfVwiPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwgX2Rlc2NyaXB0aW9uXCI+XG4gICAgICAgICAgICAgICAgPGRpdj7QntC/0LjRgdCw0L3QuNC1PC9kaXY+XG4gICAgICAgICAgICAgICAgPHRleHRhcmVhIGNsYXNzPVwidGFibGVfX2NlbGwtY2hhbmdlLWVsZW1cIiBtYXhsZW5ndGg9XCIyMDAwXCI+JHthZC5kZXNjcmlwdGlvbn08L3RleHRhcmVhPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwgX2ltZ1wiPlxuICAgICAgICAgICAgICAgIDxkaXY+0JjQt9C+0LHRgNCw0LbQtdC90LjQtTwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwgX2J0bnNcIj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS1wZW5jaWwgdGFibGVfX2J0biBfY2hhbmdlXCI+PC9idXR0b24+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwicGkgcGktdHJhc2ggdGFibGVfX2J0biBfZGVsZXRlXCI+PC9idXR0b24+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwicGkgcGktc2F2ZSB0YWJsZV9fYnRuIF9zYXZlXCI+PC9idXR0b24+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwicGkgcGktdGltZXMgdGFibGVfX2J0biBfY2FuY2VsXCI+PC9idXR0b24+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwicGkgcGktYXJyb3ctdXAgdGFibGVfX2J0biBfb3JkZXItbWludXNcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS1hcnJvdy1kb3duIHRhYmxlX19idG4gX29yZGVyLXBsdXNcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS0ke2FkLmlzX2Jsb2NrID8gXCJ1bmxvY2tcIiA6IFwibG9ja1wifSB0YWJsZV9fYnRuIF9ibG9ja1wiPjwvYnV0dG9uPlxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5gXG59XG5cbmZ1bmN0aW9uIG9uQWRkQnRuQ2xpY2soKSB7XG4gICAgY29uc3QgbmV3QWQ6IEFkdmVydGlzaW5nID0ge1xuICAgICAgICBpZDogbnVsbCxcbiAgICAgICAgbmFtZTogXCJcIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwiXCIsXG4gICAgICAgIGltZ19maWxlX25hbWU6IFwiXCIsXG4gICAgICAgIGlzX2Jsb2NrOiBmYWxzZSxcbiAgICAgICAgb3JkZXI6IGFkdmVydGlzaW5ncy5sZW5ndGggKyAxLFxuICAgICAgICB5ZWFyOiAobmV3IERhdGUpLmdldEZ1bGxZZWFyKClcbiAgICB9XG4gICAgcm93c0NvbnRhaW5lci5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIiwgY3JlYXRlUm93KG5ld0FkKSk7XG4gICAgcm93c0NvbnRhaW5lci5zY3JvbGxUb3AgPSByb3dzQ29udGFpbmVyLnNjcm9sbEhlaWdodDtcbiAgICBjb25zdCBuZXdSb3cgPSByb3dzQ29udGFpbmVyLmxhc3RFbGVtZW50Q2hpbGQgYXMgSFRNTEVsZW1lbnQ7XG4gICAgYWRkRXZlbnRMaXN0ZW5lcnNUb1JvdyhuZXdSb3cpO1xuICAgIGdldFJvd0VsZW1zKG5ld1JvdykuYnRuQ2hhbmdlLmNsaWNrKCk7XG59XG5cbmZ1bmN0aW9uIG9uQ2hhbmdlQnRuQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICBjb25zdCByb3cgPSBnZXRCdXR0b25zUm93KGV2ZW50LmN1cnJlbnRUYXJnZXQgYXMgSFRNTEJ1dHRvbkVsZW1lbnQpO1xuICAgIHJvdy5jbGFzc0xpc3QuYWRkKFwiX2NoYW5nZWRcIik7XG59XG5cbmZ1bmN0aW9uIG9uQ2FuY2VsQnRuQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICBjb25zdCByb3cgPSBnZXRCdXR0b25zUm93KGV2ZW50LmN1cnJlbnRUYXJnZXQgYXMgSFRNTEJ1dHRvbkVsZW1lbnQpO1xuICAgIGNvbnN0IHJvd0VsZW1zID0gZ2V0Um93RWxlbXMocm93KTtcbiAgICBpZiAocm93RWxlbXMuaWQuaW5uZXJUZXh0KSB7XG4gICAgICAgIHJvdy5jbGFzc0xpc3QucmVtb3ZlKFwiX2NoYW5nZWRcIik7XG4gICAgICAgIGNvbnN0IGFkID0gYWR2ZXJ0aXNpbmdzLmZpbmQoKGl0ZW0pID0+IGl0ZW0uaWQgKyBcIlwiID09PSByb3dFbGVtcy5pZC5pbm5lclRleHQpO1xuICAgICAgICByb3dFbGVtcy5uYW1lQ2hhbmdlRWxlbS52YWx1ZSA9IGFkLm5hbWU7XG4gICAgICAgIHJvd0VsZW1zLmRlc2NyaXB0aW9uQ2hhbmdlRWxlbS52YWx1ZSA9IGFkLmRlc2NyaXB0aW9uO1xuICAgICAgICByb3dFbGVtcy55ZWFyQ2hhbmdlRWxlbS52YWx1ZSA9IGFkLnllYXIgKyBcIlwiO1xuXG4gICAgICAgIHJvdy5kYXRhc2V0LmlzQmxvY2sgPSBhZC5pc19ibG9jayA/IFwidHJ1ZVwiIDogXCJmYWxzZVwiO1xuICAgICAgICBpZiAoYWQuaXNfYmxvY2spIHtcbiAgICAgICAgICAgIHJvd0VsZW1zLmJ0bkJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoXCJwaS1sb2NrXCIpO1xuICAgICAgICAgICAgcm93RWxlbXMuYnRuQmxvY2suY2xhc3NMaXN0LmFkZChcInBpLXVubG9ja1wiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJvd0VsZW1zLmJ0bkJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoXCJwaS11bmxvY2tcIik7XG4gICAgICAgICAgICByb3dFbGVtcy5idG5CbG9jay5jbGFzc0xpc3QuYWRkKFwicGktbG9ja1wiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjdXJyZW50T3JkZXIgPSBudWxsO1xuICAgICAgICBsZXQgb2xkT3JkZXIgPSBhZC5vcmRlcjtcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gcm93cy5sZW5ndGg7IGkrKykgaWYgKHJvd3NbaV0gPT09IHJvdykge1xuICAgICAgICAgICAgY3VycmVudE9yZGVyID0gaTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJyZW50T3JkZXIgPiBvbGRPcmRlcikge1xuICAgICAgICAgICAgcm93LnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKHJvdywgcm93c1tvbGRPcmRlciAtIDFdKTtcbiAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50T3JkZXIgPCBvbGRPcmRlcikge1xuICAgICAgICAgICAgcm93LnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKHJvdywgcm93c1tvbGRPcmRlciAtIDFdLm5leHRFbGVtZW50U2libGluZyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSByb3cucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChyb3cpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBvbkRlbGV0ZUJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgaWYgKCFjb25maXJtKFwi0KXQvtGA0L7RiNC+INC/0L7QtNGD0LzQsNC70Lg/XCIpKSByZXR1cm47XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICBjb25zdCByb3dFbGVtcyA9IGdldFJvd0VsZW1zKHJvdyk7XG4gICAgYXdhaXQgZmV0Y2goXCIvYXBpL2FkdmVydGlzaW5nL2RlbGV0ZS5waHA/aWQ9XCIgKyByb3dFbGVtcy5pZC5pbm5lclRleHQsIHsgbWV0aG9kOiBcImRlbGV0ZVwiIH0pO1xuICAgIGFkdmVydGlzaW5ncyA9IGFkdmVydGlzaW5ncy5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0uaWQgIT09ICtyb3dFbGVtcy5pZC5pbm5lclRleHQpO1xuICAgIGNvbnN0IHJvd09yZGVyID0gK3Jvdy5kYXRhc2V0Lm9yZGVyO1xuICAgIHJvdy5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHJvdyk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb3dzLmxlbmd0aDsgaSsrKSBpZiAoK3Jvd3NbaV0uZGF0YXNldC5vcmRlciA+IHJvd09yZGVyKSB7XG4gICAgICAgIHJvd3NbaV0uZGF0YXNldC5vcmRlciA9ICtyb3dzW2ldLmRhdGFzZXQub3JkZXIgLSAxICsgXCJcIjtcbiAgICB9XG4gICAgZm9yIChsZXQgaXRlbSBvZiBhZHZlcnRpc2luZ3MpIGlmIChpdGVtLm9yZGVyID4gcm93T3JkZXIpIGl0ZW0ub3JkZXItLTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gb25TYXZlQnRuQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICBjb25zdCByb3cgPSBnZXRCdXR0b25zUm93KGV2ZW50LmN1cnJlbnRUYXJnZXQgYXMgSFRNTEJ1dHRvbkVsZW1lbnQpO1xuICAgIGNvbnN0IHJvd0VsZW1zID0gZ2V0Um93RWxlbXMocm93KTtcbiAgICBsZXQgbmV3T3JkZXI6IG51bWJlcjtcbiAgICBsZXQgb2xkT3JkZXI6IG51bWJlcjtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJvd3MubGVuZ3RoOyBpKyspIGlmIChyb3dzW2ldID09PSByb3cpIHtcbiAgICAgICAgbmV3T3JkZXIgPSBpICsgMTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGZvciAobGV0IGl0ZW0gb2YgYWR2ZXJ0aXNpbmdzKSBpZiAoaXRlbS5pZCA9PT0gK3Jvd0VsZW1zLmlkLmlubmVyVGV4dCkge1xuICAgICAgICBvbGRPcmRlciA9IGl0ZW0ub3JkZXI7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBpZiAoIW9sZE9yZGVyKSB7XG4gICAgICAgIG9sZE9yZGVyID0gYWR2ZXJ0aXNpbmdzLmxlbmd0aCArIDE7XG4gICAgfVxuICAgIGxldCBjaGFuZ2VkQWRJZCA9IG51bGw7XG4gICAgaWYgKHJvd0VsZW1zLmlkLmlubmVyVGV4dCkge1xuICAgICAgICBjaGFuZ2VkQWRJZCA9ICtyb3dFbGVtcy5pZC5pbm5lclRleHQ7XG4gICAgICAgIGNvbnN0IGNoYW5nZWRBZDogQWR2ZXJ0aXNpbmcgPSB7XG4gICAgICAgICAgICBpZDogK3Jvd0VsZW1zLmlkLmlubmVyVGV4dCxcbiAgICAgICAgICAgIG5hbWU6IHJvd0VsZW1zLm5hbWVDaGFuZ2VFbGVtLnZhbHVlLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHJvd0VsZW1zLmRlc2NyaXB0aW9uQ2hhbmdlRWxlbS52YWx1ZSxcbiAgICAgICAgICAgIHllYXI6ICtyb3dFbGVtcy55ZWFyQ2hhbmdlRWxlbS52YWx1ZSxcbiAgICAgICAgICAgIGltZ19maWxlX25hbWU6IFwiXCIsXG4gICAgICAgICAgICBpc19ibG9jazogcm93LmRhdGFzZXQuaXNCbG9jayA9PT0gXCJ0cnVlXCIgPyB0cnVlIDogZmFsc2UsXG4gICAgICAgICAgICBvcmRlcjogbmV3T3JkZXJcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCBmZXRjaChgL2FwaS9hZHZlcnRpc2luZy9jaGFuZ2UucGhwYCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcInB1dFwiLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoY2hhbmdlZEFkKVxuICAgICAgICB9KTtcbiAgICAgICAgYWR2ZXJ0aXNpbmdzID0gYWR2ZXJ0aXNpbmdzLm1hcCgoaXRlbSkgPT4gaXRlbS5pZCA9PT0gY2hhbmdlZEFkLmlkID8gY2hhbmdlZEFkIDogaXRlbSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgbmV3QWQ6IEFkdmVydGlzaW5nID0ge1xuICAgICAgICAgICAgaWQ6IG51bGwsXG4gICAgICAgICAgICBuYW1lOiByb3dFbGVtcy5uYW1lQ2hhbmdlRWxlbS52YWx1ZSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiByb3dFbGVtcy5kZXNjcmlwdGlvbkNoYW5nZUVsZW0udmFsdWUsXG4gICAgICAgICAgICB5ZWFyOiArcm93RWxlbXMueWVhckNoYW5nZUVsZW0udmFsdWUsXG4gICAgICAgICAgICBpbWdfZmlsZV9uYW1lOiBcIlwiLFxuICAgICAgICAgICAgaXNfYmxvY2s6IHJvdy5kYXRhc2V0LmlzQmxvY2sgPT09IFwidHJ1ZVwiID8gdHJ1ZSA6IGZhbHNlLFxuICAgICAgICAgICAgb3JkZXI6IG5ld09yZGVyXG4gICAgICAgIH1cbiAgICAgICAgbmV3QWQuaWQgPSBhd2FpdCAoYXdhaXQgZmV0Y2goYC9hcGkvYWR2ZXJ0aXNpbmcvYWRkLnBocGAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShuZXdBZClcbiAgICAgICAgfSkpLmpzb24oKTtcbiAgICAgICAgY2hhbmdlZEFkSWQgPSBuZXdBZC5pZDtcbiAgICAgICAgcm93RWxlbXMuaWQuaW5uZXJUZXh0ID0gXCJcIiArIG5ld0FkLmlkO1xuICAgICAgICBhZHZlcnRpc2luZ3MucHVzaChuZXdBZCk7XG4gICAgfVxuICAgIHJvd0VsZW1zLm5hbWVWYWx1ZS5pbm5lclRleHQgPSByb3dFbGVtcy5uYW1lQ2hhbmdlRWxlbS52YWx1ZTtcbiAgICByb3dFbGVtcy55ZWFyVmFsdWUuaW5uZXJUZXh0ID0gcm93RWxlbXMueWVhckNoYW5nZUVsZW0udmFsdWU7XG4gICAgaWYgKG5ld09yZGVyID4gb2xkT3JkZXIpIHtcbiAgICAgICAgZm9yIChsZXQgaXRlbSBvZiBhZHZlcnRpc2luZ3MpIGlmIChpdGVtLm9yZGVyID4gb2xkT3JkZXIgJiYgaXRlbS5vcmRlciA8PSBuZXdPcmRlciAmJiBpdGVtLmlkICE9PSBjaGFuZ2VkQWRJZCkge1xuICAgICAgICAgICAgaXRlbS5vcmRlci0tO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChuZXdPcmRlciA8IG9sZE9yZGVyKSB7XG4gICAgICAgIGZvciAobGV0IGl0ZW0gb2YgYWR2ZXJ0aXNpbmdzKSBpZiAoaXRlbS5vcmRlciA8IG9sZE9yZGVyICYmIGl0ZW0ub3JkZXIgPj0gbmV3T3JkZXIgJiYgaXRlbS5pZCAhPT0gY2hhbmdlZEFkSWQpIHtcbiAgICAgICAgICAgIGl0ZW0ub3JkZXIrKztcbiAgICAgICAgfVxuICAgIH1cbiAgICByb3cuY2xhc3NMaXN0LnJlbW92ZShcIl9jaGFuZ2VkXCIpO1xufVxuXG5mdW5jdGlvbiBvbkJsb2NrQnRuQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICBjb25zdCBidG4gPSBldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50O1xuICAgIGNvbnN0IHJvdyA9IGdldEJ1dHRvbnNSb3coYnRuKTtcbiAgICByb3cuZGF0YXNldC5pc0Jsb2NrID0gcm93LmRhdGFzZXQuaXNCbG9jayA9PT0gXCJ0cnVlXCIgPyBcImZhbHNlXCIgOiBcInRydWVcIjtcbiAgICBpZiAocm93LmRhdGFzZXQuaXNCbG9jayA9PT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgYnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJwaS1sb2NrXCIpO1xuICAgICAgICBidG4uY2xhc3NMaXN0LmFkZChcInBpLXVubG9ja1wiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBidG4uY2xhc3NMaXN0LnJlbW92ZShcInBpLXVubG9ja1wiKTtcbiAgICAgICAgYnRuLmNsYXNzTGlzdC5hZGQoXCJwaS1sb2NrXCIpO1xuICAgIH1cbn1cblxuY2xhc3MgQWR2ZXJ0aXNpbmcge1xuICAgIGlkOiBudW1iZXI7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHllYXI6IG51bWJlcjtcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIGltZ19maWxlX25hbWU6IHN0cmluZztcbiAgICBpc19ibG9jazogYm9vbGVhbjtcbiAgICBvcmRlcjogbnVtYmVyXG59Il0sInNvdXJjZVJvb3QiOiIifQ==