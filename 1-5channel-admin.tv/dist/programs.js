!function(e){var n={};function t(l){if(n[l])return n[l].exports;var r=n[l]={i:l,l:!1,exports:{}};return e[l].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,l){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:l})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(t.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(l,r,function(n){return e[n]}.bind(null,r));return l},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=4)}([function(e,n,t){"use strict";t.d(n,"a",(function(){return l})),t.d(n,"d",(function(){return r})),t.d(n,"c",(function(){return a})),t.d(n,"e",(function(){return i})),t.d(n,"b",(function(){return u}));var l="http://1-5channel.tv",r="/files/images/";function a(e){return e.firstElementChild.innerHTML}function i(e,n){return e.firstElementChild.innerHTML=n}function u(e){new Quill(e,{theme:"snow",modules:{toolbar:[[{size:["small",!1,"large","huge"]}],["bold","italic","underline","strike"],[{script:"sub"},{script:"super"},{color:[]},"clean"]]}})}},,function(e,n,t){e.exports=t.p+"programs.css"},,function(e,n,t){"use strict";t.r(n);t(2);var l=t(0),r=function(e,n,t,l){return new(t||(t=Promise))((function(r,a){function i(e){try{c(l.next(e))}catch(e){a(e)}}function u(e){try{c(l.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,u)}c((l=l.apply(e,n||[])).next())}))},a=function(e,n){var t,l,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,l&&(r=2&a[0]?l.return:a[0]?l.throw||((r=l.return)&&r.call(l),0):l.next)&&!(r=r.call(l,a[1])).done)return r;switch(l=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,l=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=n.call(e,i)}catch(e){a=[6,e],l=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},i=document.getElementsByClassName("programs-crud-component")[0],u=i.querySelector(".table__btn._add"),c=i.querySelector(".find-btn"),o=i.querySelector(".find-input"),s=i.getElementsByClassName("table__body")[0],d=s.getElementsByClassName("table__row"),_=[];function b(e){return{id:e.querySelector(".table__cell._id .table__cell-value"),nameValue:e.querySelector(".table__cell._name .table__cell-value"),nameChangeElem:e.querySelector(".table__cell._name .table__cell-change-elem"),durationValue:e.querySelector(".table__cell._duration .table__cell-value"),durationChangeElemHours:e.querySelector(".table__cell._duration .table__cell-change-elem._hours"),durationChangeElemMins:e.querySelector(".table__cell._duration .table__cell-change-elem._mins"),linkChangeElem:e.querySelector(".table__cell._link .table__cell-change-elem"),btnChange:e.querySelector(".table__btn._change"),btnDelete:e.querySelector(".table__btn._delete"),btnSave:e.querySelector(".table__btn._save"),btnCancel:e.querySelector(".table__btn._cancel")}}function f(e){return e.parentElement.parentElement}function m(e){var n=b(e);n.btnChange.addEventListener("click",p),n.btnCancel.addEventListener("click",g),n.btnDelete.addEventListener("click",y),n.btnSave.addEventListener("click",E)}function v(e){var n=Math.floor(e/36e5),t=Math.floor((e-36e5*n)/6e4);return{hours:n,mins:t,str:(n>0?n+"ч. ":"")+(t>0||0===n?t+"мин.":"")}}function h(e){var n=v(e.duration);return'<div class="table__row">\n        <div class="table__content-cells-container">\n            <div class="table__cell _id">\n                <div class="table__cell-value">'+(e.id||"")+'</div>\n            </div>\n            <div class="table__cell _name">\n                <div class="table__cell-value">'+e.name+'</div>\n                <input class="table__cell-change-elem" maxlength="200" name="name" value="'+e.name+'">\n            </div>\n            <div class="table__cell _duration">\n                <div class="table__cell-value">'+n.str+'</div>\n                <div class="table__cell-change-elem-container">\n                    <input class="table__cell-change-elem _hours" type="number" min="0" max="24" value="'+n.hours+'">ч.\n                    <input class="table__cell-change-elem _mins" type="number" min="0" max="59" value="'+n.mins+'">мин.\n                </div>\n            </div>\n            <div class="table__cell _link">\n                <span class="label">Ссылка с Youtube</span>\n                <input class="table__cell-change-elem" name="name" value="'+e.link+'">\n            </div>\n        </div>\n        <div class="table__cell _btns">\n            <button class="pi pi-pencil table__btn _change"></button>\n            <button class="pi pi-trash table__btn _delete"></button>\n            <button class="pi pi-save table__btn _save"></button>\n            <button class="pi pi-times table__btn _cancel"></button>\n        </div>\n    </div>'}function p(e){f(e.currentTarget).classList.add("_changed")}function g(e){var n=f(e.currentTarget),t=b(n);if(t.id.innerText){n.classList.remove("_changed");var l=_.find((function(e){return e.id+""===t.id.innerText})),r=v(l.duration);t.nameChangeElem.value=l.name,t.durationChangeElemHours.value=r.hours+"",t.durationChangeElemMins.value=r.mins+""}else n.parentElement.removeChild(n)}function y(e){return r(this,void 0,void 0,(function(){var n,t;return a(this,(function(r){switch(r.label){case 0:return confirm("Хорошо подумали?")?(n=f(e.currentTarget),t=b(n),[4,fetch(l.a+"/api/program/delete.php?id="+t.id.innerText,{method:"delete"})]):[2];case 1:return r.sent(),_=_.filter((function(e){return e.id+""!==t.id.innerText})),n.parentElement.removeChild(n),[2]}}))}))}function E(e){return r(this,void 0,void 0,(function(){var n,t,r,i,u,c,o;return a(this,(function(a){switch(a.label){case 0:return n=f(e.currentTarget),t=b(n),r=36e5*+t.durationChangeElemHours.value+6e4*+t.durationChangeElemMins.value,t.id.innerText?(i={id:+t.id.innerText,name:t.nameChangeElem.value,duration:r,link:t.linkChangeElem.value},[4,fetch(l.a+"/api/program/change.php",{method:"put",body:JSON.stringify(i)})]):[3,2];case 1:return a.sent(),_=_.map((function(e){return e.id===i.id?i:e})),[3,5];case 2:return u={id:null,name:t.nameChangeElem.value,duration:r,link:t.linkChangeElem.value},c=u,[4,fetch(l.a+"/api/program/add.php",{method:"post",body:JSON.stringify(u)})];case 3:return[4,a.sent().json()];case 4:c.id=a.sent(),t.id.innerText=""+u.id,_.push(u),a.label=5;case 5:return o=v(r),t.nameValue.innerText=t.nameChangeElem.value,t.durationValue.innerText=o.str,n.classList.remove("_changed"),[2]}}))}))}u.addEventListener("click",(function(){s.insertAdjacentHTML("beforeend",h({id:null,name:"",duration:36e5,link:""}));var e=s.lastElementChild;m(e),b(e).btnChange.click(),setTimeout((function(){return s.scrollTop=s.scrollHeight}))})),fetch(l.a+"/api/program/getAll.php").then((function(e){return e.json()})).then((function(e){for(var n=0,t=_=e;n<t.length;n++){var i=t[n];s.insertAdjacentHTML("beforeend",h(i))}for(var u=0;u<d.length;u++)m(d[u]);c.addEventListener("click",(function(){return r(void 0,void 0,void 0,(function(){var e,n,t,r;return a(this,(function(a){switch(a.label){case 0:return[4,fetch(l.a+"/api/program/find.php?find_str="+encodeURIComponent(o.value))];case 1:return[4,a.sent().json()];case 2:for(_=a.sent(),s.innerHTML="",e=0,n=_;e<n.length;e++)t=n[e],s.insertAdjacentHTML("beforeend",h(t));for(r=0;r<d.length;r++)m(d[r]);return[2]}}))}))}))}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc2VydmljZXMvY29tbW9uLnRzIiwid2VicGFjazovLy8uL3BhZ2VzL3Byb2dyYW1zL3Byb2dyYW1zLnNjc3MiLCJ3ZWJwYWNrOi8vLy4vY29tcG9uZW50cy9wcm9ncmFtc0NydWQvcHJvZ3JhbXNDcnVkLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiYmFja2VuZEFkZHJlc3MiLCJpbWFnZXNVcmxSb290IiwiZ2V0UXVpbGxFZGl0b3JWYWx1ZSIsInF1aWxsRWRpdG9yRWxlbSIsImZpcnN0RWxlbWVudENoaWxkIiwiaW5uZXJIVE1MIiwic2V0UXVpbGxFZGl0b3JWYWx1ZSIsImNyZWF0ZVN0YW5kYXJ0UXVpbGxFZGl0b3IiLCJlbGVtIiwiUXVpbGwiLCJ0aGVtZSIsInRvb2xiYXIiLCJjb21wIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwiYWRkQnRuIiwicXVlcnlTZWxlY3RvciIsImZpbmRCdG4iLCJmaW5kSW5wdXQiLCJyb3dzQ29udGFpbmVyIiwicm93cyIsImdldFJvd0VsZW1zIiwicm93IiwiaWQiLCJuYW1lVmFsdWUiLCJuYW1lQ2hhbmdlRWxlbSIsImR1cmF0aW9uVmFsdWUiLCJkdXJhdGlvbkNoYW5nZUVsZW1Ib3VycyIsImR1cmF0aW9uQ2hhbmdlRWxlbU1pbnMiLCJsaW5rQ2hhbmdlRWxlbSIsImJ0bkNoYW5nZSIsImJ0bkRlbGV0ZSIsImJ0blNhdmUiLCJidG5DYW5jZWwiLCJnZXRCdXR0b25zUm93IiwiYnV0dG9uIiwicGFyZW50RWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXJzVG9Sb3ciLCJyb3dFbGVtcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJvbkNoYW5nZUJ0bkNsaWNrIiwib25DYW5jZWxCdG5DbGljayIsIm9uRGVsZXRlQnRuQ2xpY2siLCJvblNhdmVCdG5DbGljayIsImNvbnZlcnREdXJhdGlvbiIsImR1cmF0aW9uIiwiaG91cnMiLCJNYXRoIiwiZmxvb3IiLCJtaW5zIiwic3RyIiwiY3JlYXRlUm93IiwicHJvZ3JhbSIsImxpbmsiLCJldmVudCIsImN1cnJlbnRUYXJnZXQiLCJjbGFzc0xpc3QiLCJhZGQiLCJpbm5lclRleHQiLCJyZW1vdmUiLCJmaW5kIiwiaXRlbSIsInJlbW92ZUNoaWxkIiwiY29uZmlybSIsImZldGNoIiwibWV0aG9kIiwiZmlsdGVyIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJtYXAiLCJuZXdQcm9ncmFtIiwianNvbiIsInB1c2giLCJkdXJhdGlvbk9iaiIsImluc2VydEFkamFjZW50SFRNTCIsIm5ld1JvdyIsImxhc3RFbGVtZW50Q2hpbGQiLCJjbGljayIsInNldFRpbWVvdXQiLCJzY3JvbGxUb3AiLCJzY3JvbGxIZWlnaHQiLCJ0aGVuIiwicmVzcCIsImRhdGEiLCJsZW5ndGgiLCJlbmNvZGVVUklDb21wb25lbnQiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFL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QixTQUFTLHFELDhEQUNaLFNBQU15QixNQUFNLElBQWlCLGtDQUFvQ3NCLG1CQUFtQnBFLEVBQVVqQyxTLE9BQXJHLFNBQU8sU0FBdUd1RixRLE9BRXpILElBRkEsRUFBVyxTQUNYckQsRUFBY2QsVUFBWSxHQUNyQixFQUFMLEVBQW9CLG1CQUFYK0MsRUFBTyxLQUFjakMsRUFBY3dELG1CQUFtQixZQUFheEIsRUFBVUMsSUFDdEYsSUFBU3BGLEVBQUksRUFBR0EsRUFBSW9ELEVBQUtpRSxPQUFRckgsSUFBS3FFLEVBQXVCakIsRUFBS3BELEkiLCJmaWxlIjoicHJvZ3JhbXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gNCk7XG4iLCJkZWNsYXJlIGxldCBRdWlsbDtcblxuZXhwb3J0IGNvbnN0IGJhY2tlbmRBZGRyZXNzID0gXCJodHRwOi8vMS01Y2hhbm5lbC50dlwiO1xuZXhwb3J0IGNvbnN0IGltYWdlc1VybFJvb3QgPSBcIi9maWxlcy9pbWFnZXMvXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRRdWlsbEVkaXRvclZhbHVlKHF1aWxsRWRpdG9yRWxlbTogSFRNTEVsZW1lbnQpIHtcbiAgICByZXR1cm4gcXVpbGxFZGl0b3JFbGVtLmZpcnN0RWxlbWVudENoaWxkLmlubmVySFRNTDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldFF1aWxsRWRpdG9yVmFsdWUocXVpbGxFZGl0b3JFbGVtOiBIVE1MRWxlbWVudCwgdmFsdWU6IHN0cmluZykge1xuICAgIHJldHVybiBxdWlsbEVkaXRvckVsZW0uZmlyc3RFbGVtZW50Q2hpbGQuaW5uZXJIVE1MID0gdmFsdWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTdGFuZGFydFF1aWxsRWRpdG9yKGVsZW06IEhUTUxFbGVtZW50KSB7XG4gICAgbmV3IFF1aWxsKGVsZW0sIHtcbiAgICAgICAgdGhlbWU6ICdzbm93JyxcbiAgICAgICAgbW9kdWxlczoge1xuICAgICAgICAgICAgdG9vbGJhcjogW1xuICAgICAgICAgICAgICAgIFt7ICdzaXplJzogWydzbWFsbCcsIGZhbHNlLCAnbGFyZ2UnLCAnaHVnZSddIH1dLFxuICAgICAgICAgICAgICAgIFsnYm9sZCcsICdpdGFsaWMnLCAndW5kZXJsaW5lJywgJ3N0cmlrZSddLFxuICAgICAgICAgICAgICAgIFt7ICdzY3JpcHQnOiAnc3ViJyB9LCB7ICdzY3JpcHQnOiAnc3VwZXInIH0sIHsgJ2NvbG9yJzogW10gfSwgJ2NsZWFuJ10sXG4gICAgICAgICAgICBdLFxuXG4gICAgICAgIH1cbiAgICB9KTtcbn0iLCJtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19wdWJsaWNfcGF0aF9fICsgXCJwcm9ncmFtcy5jc3NcIjsiLCJleHBvcnQgeyB9O1xuXG5pbXBvcnQgeyBiYWNrZW5kQWRkcmVzcyB9IGZyb20gXCIuLi8uLi9zZXJ2aWNlcy9jb21tb25cIlxuXG5jb25zdCBjb21wID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInByb2dyYW1zLWNydWQtY29tcG9uZW50XCIpWzBdIGFzIEhUTUxFbGVtZW50O1xuY29uc3QgYWRkQnRuID0gY29tcC5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19idG4uX2FkZFwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbmNvbnN0IGZpbmRCdG4gPSBjb21wLnF1ZXJ5U2VsZWN0b3IoXCIuZmluZC1idG5cIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5jb25zdCBmaW5kSW5wdXQgPSBjb21wLnF1ZXJ5U2VsZWN0b3IoXCIuZmluZC1pbnB1dFwiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuY29uc3Qgcm93c0NvbnRhaW5lciA9IGNvbXAuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInRhYmxlX19ib2R5XCIpWzBdIGFzIEhUTUxFbGVtZW50O1xuY29uc3Qgcm93cyA9IHJvd3NDb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInRhYmxlX19yb3dcIikgYXMgSFRNTENvbGxlY3Rpb25PZjxIVE1MRWxlbWVudD47XG5sZXQgcHJvZ3JhbXM6IFByb2dyYW1bXSA9IFtdO1xuXG5hZGRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uQWRkQnRuQ2xpY2spO1xuXG5cbmZldGNoKGJhY2tlbmRBZGRyZXNzICsgYC9hcGkvcHJvZ3JhbS9nZXRBbGwucGhwYCkudGhlbigocmVzcCkgPT4gcmVzcC5qc29uKCkpLnRoZW4oKGRhdGEpID0+IHtcbiAgICBwcm9ncmFtcyA9IGRhdGE7XG4gICAgZm9yIChsZXQgcHJvZ3JhbSBvZiBwcm9ncmFtcykgcm93c0NvbnRhaW5lci5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIiwgY3JlYXRlUm93KHByb2dyYW0pKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJvd3MubGVuZ3RoOyBpKyspIGFkZEV2ZW50TGlzdGVuZXJzVG9Sb3cocm93c1tpXSk7XG5cbiAgICBmaW5kQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIHByb2dyYW1zID0gYXdhaXQgKGF3YWl0IGZldGNoKGJhY2tlbmRBZGRyZXNzICsgYC9hcGkvcHJvZ3JhbS9maW5kLnBocD9maW5kX3N0cj1gICsgZW5jb2RlVVJJQ29tcG9uZW50KGZpbmRJbnB1dC52YWx1ZSkpKS5qc29uKCk7XG4gICAgICAgIHJvd3NDb250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcbiAgICAgICAgZm9yIChsZXQgcHJvZ3JhbSBvZiBwcm9ncmFtcykgcm93c0NvbnRhaW5lci5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIiwgY3JlYXRlUm93KHByb2dyYW0pKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb3dzLmxlbmd0aDsgaSsrKSBhZGRFdmVudExpc3RlbmVyc1RvUm93KHJvd3NbaV0pO1xuICAgIH0pO1xufSk7XG5cbmZ1bmN0aW9uIGdldFJvd0VsZW1zKHJvdzogSFRNTEVsZW1lbnQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBpZDogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2NlbGwuX2lkIC50YWJsZV9fY2VsbC12YWx1ZVwiKSBhcyBIVE1MRWxlbWVudCxcbiAgICAgICAgbmFtZVZhbHVlOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fY2VsbC5fbmFtZSAudGFibGVfX2NlbGwtdmFsdWVcIikgYXMgSFRNTEVsZW1lbnQsXG4gICAgICAgIG5hbWVDaGFuZ2VFbGVtOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fY2VsbC5fbmFtZSAudGFibGVfX2NlbGwtY2hhbmdlLWVsZW1cIikgYXMgSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgZHVyYXRpb25WYWx1ZTogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2NlbGwuX2R1cmF0aW9uIC50YWJsZV9fY2VsbC12YWx1ZVwiKSBhcyBIVE1MRWxlbWVudCxcbiAgICAgICAgZHVyYXRpb25DaGFuZ2VFbGVtSG91cnM6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19jZWxsLl9kdXJhdGlvbiAudGFibGVfX2NlbGwtY2hhbmdlLWVsZW0uX2hvdXJzXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgIGR1cmF0aW9uQ2hhbmdlRWxlbU1pbnM6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19jZWxsLl9kdXJhdGlvbiAudGFibGVfX2NlbGwtY2hhbmdlLWVsZW0uX21pbnNcIikgYXMgSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgbGlua0NoYW5nZUVsZW06IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19jZWxsLl9saW5rIC50YWJsZV9fY2VsbC1jaGFuZ2UtZWxlbVwiKSBhcyBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICBidG5DaGFuZ2U6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19idG4uX2NoYW5nZVwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgYnRuRGVsZXRlOiByb3cucXVlcnlTZWxlY3RvcihcIi50YWJsZV9fYnRuLl9kZWxldGVcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgIGJ0blNhdmU6IHJvdy5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19idG4uX3NhdmVcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgIGJ0bkNhbmNlbDogcm93LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX2J0bi5fY2FuY2VsXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50XG4gICAgfVxufVxuXG5mdW5jdGlvbiBnZXRCdXR0b25zUm93KGJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQpIHtcbiAgICByZXR1cm4gKGJ1dHRvbi5wYXJlbnRFbGVtZW50IGFzIEhUTUxFbGVtZW50KS5wYXJlbnRFbGVtZW50IGFzIEhUTUxFbGVtZW50O1xufVxuXG5mdW5jdGlvbiBhZGRFdmVudExpc3RlbmVyc1RvUm93KHJvdzogSFRNTEVsZW1lbnQpIHtcbiAgICBjb25zdCByb3dFbGVtcyA9IGdldFJvd0VsZW1zKHJvdyk7XG4gICAgcm93RWxlbXMuYnRuQ2hhbmdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbkNoYW5nZUJ0bkNsaWNrKTtcbiAgICByb3dFbGVtcy5idG5DYW5jZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uQ2FuY2VsQnRuQ2xpY2spO1xuICAgIHJvd0VsZW1zLmJ0bkRlbGV0ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25EZWxldGVCdG5DbGljayk7XG4gICAgcm93RWxlbXMuYnRuU2F2ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25TYXZlQnRuQ2xpY2spO1xufVxuXG5mdW5jdGlvbiBjb252ZXJ0RHVyYXRpb24oZHVyYXRpb246IG51bWJlcikge1xuICAgIGNvbnN0IGhvdXJzID0gTWF0aC5mbG9vcihkdXJhdGlvbiAvIDM2MDAwMDApO1xuICAgIGNvbnN0IG1pbnMgPSBNYXRoLmZsb29yKChkdXJhdGlvbiAtIGhvdXJzICogMzYwMDAwMCkgLyA2MDAwMCk7XG4gICAgY29uc3Qgc3RyID0gKGhvdXJzID4gMCA/IGhvdXJzICsgXCLRhy4gXCIgOiBcIlwiKSArIChtaW5zID4gMCB8fCBob3VycyA9PT0gMCA/IG1pbnMgKyBcItC80LjQvS5cIiA6IFwiXCIpO1xuICAgIHJldHVybiB7IGhvdXJzLCBtaW5zLCBzdHIgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVSb3cocHJvZ3JhbTogUHJvZ3JhbSkge1xuICAgIGNvbnN0IGR1cmF0aW9uID0gY29udmVydER1cmF0aW9uKHByb2dyYW0uZHVyYXRpb24pO1xuICAgIHJldHVybiBgPGRpdiBjbGFzcz1cInRhYmxlX19yb3dcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jb250ZW50LWNlbGxzLWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jZWxsIF9pZFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbC12YWx1ZVwiPiR7cHJvZ3JhbS5pZCB8fCBcIlwifTwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwgX25hbWVcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwtdmFsdWVcIj4ke3Byb2dyYW0ubmFtZX08L2Rpdj5cbiAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJ0YWJsZV9fY2VsbC1jaGFuZ2UtZWxlbVwiIG1heGxlbmd0aD1cIjIwMFwiIG5hbWU9XCJuYW1lXCIgdmFsdWU9XCIke3Byb2dyYW0ubmFtZX1cIj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhYmxlX19jZWxsIF9kdXJhdGlvblwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbC12YWx1ZVwiPiR7ZHVyYXRpb24uc3RyfTwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbC1jaGFuZ2UtZWxlbS1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVwidGFibGVfX2NlbGwtY2hhbmdlLWVsZW0gX2hvdXJzXCIgdHlwZT1cIm51bWJlclwiIG1pbj1cIjBcIiBtYXg9XCIyNFwiIHZhbHVlPVwiJHtkdXJhdGlvbi5ob3Vyc31cIj7Rhy5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVwidGFibGVfX2NlbGwtY2hhbmdlLWVsZW0gX21pbnNcIiB0eXBlPVwibnVtYmVyXCIgbWluPVwiMFwiIG1heD1cIjU5XCIgdmFsdWU9XCIke2R1cmF0aW9uLm1pbnN9XCI+0LzQuNC9LlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFibGVfX2NlbGwgX2xpbmtcIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImxhYmVsXCI+0KHRgdGL0LvQutCwINGBIFlvdXR1YmU8L3NwYW4+XG4gICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVwidGFibGVfX2NlbGwtY2hhbmdlLWVsZW1cIiBuYW1lPVwibmFtZVwiIHZhbHVlPVwiJHtwcm9ncmFtLmxpbmt9XCI+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0YWJsZV9fY2VsbCBfYnRuc1wiPlxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cInBpIHBpLXBlbmNpbCB0YWJsZV9fYnRuIF9jaGFuZ2VcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS10cmFzaCB0YWJsZV9fYnRuIF9kZWxldGVcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS1zYXZlIHRhYmxlX19idG4gX3NhdmVcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJwaSBwaS10aW1lcyB0YWJsZV9fYnRuIF9jYW5jZWxcIj48L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+YFxufVxuXG5mdW5jdGlvbiBvbkFkZEJ0bkNsaWNrKCkge1xuICAgIGNvbnN0IG5ld1Byb2dyYW06IFByb2dyYW0gPSB7XG4gICAgICAgIGlkOiBudWxsLFxuICAgICAgICBuYW1lOiBcIlwiLFxuICAgICAgICBkdXJhdGlvbjogMzYwMDAwMCxcbiAgICAgICAgbGluazogXCJcIlxuICAgIH1cbiAgICByb3dzQ29udGFpbmVyLmluc2VydEFkamFjZW50SFRNTChcImJlZm9yZWVuZFwiLCBjcmVhdGVSb3cobmV3UHJvZ3JhbSkpO1xuICAgIGNvbnN0IG5ld1JvdyA9IHJvd3NDb250YWluZXIubGFzdEVsZW1lbnRDaGlsZCBhcyBIVE1MRWxlbWVudDtcbiAgICBhZGRFdmVudExpc3RlbmVyc1RvUm93KG5ld1Jvdyk7XG4gICAgZ2V0Um93RWxlbXMobmV3Um93KS5idG5DaGFuZ2UuY2xpY2soKTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHJvd3NDb250YWluZXIuc2Nyb2xsVG9wID0gcm93c0NvbnRhaW5lci5zY3JvbGxIZWlnaHQpO1xufVxuXG5mdW5jdGlvbiBvbkNoYW5nZUJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICByb3cuY2xhc3NMaXN0LmFkZChcIl9jaGFuZ2VkXCIpO1xufVxuXG5mdW5jdGlvbiBvbkNhbmNlbEJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICBjb25zdCByb3dFbGVtcyA9IGdldFJvd0VsZW1zKHJvdyk7XG4gICAgaWYgKHJvd0VsZW1zLmlkLmlubmVyVGV4dCkge1xuICAgICAgICByb3cuY2xhc3NMaXN0LnJlbW92ZShcIl9jaGFuZ2VkXCIpO1xuICAgICAgICBjb25zdCBwcm9ncmFtID0gcHJvZ3JhbXMuZmluZCgoaXRlbSkgPT4gaXRlbS5pZCArIFwiXCIgPT09IHJvd0VsZW1zLmlkLmlubmVyVGV4dCk7XG4gICAgICAgIGNvbnN0IGR1cmF0aW9uID0gY29udmVydER1cmF0aW9uKHByb2dyYW0uZHVyYXRpb24pO1xuICAgICAgICByb3dFbGVtcy5uYW1lQ2hhbmdlRWxlbS52YWx1ZSA9IHByb2dyYW0ubmFtZTtcbiAgICAgICAgcm93RWxlbXMuZHVyYXRpb25DaGFuZ2VFbGVtSG91cnMudmFsdWUgPSBkdXJhdGlvbi5ob3VycyArIFwiXCI7XG4gICAgICAgIHJvd0VsZW1zLmR1cmF0aW9uQ2hhbmdlRWxlbU1pbnMudmFsdWUgPSBkdXJhdGlvbi5taW5zICsgXCJcIjtcbiAgICB9XG4gICAgZWxzZSByb3cucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChyb3cpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBvbkRlbGV0ZUJ0bkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgaWYgKCFjb25maXJtKFwi0KXQvtGA0L7RiNC+INC/0L7QtNGD0LzQsNC70Lg/XCIpKSByZXR1cm47XG4gICAgY29uc3Qgcm93ID0gZ2V0QnV0dG9uc1JvdyhldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxCdXR0b25FbGVtZW50KTtcbiAgICBjb25zdCByb3dFbGVtcyA9IGdldFJvd0VsZW1zKHJvdyk7XG4gICAgYXdhaXQgZmV0Y2goYmFja2VuZEFkZHJlc3MgKyBcIi9hcGkvcHJvZ3JhbS9kZWxldGUucGhwP2lkPVwiICsgcm93RWxlbXMuaWQuaW5uZXJUZXh0LCB7IG1ldGhvZDogXCJkZWxldGVcIiB9KTtcbiAgICBwcm9ncmFtcyA9IHByb2dyYW1zLmZpbHRlcigoaXRlbSkgPT4gaXRlbS5pZCArIFwiXCIgIT09IHJvd0VsZW1zLmlkLmlubmVyVGV4dCk7XG4gICAgcm93LnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQocm93KTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gb25TYXZlQnRuQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICBjb25zdCByb3cgPSBnZXRCdXR0b25zUm93KGV2ZW50LmN1cnJlbnRUYXJnZXQgYXMgSFRNTEJ1dHRvbkVsZW1lbnQpO1xuICAgIGNvbnN0IHJvd0VsZW1zID0gZ2V0Um93RWxlbXMocm93KTtcbiAgICBjb25zdCBkdXJhdGlvbiA9ICtyb3dFbGVtcy5kdXJhdGlvbkNoYW5nZUVsZW1Ib3Vycy52YWx1ZSAqIDM2MDAwMDAgKyArcm93RWxlbXMuZHVyYXRpb25DaGFuZ2VFbGVtTWlucy52YWx1ZSAqIDYwMDAwO1xuICAgIGlmIChyb3dFbGVtcy5pZC5pbm5lclRleHQpIHtcbiAgICAgICAgY29uc3QgY2hhbmdlZFByb2dyYW0gPSB7XG4gICAgICAgICAgICBpZDogK3Jvd0VsZW1zLmlkLmlubmVyVGV4dCxcbiAgICAgICAgICAgIG5hbWU6IHJvd0VsZW1zLm5hbWVDaGFuZ2VFbGVtLnZhbHVlLFxuICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICBsaW5rOiByb3dFbGVtcy5saW5rQ2hhbmdlRWxlbS52YWx1ZVxuICAgICAgICB9O1xuICAgICAgICBhd2FpdCBmZXRjaChiYWNrZW5kQWRkcmVzcyArIGAvYXBpL3Byb2dyYW0vY2hhbmdlLnBocGAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJwdXRcIixcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGNoYW5nZWRQcm9ncmFtKVxuICAgICAgICB9KTtcbiAgICAgICAgcHJvZ3JhbXMgPSBwcm9ncmFtcy5tYXAoKGl0ZW0pID0+IGl0ZW0uaWQgPT09IGNoYW5nZWRQcm9ncmFtLmlkID8gY2hhbmdlZFByb2dyYW0gOiBpdGVtKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBuZXdQcm9ncmFtID0ge1xuICAgICAgICAgICAgaWQ6IG51bGwsXG4gICAgICAgICAgICBuYW1lOiByb3dFbGVtcy5uYW1lQ2hhbmdlRWxlbS52YWx1ZSxcbiAgICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgICAgbGluazogcm93RWxlbXMubGlua0NoYW5nZUVsZW0udmFsdWUsXG4gICAgICAgIH1cbiAgICAgICAgbmV3UHJvZ3JhbS5pZCA9IGF3YWl0IChhd2FpdCBmZXRjaChiYWNrZW5kQWRkcmVzcyArIGAvYXBpL3Byb2dyYW0vYWRkLnBocGAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShuZXdQcm9ncmFtKVxuICAgICAgICB9KSkuanNvbigpO1xuICAgICAgICByb3dFbGVtcy5pZC5pbm5lclRleHQgPSBcIlwiICsgbmV3UHJvZ3JhbS5pZDtcbiAgICAgICAgcHJvZ3JhbXMucHVzaChuZXdQcm9ncmFtKTtcbiAgICB9XG4gICAgY29uc3QgZHVyYXRpb25PYmogPSBjb252ZXJ0RHVyYXRpb24oZHVyYXRpb24pO1xuICAgIHJvd0VsZW1zLm5hbWVWYWx1ZS5pbm5lclRleHQgPSByb3dFbGVtcy5uYW1lQ2hhbmdlRWxlbS52YWx1ZTtcbiAgICByb3dFbGVtcy5kdXJhdGlvblZhbHVlLmlubmVyVGV4dCA9IGR1cmF0aW9uT2JqLnN0cjtcbiAgICByb3cuY2xhc3NMaXN0LnJlbW92ZShcIl9jaGFuZ2VkXCIpO1xufVxuXG5jbGFzcyBQcm9ncmFtIHtcbiAgICBpZDogbnVtYmVyO1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBkdXJhdGlvbjogbnVtYmVyO1xuICAgIGxpbms6IHN0cmluZztcbn0iXSwic291cmNlUm9vdCI6IiJ9